(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[   1345685,      31537]
NotebookOptionsPosition[   1334489,      31353]
NotebookOutlinePosition[   1334919,      31370]
CellTagsIndexPosition[   1334876,      31367]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"reduceObjects", "[", 
   RowBox[{"objects_List", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "objects"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reduceObjects", "[", 
   RowBox[{"objects_List", ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"reduceObjects", "[", 
    RowBox[{
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"objects", "/.", 
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}], "\[Rule]", 
        RowBox[{"Last", "[", 
         RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}]}]}], "]"}], 
     ",", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"objectEquivalences", "/.", 
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}], 
          "\[Rule]", 
          RowBox[{"Last", "[", 
           RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}]}]}], 
        "]"}], ",", "1"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "objectEquivalences", "]"}], ">", "0"}]}]}], "\n", 
 RowBox[{
  RowBox[{"reduceArrowsInitial", "[", 
   RowBox[{"arrows_Association", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "arrows"}], "\n", 
 RowBox[{
  RowBox[{"reduceArrowsInitial", "[", 
   RowBox[{"arrows_Association", ",", "arrowEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"reduceArrowsInitial", "[", 
    RowBox[{
     RowBox[{"Association", "[", 
      RowBox[{"DeleteDuplicatesBy", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"First", "[", "arrowEquivalences", "]"}], "]"}], "\[Rule]", 
          RowBox[{"Last", "[", 
           RowBox[{"First", "[", "arrowEquivalences", "]"}], "]"}]}]}], ",", 
        "First"}], "]"}], "]"}], ",", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"arrowEquivalences", "/.", 
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"First", "[", "arrowEquivalences", "]"}], "]"}], "\[Rule]", 
          RowBox[{"Last", "[", 
           RowBox[{"First", "[", "arrowEquivalences", "]"}], "]"}]}]}], "]"}],
        ",", "1"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "arrowEquivalences", "]"}], ">", "0"}]}]}], "\n", 
 RowBox[{
  RowBox[{"reduceArrowsFinal", "[", 
   RowBox[{"arrows_Association", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "arrows"}], "\n", 
 RowBox[{
  RowBox[{"reduceArrowsFinal", "[", 
   RowBox[{"arrows_Association", ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"reduceArrowsFinal", "[", 
    RowBox[{
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}], "\[Rule]", 
        RowBox[{"Last", "[", 
         RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}]}]}], "]"}], 
     ",", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"objectEquivalences", "/.", 
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}], 
          "\[Rule]", 
          RowBox[{"Last", "[", 
           RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}]}]}], 
        "]"}], ",", "1"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "objectEquivalences", "]"}], ">", 
    "0"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
   3.8696583718202224`*^9, 3.86965837319483*^9}, 
   3.8696584117148066`*^9},ExpressionUUID->"7fce9d87-8bea-48d7-b406-\
fed3cdda1897"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<Objects\>\"", "]"}], ":=", 
  RowBox[{"objects", "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ObjectCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", "objects", "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658434742017*^9}},ExpressionUUID->"8aabc7ba-f3a6-4233-b01f-\
e4d08c305e9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<MorphismAssociation\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
           RowBox[{"DirectedEdge", "@@", 
            RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
        RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696584397370977`*^9}},ExpressionUUID->"d39e8a1d-8c65-46e3-a504-\
f42383d51c74"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<MorphismNames\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"First", "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696584455949163`*^9}},ExpressionUUID->"f3d7a6a9-5253-43ad-a7a5-\
18910a5e700c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<MorphismEdges\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DirectedEdge", "@@", 
          RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658451172077*^9}},ExpressionUUID->"57039bef-d7ed-4873-91d6-\
486d723e8f02"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<MorphismCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"Length", "[", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}], "]"}]}]}], "]"}], 
   "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658456160365*^9}},ExpressionUUID->"861d22ac-0f4b-4e81-bfc5-\
79658aa7ba12"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ObjectEquivalences\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Union", "[", 
    RowBox[{"quiverObjectEquivalences", ",", "objectEquivalences"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ObjectEquivalenceCount\>\"", "]"}],
   ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Union", "[", 
     RowBox[{"quiverObjectEquivalences", ",", "objectEquivalences"}], "]"}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<MorphismEquivalences\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Union", "[", 
    RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<MorphismEquivalenceCount\>\"", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Union", "[", 
     RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], "]"}], "]"}],
    "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658485003538*^9}},ExpressionUUID->"0ab6b7fb-1394-472c-b1c4-\
16ad6f744dd5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedObjects\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"reduceObjects", "[", 
    RowBox[{
     RowBox[{"reduceObjects", "[", 
      RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
     "objectEquivalences"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedObjectCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"reduceObjects", "[", 
     RowBox[{
      RowBox[{"reduceObjects", "[", 
       RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
      "objectEquivalences"}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696585010510387`*^9}},ExpressionUUID->"be966cff-ad28-4f1e-a25a-\
8a4e2c453732"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedMorphismAssociation\>\"", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
           RowBox[{"DirectedEdge", "@@", 
            RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
        RowBox[{"Normal", "[", 
         RowBox[{"reduceArrowsFinal", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitial", "[", 
            RowBox[{"morphismAssociation", ",", "morphismEquivalences"}], 
            "]"}], ",", "objectEquivalences"}], "]"}], "]"}]}], "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.86965850699564*^9}},ExpressionUUID->"27e607d8-22df-4f50-8e1f-\
fb17b4c7f34f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedMorphismNames\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"First", "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{"morphismAssociation", ",", "morphismEquivalences"}], 
           "]"}], ",", "objectEquivalences"}], "]"}], "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658531824397*^9}},ExpressionUUID->"5ff6d2bd-2222-4328-87f0-\
2d094b4f909a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedMorphismEdges\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DirectedEdge", "@@", 
          RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{"morphismAssociation", ",", "morphismEquivalences"}], 
           "]"}], ",", "objectEquivalences"}], "]"}], "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696585447865896`*^9}},ExpressionUUID->"e76f80ca-3b53-429f-869c-\
3e44ee8b7e88"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedMorphismCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Length", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{"morphismAssociation", ",", "morphismEquivalences"}], 
           "]"}], ",", "objectEquivalences"}], "]"}], "]"}], "]"}]}]}], "]"}],
    "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696585492556844`*^9}},ExpressionUUID->"c53853cf-fc32-48bf-894c-\
eeb8580a494b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<SimpleMorphismAssociation\>\"", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
           RowBox[{"DirectedEdge", "@@", 
            RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
        RowBox[{"Normal", "[", 
         RowBox[{"Association", "[", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"DeleteDuplicatesBy", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"DirectedEdge", "@@", 
                RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
          "]"}], "]"}]}], "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696585534260616`*^9}},ExpressionUUID->"aef927fb-7f1e-4cbf-a81e-\
717c1f30fbfa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<SimpleMorphismNames\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"First", "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"Association", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicatesBy", "[", 
            RowBox[{
             RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
             RowBox[{
              RowBox[{"DirectedEdge", "@@", 
               RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
             RowBox[{"Last", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
         "]"}], "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658946480502*^9}},ExpressionUUID->"0d772db2-faa8-4640-bd7a-\
c2eed01187ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<SimpleMorphismEdges\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DirectedEdge", "@@", 
          RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"Association", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicatesBy", "[", 
            RowBox[{
             RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
             RowBox[{
              RowBox[{"DirectedEdge", "@@", 
               RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
             RowBox[{"Last", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
         "]"}], "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658946480502*^9}},ExpressionUUID->"a7370945-53f1-4692-8fb0-\
d0f2517b5123"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<SimpleMorphismCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicatesBy", "[", 
          RowBox[{
           RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
           RowBox[{
            RowBox[{"DirectedEdge", "@@", 
             RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696589439284163`*^9}},ExpressionUUID->"a5d0783c-f3ce-4b41-9fd3-\
b130e6f883d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", 
   "\"\<ReducedSimpleMorphismAssociation\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
           RowBox[{"DirectedEdge", "@@", 
            RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
        RowBox[{"Normal", "[", 
         RowBox[{"reduceArrowsFinal", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitial", "[", 
            RowBox[{
             RowBox[{"Association", "[", 
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"DeleteDuplicatesBy", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"DirectedEdge", "@@", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"First", "[", 
                   RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
                  RowBox[{"Last", "[", 
                   RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
              "]"}], ",", "morphismEquivalences"}], "]"}], ",", 
           "objectEquivalences"}], "]"}], "]"}]}], "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696589407842445`*^9}},ExpressionUUID->"c6983cd0-d3a5-447a-9c99-\
01d6f75e7ee1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedSimpleMorphismNames\>\"", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"First", "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
            RowBox[{"Association", "[", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicatesBy", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{"DirectedEdge", "@@", 
                   RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
             "]"}], ",", "morphismEquivalences"}], "]"}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658938357884*^9}},ExpressionUUID->"d2bf08ce-66ca-4e24-bb80-\
7bdaa5403350"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedSimpleMorphismEdges\>\"", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DirectedEdge", "@@", 
          RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
            RowBox[{"Association", "[", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicatesBy", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{"DirectedEdge", "@@", 
                   RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
             "]"}], ",", "morphismEquivalences"}], "]"}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696589351710243`*^9}},ExpressionUUID->"c20c69d4-65ad-4e90-921e-\
87904058c0bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedSimpleMorphismCount\>\"", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Length", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
            RowBox[{"Association", "[", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicatesBy", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{"DirectedEdge", "@@", 
                   RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
             "]"}], ",", "morphismEquivalences"}], "]"}], ",", 
          "objectEquivalences"}], "]"}], "]"}], "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658933319693*^9}},ExpressionUUID->"1699e10f-a326-49bd-8a01-\
0704e1c16ca6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<CompositionSymbol\>\"", "]"}], ":=", 
  RowBox[{"compositionSymbol", "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<IdentitySymbol\>\"", "]"}], ":=", 
  RowBox[{"identitySymbol", "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<DualCategory\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"morphismEquivalences", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"compositionSymbol", "[", 
             RowBox[{"x_", ",", 
              RowBox[{"compositionSymbol", "[", 
               RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], "\[RuleDelayed]", 
            RowBox[{"compositionSymbol", "[", 
             RowBox[{"z", ",", 
              RowBox[{"compositionSymbol", "[", 
               RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"compositionSymbol", "[", 
             RowBox[{
              RowBox[{"compositionSymbol", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"compositionSymbol", "[", 
             RowBox[{
              RowBox[{"compositionSymbol", "[", 
               RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"compositionSymbol", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"compositionSymbol", "[", 
             RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ")"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
             RowBox[{"Normal", "[", "arrows", "]"}]}], "]"}]}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}], 
          ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<Quiver\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
      ",", 
      RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "quiverObjectEquivalences"}], 
      ",", 
      RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696589262133484`*^9}},ExpressionUUID->"a89d7cb5-5190-40d4-a104-\
25350594c059"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<AssociativityEquations\>\"", "]"}],
   ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fullMorphismAssociation", ",", "compositions", ",", 
       "associativityEquations"}], "}"}], ",", 
     RowBox[{
      RowBox[{"fullMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "fullMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "fullMorphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"fullMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "fullMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fullMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "fullMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"associativityEquations", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphismName", "=", "#1"}], ",", "equality"}], "}"}], 
           ",", 
           RowBox[{
            RowBox[{"equality", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"First", "/@", 
                RowBox[{"Normal", "[", "fullMorphismAssociation", "]"}]}], 
               ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", "morphismName", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "===", 
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", "#1", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}]}], "&&", 
                 RowBox[{"morphismName", "=!=", "#1"}]}], "&"}]}], "]"}]}], 
            ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "equality", "]"}], ">", "0"}], ",", 
              RowBox[{"associativityEquations", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Append", "[", 
                   RowBox[{"associativityEquations", ",", 
                    RowBox[{"morphismName", "\[Equal]", "#1"}]}], "]"}], 
                  "&"}], ")"}], "/@", "equality"}]}]}], "]"}]}]}], "]"}], 
         "&"}], ")"}], "/@", 
       RowBox[{"First", "/@", 
        RowBox[{"Normal", "[", "fullMorphismAssociation", "]"}]}]}], ";", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Sort", "/@", 
        RowBox[{"Flatten", "[", "associativityEquations", "]"}]}], "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696589222289257`*^9}},ExpressionUUID->"75820726-92d0-40f1-abc8-\
869c625fdee0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedAssociativityEquations\>\"",
    "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fullMorphismAssociation", ",", "compositions", ",", 
       "associativityEquations"}], "}"}], ",", 
     RowBox[{
      RowBox[{"fullMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "fullMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "fullMorphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"fullMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "fullMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"fullMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "fullMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"associativityEquations", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphismName", "=", "#1"}], ",", "equality"}], "}"}], 
           ",", 
           RowBox[{
            RowBox[{"equality", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"First", "/@", 
                RowBox[{"Normal", "[", 
                 RowBox[{"reduceArrowsFinal", "[", 
                  RowBox[{
                   RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{
                    "fullMorphismAssociation", ",", "morphismEquivalences"}], 
                    "]"}], ",", "objectEquivalences"}], "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", "morphismName", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "===", 
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", "#1", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}]}], "&&", 
                 RowBox[{"morphismName", "=!=", "#1"}]}], "&"}]}], "]"}]}], 
            ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "equality", "]"}], ">", "0"}], ",", 
              RowBox[{"associativityEquations", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Append", "[", 
                   RowBox[{"associativityEquations", ",", 
                    RowBox[{"morphismName", "\[Equal]", "#1"}]}], "]"}], 
                  "&"}], ")"}], "/@", "equality"}]}]}], "]"}]}]}], "]"}], 
         "&"}], ")"}], "/@", 
       RowBox[{"First", "/@", 
        RowBox[{"Normal", "[", 
         RowBox[{"reduceArrowsFinal", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitial", "[", 
            RowBox[{"fullMorphismAssociation", ",", "morphismEquivalences"}], 
            "]"}], ",", "objectEquivalences"}], "]"}], "]"}]}]}], ";", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Sort", "/@", 
        RowBox[{"Flatten", "[", "associativityEquations", "]"}]}], "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658914501993*^9}},ExpressionUUID->"9ecafd3e-6249-4b5c-bc33-\
664458084771"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<IdentityEquations\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", "identityEquations"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"identityEquations", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"identityMorphism", "=", "#1"}], "}"}], ",", 
           RowBox[{"identityEquations", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{"identityEquations", ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], ",", 
                    RowBox[{"First", "[", "identityMorphism", "]"}]}], "]"}], 
                  "\[Equal]", 
                  RowBox[{"First", "[", "#1", "]"}]}]}], "]"}], "&"}], ")"}], 
             "/@", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "identityMorphism", "]"}], "]"}]}], 
                "&"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"identityMorphism", "=", "#1"}], "}"}], ",", 
           RowBox[{"identityEquations", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{"identityEquations", ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", "identityMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "#1", "]"}]}], "]"}], "\[Equal]", 
                  RowBox[{"First", "[", "#1", "]"}]}]}], "]"}], "&"}], ")"}], 
             "/@", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "identityMorphism", "]"}], "]"}]}], 
                "&"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Sort", "/@", 
        RowBox[{"Flatten", "[", "identityEquations", "]"}]}], "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696589115206356`*^9}},ExpressionUUID->"1cd2bc4b-7209-4a3f-b295-\
1e4e09fe0cf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedIdentityEquations\>\"", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", "identityEquations"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"identityEquations", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"identityMorphism", "=", "#1"}], "}"}], ",", 
           RowBox[{"identityEquations", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{"identityEquations", ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], ",", 
                    RowBox[{"First", "[", "identityMorphism", "]"}]}], "]"}], 
                  "\[Equal]", 
                  RowBox[{"First", "[", "#1", "]"}]}]}], "]"}], "&"}], ")"}], 
             "/@", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{
                   "morphismAssociation", ",", "morphismEquivalences"}], 
                   "]"}], ",", "objectEquivalences"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "identityMorphism", "]"}], "]"}]}], 
                "&"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"reduceArrowsFinal", "[", 
           RowBox[{
            RowBox[{"reduceArrowsInitial", "[", 
             RowBox[{"morphismAssociation", ",", "morphismEquivalences"}], 
             "]"}], ",", "objectEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"identityMorphism", "=", "#1"}], "}"}], ",", 
           RowBox[{"identityEquations", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{"identityEquations", ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", "identityMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "#1", "]"}]}], "]"}], "\[Equal]", 
                  RowBox[{"First", "[", "#1", "]"}]}]}], "]"}], "&"}], ")"}], 
             "/@", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{
                   "morphismAssociation", ",", "morphismEquivalences"}], 
                   "]"}], ",", "objectEquivalences"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "identityMorphism", "]"}], "]"}]}], 
                "&"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"reduceArrowsFinal", "[", 
           RowBox[{
            RowBox[{"reduceArrowsInitial", "[", 
             RowBox[{"morphismAssociation", ",", "morphismEquivalences"}], 
             "]"}], ",", "objectEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Sort", "/@", 
        RowBox[{"Flatten", "[", "identityEquations", "]"}]}], "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696589082414923`*^9}},ExpressionUUID->"6891424c-8dc1-4f40-b87d-\
3378d9dadafb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<CommutativeDiagramQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AllTrue", "[", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"CountsBy", "[", 
          RowBox[{
           RowBox[{"Normal", "[", 
            RowBox[{"reduceArrowsFinal", "[", 
             RowBox[{
              RowBox[{"reduceArrowsInitial", "[", 
               RowBox[{"morphismAssociation", ",", "morphismEquivalences"}], 
               "]"}], ",", "objectEquivalences"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"DirectedEdge", "@@", 
             RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Last", "[", "#1", "]"}], "\[Equal]", "1"}], "&"}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696589042374225`*^9}},ExpressionUUID->"296f885d-ee1d-4c8b-aa05-\
f4f066748ee4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<CommutativityEquations\>\"", "]"}],
   ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"EdgeList", "[", 
            RowBox[{"TransitiveReductionGraph", "[", 
             RowBox[{"Graph", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"UndirectedEdge", ",", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"First", "/@", "#1"}], ",", "2"}], "]"}], ",", 
                RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], "/.", 
           RowBox[{"UndirectedEdge", "\[Rule]", "Equal"}]}], "&"}], ")"}], "/@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"GatherBy", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "@@", 
                 RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
             RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
            "Last"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#1", "]"}], ">", "1"}], "&"}]}], "]"}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658899918117*^9}},ExpressionUUID->"0c102125-85ea-4afa-b528-\
b41d13132dc8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedCommutativityEquations\>\"",
    "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"EdgeList", "[", 
            RowBox[{"TransitiveReductionGraph", "[", 
             RowBox[{"Graph", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"UndirectedEdge", ",", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"First", "/@", "#1"}], ",", "2"}], "]"}], ",", 
                RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], "/.", 
           RowBox[{"UndirectedEdge", "\[Rule]", "Equal"}]}], "&"}], ")"}], "/@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"GatherBy", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "@@", 
                 RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
             RowBox[{"Normal", "[", 
              RowBox[{"reduceArrowsFinal", "[", 
               RowBox[{
                RowBox[{"reduceArrowsInitial", "[", 
                 RowBox[{"morphismAssociation", ",", "morphismEquivalences"}],
                  "]"}], ",", "objectEquivalences"}], "]"}], "]"}]}], ",", 
            "Last"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#1", "]"}], ">", "1"}], "&"}]}], "]"}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588931675806`*^9}},ExpressionUUID->"3d63ef53-0b46-4b59-b221-\
e6d6278f80de"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<Monomorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "monomorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"monomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphismPairs", ",", 
             "isMonomorphism"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphismPairs", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"isMonomorphism", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                   "]"}], "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], "]"}],
                     "]"}], ">", "0"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"isMonomorphism", "=", "False"}]}], "]"}], ",", 
                    RowBox[{"isMonomorphism", "=", "False"}]}], "]"}]}], 
                  "]"}]}], "]"}], "&"}], ")"}], "/@", "morphismPairs"}], ";", 
            RowBox[{"monomorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"monomorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "isMonomorphism"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      RowBox[{"Association", "[", "monomorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588891141205`*^9}},ExpressionUUID->"783ab603-a697-48b9-bcd2-\
82c6fd74e767"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedMonomorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedMonomorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedMonomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphismPairs", ",", 
             "isMonomorphism"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphismPairs", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"isMonomorphism", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                   "]"}], "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], "]"}],
                     "]"}], ">", "0"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"isMonomorphism", "=", "False"}]}], "]"}], ",", 
                    RowBox[{"isMonomorphism", "=", "False"}]}], "]"}]}], 
                  "]"}]}], "]"}], "&"}], ")"}], "/@", "morphismPairs"}], ";", 
            RowBox[{"reducedMonomorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedMonomorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "isMonomorphism"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "reducedMonomorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588857422123`*^9}},ExpressionUUID->"f9c84fca-b923-45db-a8d2-\
e0cb12aba546"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<Epimorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "epimorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"epimorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphismPairs", ",", 
             "isEpimorphism"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphismPairs", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"isEpimorphism", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                   "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     "]"}], ">", "0"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"isEpimorphism", "=", "False"}]}], "]"}], ",", 
                    RowBox[{"isEpimorphism", "=", "False"}]}], "]"}]}], 
                  "]"}]}], "]"}], "&"}], ")"}], "/@", "morphismPairs"}], ";", 
            RowBox[{"epimorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"epimorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "isEpimorphism"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      RowBox[{"Association", "[", "epimorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588820819564`*^9}},ExpressionUUID->"215be85e-4524-4d2b-a322-\
77528f628530"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedEpimorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedEpimorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedEpimorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphismPairs", ",", 
             "isEpimorphism"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphismPairs", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"isEpimorphism", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                   "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     "]"}], ">", "0"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"isEpimorphism", "=", "False"}]}], "]"}], ",", 
                    RowBox[{"isEpimorphism", "=", "False"}]}], "]"}]}], 
                  "]"}]}], "]"}], "&"}], ")"}], "/@", "morphismPairs"}], ";", 
            RowBox[{"reducedEpimorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedEpimorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "isEpimorphism"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "reducedEpimorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588789018774`*^9}},ExpressionUUID->"b368744f-7d7d-4553-9706-\
ddf077210cf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<Bimorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "bimorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"bimorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphismPairs1", ",", 
             "morphismPairs2", ",", "isMonomorphism", ",", "isEpimorphism"}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{"morphismPairs1", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"morphismPairs2", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"isMonomorphism", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                   "]"}], "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], "]"}],
                     "]"}], ">", "0"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"isMonomorphism", "=", "False"}]}], "]"}], ",", 
                    RowBox[{"isMonomorphism", "=", "False"}]}], "]"}]}], 
                  "]"}]}], "]"}], "&"}], ")"}], "/@", "morphismPairs1"}], ";", 
            RowBox[{"isEpimorphism", "=", "True"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                   "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     "]"}], ">", "0"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"isEpimorphism", "=", "False"}]}], "]"}], ",", 
                    RowBox[{"isEpimorphism", "=", "False"}]}], "]"}]}], 
                  "]"}]}], "]"}], "&"}], ")"}], "/@", "morphismPairs2"}], ";", 
            RowBox[{"bimorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"bimorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{"isMonomorphism", "&&", "isEpimorphism"}]}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "bimorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588744146748`*^9}},ExpressionUUID->"6831d880-0520-4d0d-950a-\
d01d32379c78"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedBimorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedBimorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedBimorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphismPairs1", ",", 
             "morphismPairs2", ",", "isMonomorphism", ",", "isEpimorphism"}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{"morphismPairs1", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"morphismPairs2", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"isMonomorphism", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                   "]"}], "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], "]"}],
                     "]"}], ">", "0"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"isMonomorphism", "=", "False"}]}], "]"}], ",", 
                    RowBox[{"isMonomorphism", "=", "False"}]}], "]"}]}], 
                  "]"}]}], "]"}], "&"}], ")"}], "/@", "morphismPairs1"}], ";", 
            RowBox[{"isEpimorphism", "=", "True"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                   "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     "]"}], ">", "0"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"isEpimorphism", "=", "False"}]}], "]"}], ",", 
                    RowBox[{"isEpimorphism", "=", "False"}]}], "]"}]}], 
                  "]"}]}], "]"}], "&"}], ")"}], "/@", "morphismPairs2"}], ";", 
            RowBox[{"reducedBimorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedBimorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{"isMonomorphism", "&&", "isEpimorphism"}]}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "reducedBimorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588705638447`*^9}},ExpressionUUID->"7bb361fb-ad51-4bc0-80c5-\
cc9850126c08"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<Retractions\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "retractions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"retractions", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                   RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            RowBox[{"retractions", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"retractions", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "isRetraction"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      RowBox[{"Association", "[", "retractions", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588653752437`*^9}},ExpressionUUID->"09d0b4df-6ac9-430b-a674-\
b4cb692f665b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedRetractions\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedRetractions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedRetractions", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                   RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            RowBox[{"reducedRetractions", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedRetractions", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "isRetraction"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "reducedRetractions", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588620351505`*^9}},ExpressionUUID->"bcc742fa-ea86-4d0a-8b40-\
bfbb95f6aef6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<LeftInverses\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "leftInverses"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"leftInverses", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "leftInverseList"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"leftInverseList", "=", 
             RowBox[{"{", "}"}]}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"leftInverseList", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"leftInverseList", ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                    ",", 
                   RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"leftInverseList", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"leftInverseList", ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}]}], 
                    "]"}]}], "]"}], "&"}], ")"}], "/@", 
                    "equivalentObjects"}]}]}], "]"}]}], "]"}], "&"}], ")"}], "/@",
              "morphisms"}], ";", "\[IndentingNewLine]", 
            RowBox[{"leftInverses", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"leftInverses", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "leftInverseList"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "leftInverses", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588580217724`*^9}},ExpressionUUID->"1d360be5-3667-4ef1-86e3-\
4667af4eacaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedLeftInverses\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedLeftInverses"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedLeftInverses", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "leftInverseList"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"leftInverseList", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"leftInverseList", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"leftInverseList", ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                    ",", 
                   RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"leftInverseList", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"leftInverseList", ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}]}], 
                    "]"}]}], "]"}], "&"}], ")"}], "/@", 
                    "equivalentObjects"}]}]}], "]"}]}], "]"}], "&"}], ")"}], "/@",
              "morphisms"}], ";", "\[IndentingNewLine]", 
            RowBox[{"reducedLeftInverses", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedLeftInverses", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "leftInverseList"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "reducedLeftInverses", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588546198673`*^9}},ExpressionUUID->"33a82e4e-af31-4c3f-9f9e-\
fbb63f4d94ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<Sections\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "sections"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"sections", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"isSection", "=", "False"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                    ",", 
                   RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            RowBox[{"sections", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"sections", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "isSection"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "sections", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658849156955*^9}},ExpressionUUID->"b38a9e4f-f561-420e-b147-\
5b013e94a00a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedSections\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedSections"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedSections", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                    ",", 
                   RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            RowBox[{"reducedSections", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedSections", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "isSection"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "reducedSections", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588451776714`*^9}},ExpressionUUID->"b3f1e58f-1f74-44c8-8495-\
d19967e5abf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<RightInverses\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "rightInverses"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"rightInverses", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "rightInverseList"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"rightInverseList", "=", 
             RowBox[{"{", "}"}]}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"rightInverseList", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"rightInverseList", ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                   RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"rightInverseList", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"rightInverseList", ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}]}], 
                    "]"}]}], "]"}], "&"}], ")"}], "/@", 
                    "equivalentObjects"}]}]}], "]"}]}], "]"}], "&"}], ")"}], "/@",
              "morphisms"}], ";", "\[IndentingNewLine]", 
            RowBox[{"rightInverses", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"rightInverses", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "rightInverseList"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "rightInverses", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588402802677`*^9}},ExpressionUUID->"e980166c-100d-4834-ae62-\
6d85de107ff8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedRightInverses\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedRightInverses"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedRightInverses", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "rightInverseList"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"rightInverseList", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"rightInverseList", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"rightInverseList", ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                   RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"rightInverseList", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"rightInverseList", ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}]}], 
                    "]"}]}], "]"}], "&"}], ")"}], "/@", 
                    "equivalentObjects"}]}]}], "]"}]}], "]"}], "&"}], ")"}], "/@",
              "morphisms"}], ";", "\[IndentingNewLine]", 
            RowBox[{"reducedRightInverses", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedRightInverses", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "rightInverseList"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "reducedRightInverses", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588344067197`*^9}},ExpressionUUID->"d0fa67a3-8852-40cc-9528-\
9f87fa677484"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<Isomorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "isomorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"isomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"isomorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"isomorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{"isRetraction", "&&", "isSection"}]}]}], "]"}]}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      RowBox[{"Association", "[", "isomorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588256247005`*^9}},ExpressionUUID->"a25e7717-95e6-4cc3-8405-\
bcc06b19c645"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedIsomorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedIsomorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedIsomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"reducedIsomorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedIsomorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{"isRetraction", "&&", "isSection"}]}]}], "]"}]}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "reducedIsomorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658820879014*^9}},ExpressionUUID->"e620a891-bc6f-46e1-a812-\
c06f442a248e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<Inverses\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "inverses"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"inverses", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "inverseList"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"inverseList", "=", 
             RowBox[{"{", "}"}]}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"inverseList", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"inverseList", ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", "isRetraction", 
                   ",", "isSection", ",", "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"isRetraction", "=", "False"}], ";", 
                  RowBox[{"isSection", "=", "False"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"isRetraction", "&&", "isSection"}], ",", 
                    RowBox[{"inverseList", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"inverseList", ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}]}], 
                   "]"}]}]}], "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"inverses", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"inverses", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "inverseList"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "inverses", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658814439966*^9}},ExpressionUUID->"5578d223-9b00-4224-83b1-\
d42df3c0437b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedInverses\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedInverses"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedInverses", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "inverseList"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"inverseList", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"inverseList", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"inverseList", ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", "isRetraction", 
                   ",", "isSection", ",", "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"isRetraction", "=", "False"}], ";", 
                  RowBox[{"isSection", "=", "False"}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"isRetraction", "&&", "isSection"}], ",", 
                    RowBox[{"inverseList", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"inverseList", ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}]}], 
                   "]"}]}]}], "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"reducedInverses", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedInverses", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "inverseList"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "reducedInverses", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696588074432063`*^9}},ExpressionUUID->"977ac369-ae26-45c0-a5cc-\
35f2bda21bd2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<Endomorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "endomorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"endomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "isEndomorphism"}], "}"}], 
           ",", 
           RowBox[{
            RowBox[{"isEndomorphism", "=", "False"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"FindShortestPath", "[", 
                 RowBox[{"objectEquivalenceGraph", ",", 
                  RowBox[{"First", "[", 
                   RowBox[{"Last", "[", "morphism", "]"}], "]"}], ",", 
                  RowBox[{"Last", "[", 
                   RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                "]"}], ">", "0"}], ",", 
              RowBox[{"isEndomorphism", "=", "True"}]}], "]"}], ";", 
            RowBox[{"endomorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"endomorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "isEndomorphism"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      RowBox[{"Association", "[", "endomorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696587968349533`*^9}},ExpressionUUID->"91738216-0dea-4c9f-a42a-\
6c330aeb3568"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedEndomorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "reducedEndomorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"reducedEndomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "isEndomorphism"}], "}"}], 
           ",", 
           RowBox[{
            RowBox[{"isEndomorphism", "=", "False"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"FindShortestPath", "[", 
                 RowBox[{"objectEquivalenceGraph", ",", 
                  RowBox[{"First", "[", 
                   RowBox[{"Last", "[", "morphism", "]"}], "]"}], ",", 
                  RowBox[{"Last", "[", 
                   RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                "]"}], ">", "0"}], ",", 
              RowBox[{"isEndomorphism", "=", "True"}]}], "]"}], ";", 
            RowBox[{"reducedEndomorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedEndomorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "isEndomorphism"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{"morphismAssociation", ",", "morphismEquivalences"}], 
           "]"}], ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "reducedEndomorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658793658185*^9}},ExpressionUUID->"d8bb9db2-d9fd-4092-aa9e-\
d9fcfc970258"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<Automorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "automorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"automorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection", ",", "isEndomorphism"}], "}"}],
            ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            RowBox[{"isEndomorphism", "=", "False"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"FindShortestPath", "[", 
                 RowBox[{"objectEquivalenceGraph", ",", 
                  RowBox[{"First", "[", 
                   RowBox[{"Last", "[", "morphism", "]"}], "]"}], ",", 
                  RowBox[{"Last", "[", 
                   RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                "]"}], ">", "0"}], ",", 
              RowBox[{"isEndomorphism", "=", "True"}]}], "]"}], ";", 
            RowBox[{"automorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"automorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{
                "isRetraction", "&&", "isSection", "&&", 
                 "isEndomorphism"}]}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      RowBox[{"Association", "[", "automorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696587904464893`*^9}},ExpressionUUID->"919dd566-8045-4e67-9da9-\
442c80202b0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedAutomorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedAutomorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedAutomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection", ",", "isEndomorphism"}], "}"}],
            ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            RowBox[{"isEndomorphism", "=", "False"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"FindShortestPath", "[", 
                 RowBox[{"objectEquivalenceGraph", ",", 
                  RowBox[{"First", "[", 
                   RowBox[{"Last", "[", "morphism", "]"}], "]"}], ",", 
                  RowBox[{"Last", "[", 
                   RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                "]"}], ">", "0"}], ",", 
              RowBox[{"isEndomorphism", "=", "True"}]}], "]"}], ";", 
            RowBox[{"reducedAutomorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedAutomorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{
                "isRetraction", "&&", "isSection", "&&", 
                 "isEndomorphism"}]}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "reducedAutomorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658786375822*^9}},ExpressionUUID->"54bfca44-1e8b-4689-8feb-\
d1c42f57e6f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<InitialObjects\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", "initialObjects"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"initialObjects", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"object", "=", "#1"}], ",", "morphisms", ",", 
             "isInitialObject"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", 
            RowBox[{"isInitialObject", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isInitialObject", "=", "False"}]}], "]"}]}], 
                "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
            RowBox[{"initialObjects", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"initialObjects", ",", 
               RowBox[{"object", "\[Rule]", "isInitialObject"}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"Association", "[", "initialObjects", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696587820129604`*^9}},ExpressionUUID->"2f1b86f1-daef-4f94-a72f-\
32dc060f9c15"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedInitialObjects\>\"", "]"}], 
  ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedInitialObjects"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"reducedInitialObjects", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"object", "=", "#1"}], ",", "morphisms", ",", 
             "isInitialObject"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{
                   "morphismAssociation", ",", "morphismEquivalences"}], 
                   "]"}], ",", "objectEquivalences"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", 
            RowBox[{"isInitialObject", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isInitialObject", "=", "False"}]}], "]"}]}], 
                "]"}], "&"}], ")"}], "/@", 
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"reduceObjects", "[", 
                RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
               ",", "objectEquivalences"}], "]"}]}], ";", 
            RowBox[{"reducedInitialObjects", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedInitialObjects", ",", 
               RowBox[{"object", "\[Rule]", "isInitialObject"}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
         "objectEquivalences"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "reducedInitialObjects", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658778834621*^9}},ExpressionUUID->"bffbb52e-a2c8-4ce1-9fc4-\
b5ba193a39f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<StrictInitialObjects\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "isomorphisms", ",", "strictInitialObjects"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"isomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"isomorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"isomorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{"isRetraction", "&&", "isSection"}]}]}], "]"}]}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      RowBox[{"strictInitialObjects", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"object", "=", "#1"}], ",", "morphisms1", ",", 
             "morphisms2", ",", "isStrictInitialObject"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms1", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"morphisms2", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"Association", "[", "isomorphisms", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"First", "/@", 
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "object"}], "&"}]}], "]"}]}], ",", "#1"}], "]"}], "&"}]}],
               "]"}]}], ";", 
            RowBox[{"isStrictInitialObject", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isStrictInitialObject", "=", "False"}]}], "]"}]}],
                 "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Last", "[", "#1", "]"}], "===", "False"}], ",", 
                 RowBox[{"isStrictInitialObject", "=", "False"}]}], "]"}], 
               "&"}], ")"}], "/@", "morphisms2"}], ";", 
            RowBox[{"strictInitialObjects", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"strictInitialObjects", ",", 
               RowBox[{"object", "\[Rule]", "isStrictInitialObject"}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "strictInitialObjects", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658775380231*^9}},ExpressionUUID->"4c1ec37c-d1ab-4569-a808-\
c826942bf515"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedStrictInitialObjects\>\"", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedIsomorphisms", ",", "reducedStrictInitialObjects"}], "}"}], 
     ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedIsomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"reducedIsomorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedIsomorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{"isRetraction", "&&", "isSection"}]}]}], "]"}]}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"reducedStrictInitialObjects", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"object", "=", "#1"}], ",", "morphisms1", ",", 
             "morphisms2", ",", "isStrictInitialObject"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms1", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{
                   "reducedMorphismAssociation", ",", 
                    "morphismEquivalences"}], "]"}], ",", 
                  "objectEquivalences"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"morphisms2", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"Association", "[", "reducedIsomorphisms", "]"}], 
                "]"}], ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"First", "/@", 
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Normal", "[", 
                    RowBox[{"reduceArrowsFinal", "[", 
                    RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{
                    "reducedMorphismAssociation", ",", 
                    "morphismEquivalences"}], "]"}], ",", 
                    "objectEquivalences"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "object"}], "&"}]}], "]"}]}], ",", "#1"}], "]"}], "&"}]}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"isStrictInitialObject", "=", "True"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isStrictInitialObject", "=", "False"}]}], "]"}]}],
                 "]"}], "&"}], ")"}], "/@", 
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"reduceObjects", "[", 
                RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
               ",", "objectEquivalences"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Last", "[", "#1", "]"}], "===", "False"}], ",", 
                 RowBox[{"isStrictInitialObject", "=", "False"}]}], "]"}], 
               "&"}], ")"}], "/@", "morphisms2"}], ";", 
            RowBox[{"reducedStrictInitialObjects", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedStrictInitialObjects", ",", 
               RowBox[{"object", "\[Rule]", "isStrictInitialObject"}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
         "objectEquivalences"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "reducedStrictInitialObjects", "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658771631194*^9}},ExpressionUUID->"ed23709c-3839-485a-aace-\
bade43a7b6c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<TerminalObjects\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", "terminalObjects"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"terminalObjects", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"object", "=", "#1"}], ",", "morphisms", ",", 
             "isTerminalObject"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", 
            RowBox[{"isTerminalObject", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isTerminalObject", "=", "False"}]}], "]"}]}], 
                "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
            RowBox[{"terminalObjects", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"terminalObjects", ",", 
               RowBox[{"object", "\[Rule]", "isTerminalObject"}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"Association", "[", "terminalObjects", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696587624518795`*^9}},ExpressionUUID->"f5c06695-13b4-452b-983d-\
2ed3d45a529b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedTerminalObjects\>\"", "]"}],
   ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedTerminalObjects"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"reducedTerminalObjects", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"object", "=", "#1"}], ",", "morphisms", ",", 
             "isTerminalObject"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{
                   "morphismAssociation", ",", "morphismEquivalences"}], 
                   "]"}], ",", "objectEquivalences"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", 
            RowBox[{"isTerminalObject", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isTerminalObject", "=", "False"}]}], "]"}]}], 
                "]"}], "&"}], ")"}], "/@", 
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"reduceObjects", "[", 
                RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
               ",", "objectEquivalences"}], "]"}]}], ";", 
            RowBox[{"reducedTerminalObjects", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedTerminalObjects", ",", 
               RowBox[{"object", "\[Rule]", "isTerminalObject"}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
         "objectEquivalences"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "reducedTerminalObjects", "]"}]}]}], "]"}], 
   "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658759191887*^9}},ExpressionUUID->"f306e402-d45a-4737-9dd5-\
5f5e241d8c67"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<StrictTerminalObjects\>\"", "]"}], 
  ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "isomorphisms", ",", "strictTerminalObjects"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"isomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"isomorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"isomorphisms", "=", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{"isRetraction", "&&", "isSection"}]}]}], "]"}]}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      RowBox[{"strictTerminalObjects", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"object", "=", "#1"}], ",", "morphisms1", ",", 
             "morphisms2", ",", "isStrictTerminalObject"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms1", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"morphisms2", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"Association", "[", "isomorphisms", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"First", "/@", 
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "object"}], "&"}]}], "]"}]}], ",", "#1"}], "]"}], "&"}]}],
               "]"}]}], ";", 
            RowBox[{"isStrictTerminalObject", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isStrictTerminalObject", "=", "False"}]}], 
                  "]"}]}], "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Last", "[", "#1", "]"}], "===", "False"}], ",", 
                 RowBox[{"isStrictTerminalObject", "=", "False"}]}], "]"}], 
               "&"}], ")"}], "/@", "morphisms2"}], ";", 
            RowBox[{"strictTerminalObjects", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"strictTerminalObjects", ",", 
               RowBox[{"object", "\[Rule]", "isStrictTerminalObject"}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "strictTerminalObjects", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658755681585*^9}},ExpressionUUID->"d57270ca-8f4b-48b0-9808-\
b199dc21a082"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedStrictTerminalObjects\>\"", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedIsomorphisms", ",", "reducedStrictTerminalObjects"}], "}"}], 
     ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedIsomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"reducedIsomorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedIsomorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{"isRetraction", "&&", "isSection"}]}]}], "]"}]}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"reducedStrictTerminalObjects", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"object", "=", "#1"}], ",", "morphisms1", ",", 
             "morphisms2", ",", "isStrictTerminalObject"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms1", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{
                   "reducedMorphismAssociation", ",", 
                    "morphismEquivalences"}], "]"}], ",", 
                  "objectEquivalences"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"morphisms2", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"Association", "[", "reducedIsomorphisms", "]"}], 
                "]"}], ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"First", "/@", 
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Normal", "[", 
                    RowBox[{"reduceArrowsFinal", "[", 
                    RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{
                    "reducedMorphismAssociation", ",", 
                    "morphismEquivalences"}], "]"}], ",", 
                    "objectEquivalences"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "object"}], "&"}]}], "]"}]}], ",", "#1"}], "]"}], "&"}]}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"isStrictTerminalObject", "=", "True"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isStrictTerminalObject", "=", "False"}]}], 
                  "]"}]}], "]"}], "&"}], ")"}], "/@", 
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"reduceObjects", "[", 
                RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
               ",", "objectEquivalences"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Last", "[", "#1", "]"}], "===", "False"}], ",", 
                 RowBox[{"isStrictTerminalObject", "=", "False"}]}], "]"}], 
               "&"}], ")"}], "/@", "morphisms2"}], ";", 
            RowBox[{"reducedStrictTerminalObjects", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedStrictTerminalObjects", ",", 
               RowBox[{"object", "\[Rule]", "isStrictTerminalObject"}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
         "objectEquivalences"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "reducedStrictTerminalObjects", "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658750473281*^9}},ExpressionUUID->"1d0fe121-540c-4f05-b50e-\
3f9cf253a180"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ZeroObjects\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", "zeroObjects"}], "}"}],
      ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"zeroObjects", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"object", "=", "#1"}], ",", "morphisms1", ",", 
             "morphisms2", ",", "isInitialObject", ",", "isTerminalObject"}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms1", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"morphisms2", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", 
            RowBox[{"isInitialObject", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isInitialObject", "=", "False"}]}], "]"}]}], 
                "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
            RowBox[{"isTerminalObject", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms2", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isTerminalObject", "=", "False"}]}], "]"}]}], 
                "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
            RowBox[{"zeroObjects", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"zeroObjects", ",", 
               RowBox[{"object", "\[Rule]", 
                RowBox[{"isInitialObject", "&&", "isTerminalObject"}]}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"Association", "[", "zeroObjects", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658745201257*^9}},ExpressionUUID->"59d94e00-7ff5-44bb-99ef-\
f8566891b70e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedZeroObjects\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", "reducedZeroObjects"}],
       "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"reducedZeroObjects", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"object", "=", "#1"}], ",", "morphisms1", ",", 
             "morphisms2", ",", "isInitialObject", ",", "isTerminalObject"}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms1", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{
                   "morphismAssociation", ",", "morphismEquivalences"}], 
                   "]"}], ",", "objectEquivalences"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", 
            RowBox[{"morphisms2", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{
                   "morphismAssociation", ",", "morphismEquivalences"}], 
                   "]"}], ",", "objectEquivalences"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", 
            RowBox[{"isInitialObject", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isInitialObject", "=", "False"}]}], "]"}]}], 
                "]"}], "&"}], ")"}], "/@", 
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"reduceObjects", "[", 
                RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
               ",", "objectEquivalences"}], "]"}]}], ";", 
            RowBox[{"isTerminalObject", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms2", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isTerminalObject", "=", "False"}]}], "]"}]}], 
                "]"}], "&"}], ")"}], "/@", 
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"reduceObjects", "[", 
                RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
               ",", "objectEquivalences"}], "]"}]}], ";", 
            RowBox[{"reducedZeroObjects", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedZeroObjects", ",", 
               RowBox[{"object", "\[Rule]", 
                RowBox[{"isInitialObject", "&&", "isTerminalObject"}]}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
         "objectEquivalences"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "reducedZeroObjects", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658740507044*^9}},ExpressionUUID->"66e14e96-d97a-49b2-884d-\
92ea8a4d6d56"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<StrictZeroObjects\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "isomorphisms", ",", "strictZeroObjects"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"isomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"isomorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"isomorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{"isRetraction", "&&", "isSection"}]}]}], "]"}]}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      RowBox[{"strictZeroObjects", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"object", "=", "#1"}], ",", "morphisms1", ",", 
             "morphisms2", ",", "morphisms3", ",", "morphisms4", ",", 
             "isStrictInitialObject", ",", "isStrictTerminalObject"}], "}"}], 
           ",", 
           RowBox[{
            RowBox[{"morphisms1", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"morphisms2", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"Association", "[", "isomorphisms", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"First", "/@", 
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "object"}], "&"}]}], "]"}]}], ",", "#1"}], "]"}], "&"}]}],
               "]"}]}], ";", 
            RowBox[{"isStrictInitialObject", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isStrictInitialObject", "=", "False"}]}], "]"}]}],
                 "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Last", "[", "#1", "]"}], "===", "False"}], ",", 
                 RowBox[{"isStrictInitialObject", "=", "False"}]}], "]"}], 
               "&"}], ")"}], "/@", "morphisms2"}], ";", "\[IndentingNewLine]", 
            RowBox[{"morphisms3", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"morphisms4", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"Association", "[", "isomorphisms", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"First", "/@", 
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "object"}], "&"}]}], "]"}]}], ",", "#1"}], "]"}], "&"}]}],
               "]"}]}], ";", 
            RowBox[{"isStrictTerminalObject", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms3", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isStrictTerminalObject", "=", "False"}]}], 
                  "]"}]}], "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Last", "[", "#1", "]"}], "===", "False"}], ",", 
                 RowBox[{"isStrictTerminalObject", "=", "False"}]}], "]"}], 
               "&"}], ")"}], "/@", "morphisms4"}], ";", "\[IndentingNewLine]", 
            RowBox[{"strictZeroObjects", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"strictZeroObjects", ",", 
               RowBox[{"object", "\[Rule]", 
                RowBox[{
                "isStrictInitialObject", "&&", "isStrictTerminalObject"}]}]}],
               "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"Association", "[", "strictZeroObjects", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658736679063*^9}},ExpressionUUID->"192ffcad-800c-479f-a4c4-\
ccb26d62f866"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedStrictZeroObjects\>\"", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedIsomorphisms", ",", "reducedStrictZeroObjects"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedIsomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"reducedIsomorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedIsomorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{"isRetraction", "&&", "isSection"}]}]}], "]"}]}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"reducedStrictZeroObjects", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"object", "=", "#1"}], ",", "morphisms1", ",", 
             "morphisms2", ",", "morphisms3", ",", "morphisms4", ",", 
             "isStrictInitialObject", ",", "isStrictTerminalObject"}], "}"}], 
           ",", 
           RowBox[{
            RowBox[{"morphisms1", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{
                   "reducedMorphismAssociation", ",", 
                    "morphismEquivalences"}], "]"}], ",", 
                  "objectEquivalences"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"morphisms2", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"Association", "[", "reducedIsomorphisms", "]"}], 
                "]"}], ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"First", "/@", 
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Normal", "[", 
                    RowBox[{"reduceArrowsFinal", "[", 
                    RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{
                    "reducedMorphismAssociation", ",", 
                    "morphismEquivalences"}], "]"}], ",", 
                    "objectEquivalences"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "object"}], "&"}]}], "]"}]}], ",", "#1"}], "]"}], "&"}]}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"isStrictInitialObject", "=", "True"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isStrictInitialObject", "=", "False"}]}], "]"}]}],
                 "]"}], "&"}], ")"}], "/@", 
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"reduceObjects", "[", 
                RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
               ",", "objectEquivalences"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Last", "[", "#1", "]"}], "===", "False"}], ",", 
                 RowBox[{"isStrictInitialObject", "=", "False"}]}], "]"}], 
               "&"}], ")"}], "/@", "morphisms2"}], ";", "\[IndentingNewLine]", 
            RowBox[{"morphisms3", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{
                   "reducedMorphismAssociation", ",", 
                    "morphismEquivalences"}], "]"}], ",", 
                  "objectEquivalences"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"morphisms4", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"Association", "[", "reducedIsomorphisms", "]"}], 
                "]"}], ",", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"First", "/@", 
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Normal", "[", 
                    RowBox[{"reduceArrowsFinal", "[", 
                    RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{
                    "reducedMorphismAssociation", ",", 
                    "morphismEquivalences"}], "]"}], ",", 
                    "objectEquivalences"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "object"}], "&"}]}], "]"}]}], ",", "#1"}], "]"}], "&"}]}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"isStrictTerminalObject", "=", "True"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms3", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isStrictTerminalObject", "=", "False"}]}], 
                  "]"}]}], "]"}], "&"}], ")"}], "/@", 
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"reduceObjects", "[", 
                RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
               ",", "objectEquivalences"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Last", "[", "#1", "]"}], "===", "False"}], ",", 
                 RowBox[{"isStrictTerminalObject", "=", "False"}]}], "]"}], 
               "&"}], ")"}], "/@", "morphisms4"}], ";", 
            RowBox[{"reducedStrictZeroObjects", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedStrictZeroObjects", ",", 
               RowBox[{"object", "\[Rule]", 
                RowBox[{
                "isStrictInitialObject", "&&", "isStrictTerminalObject"}]}]}],
               "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
         "objectEquivalences"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "reducedStrictZeroObjects", "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658730945198*^9}},ExpressionUUID->"998561fd-a479-4f76-91ec-\
967d9b1f7b9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<PointedCategoryQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", "reducedZeroObjects"}],
       "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"reducedZeroObjects", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"object", "=", "#1"}], ",", "morphisms1", ",", 
             "morphisms2", ",", "isInitialObject", ",", "isTerminalObject"}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms1", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{
                   "morphismAssociation", ",", "morphismEquivalences"}], 
                   "]"}], ",", "objectEquivalences"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", 
            RowBox[{"morphisms2", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{
                   "morphismAssociation", ",", "morphismEquivalences"}], 
                   "]"}], ",", "objectEquivalences"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", "object"}], 
                "&"}]}], "]"}]}], ";", 
            RowBox[{"isInitialObject", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isInitialObject", "=", "False"}]}], "]"}]}], 
                "]"}], "&"}], ")"}], "/@", 
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"reduceObjects", "[", 
                RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
               ",", "objectEquivalences"}], "]"}]}], ";", 
            RowBox[{"isTerminalObject", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newObject", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{"morphisms2", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "newObject"}], "&"}]}], "]"}], "]"}], "\[NotEqual]", 
                    "1"}], ",", 
                   RowBox[{"isTerminalObject", "=", "False"}]}], "]"}]}], 
                "]"}], "&"}], ")"}], "/@", 
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"reduceObjects", "[", 
                RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
               ",", "objectEquivalences"}], "]"}]}], ";", 
            RowBox[{"reducedZeroObjects", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedZeroObjects", ",", 
               RowBox[{"object", "\[Rule]", 
                RowBox[{"isInitialObject", "&&", "isTerminalObject"}]}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
         "objectEquivalences"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Or", "@@", 
       RowBox[{"Last", "/@", 
        RowBox[{"Normal", "[", 
         RowBox[{"Association", "[", "reducedZeroObjects", "]"}], 
         "]"}]}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696587224034863`*^9}},ExpressionUUID->"d2365d11-77c1-4f80-b5e1-\
8e63e007a021"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ConstantMorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "constantMorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"constantMorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphismPairs", ",", 
             "isConstantMorphism"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphismPairs", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"isConstantMorphism", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                    "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], "]"}],
                     "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{"isConstantMorphism", "=", "False"}]}], "]"}], 
                    ",", 
                    RowBox[{"isConstantMorphism", "=", "False"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "/@", 
             "morphismPairs"}], ";", 
            RowBox[{"constantMorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"constantMorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "isConstantMorphism"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      RowBox[{"Association", "[", "constantMorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696587147984147`*^9}},ExpressionUUID->"c06bb836-baf1-421d-9a32-\
d3820dc36cd8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedConstantMorphisms\>\"", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedConstantMorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedConstantMorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphismPairs", ",", 
             "isConstantMorphism"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphismPairs", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"isConstantMorphism", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                    "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], "]"}],
                     "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{"isConstantMorphism", "=", "False"}]}], "]"}], 
                    ",", 
                    RowBox[{"isConstantMorphism", "=", "False"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "/@", 
             "morphismPairs"}], ";", 
            RowBox[{"reducedConstantMorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedConstantMorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "isConstantMorphism"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "reducedConstantMorphisms", "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658711077965*^9}},ExpressionUUID->"2f51730a-b19f-4097-9f28-\
5895ce9c4003"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<CoconstantMorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "coconstantMorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"coconstantMorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphismPairs", ",", 
             "isCoconstantMorphism"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphismPairs", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"isCoconstantMorphism", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{"isCoconstantMorphism", "=", "False"}]}], "]"}], 
                    ",", 
                    RowBox[{"isCoconstantMorphism", "=", "False"}]}], "]"}]}],
                     "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "/@", 
             "morphismPairs"}], ";", 
            RowBox[{"coconstantMorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"coconstantMorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "isCoconstantMorphism"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], 
       "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "coconstantMorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedCoconstantMorphisms\>\"", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedCoconstantMorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedCoconstantMorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphismPairs", ",", 
             "isCoconstantMorphism"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphismPairs", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"isCoconstantMorphism", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{"isCoconstantMorphism", "=", "False"}]}], "]"}], 
                    ",", 
                    RowBox[{"isCoconstantMorphism", "=", "False"}]}], "]"}]}],
                     "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "/@", 
             "morphismPairs"}], ";", 
            RowBox[{"reducedCoconstantMorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedCoconstantMorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                "isCoconstantMorphism"}]}], "]"}]}]}]}], "]"}], "&"}], ")"}], 
       "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "reducedCoconstantMorphisms", "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658706834494*^9}},ExpressionUUID->"24ba81d7-5bd8-4f99-90e1-\
aedbadca0fad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ZeroMorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "zeroMorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"zeroMorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphismPairs1", ",", 
             "morphismPairs2", ",", "isConstantMorphism", ",", 
             "isCoconstantMorphism"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphismPairs1", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"morphismPairs2", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"isConstantMorphism", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                    "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], "]"}],
                     "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{"isConstantMorphism", "=", "False"}]}], "]"}], 
                    ",", 
                    RowBox[{"isConstantMorphism", "=", "False"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "/@", 
             "morphismPairs1"}], ";", 
            RowBox[{"isCoconstantMorphism", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{"isCoconstantMorphism", "=", "False"}]}], "]"}], 
                    ",", 
                    RowBox[{"isCoconstantMorphism", "=", "False"}]}], "]"}]}],
                     "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "/@", 
             "morphismPairs2"}], ";", 
            RowBox[{"zeroMorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"zeroMorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{
                "isConstantMorphism", "&&", "isCoconstantMorphism"}]}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "zeroMorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696586973322725`*^9}},ExpressionUUID->"64950165-21de-4dad-9464-\
cfeb6217ef2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedZeroMorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedZeroMorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedZeroMorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphismPairs1", ",", 
             "morphismPairs2", ",", "isConstantMorphism", ",", 
             "isCoconstantMorphism"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphismPairs1", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"morphismPairs2", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"isConstantMorphism", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                    "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], "]"}],
                     "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{"isConstantMorphism", "=", "False"}]}], "]"}], 
                    ",", 
                    RowBox[{"isConstantMorphism", "=", "False"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "/@", 
             "morphismPairs1"}], ";", 
            RowBox[{"isCoconstantMorphism", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     "]"}], "\[Equal]", "0"}], ",", 
                    RowBox[{"isCoconstantMorphism", "=", "False"}]}], "]"}], 
                    ",", 
                    RowBox[{"isCoconstantMorphism", "=", "False"}]}], "]"}]}],
                     "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "/@", 
             "morphismPairs2"}], ";", 
            RowBox[{"reducedZeroMorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedZeroMorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{
                "isConstantMorphism", "&&", "isCoconstantMorphism"}]}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "reducedZeroMorphisms", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.86965868971646*^9}},ExpressionUUID->"31930fe5-93ff-4f72-8cf1-\
52fe64a2c710"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<DiscreteCategoryQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"reduceObjects", "[", 
         RowBox[{
          RowBox[{"reduceObjects", "[", 
           RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
          "objectEquivalences"}], "]"}], "]"}], "\[Equal]", 
       RowBox[{"Length", "[", 
        RowBox[{"Normal", "[", 
         RowBox[{"reduceArrowsFinal", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitial", "[", 
            RowBox[{"morphismAssociation", ",", "morphismEquivalences"}], 
            "]"}], ",", "objectEquivalences"}], "]"}], "]"}], "]"}]}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696586827668123`*^9}},ExpressionUUID->"b0edc585-33b2-4fc1-8696-\
bd7639e1b447"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<IndiscreteCategoryQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", "objectPairs", ",", 
       "isIndiscreteCategory"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectPairs", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
           "objectEquivalences"}], "]"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"isIndiscreteCategory", "=", "True"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"objectPair", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", 
                  RowBox[{"reduceArrowsFinal", "[", 
                   RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{
                    "morphismAssociation", ",", "morphismEquivalences"}], 
                    "]"}], ",", "objectEquivalences"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"First", "[", "objectPair", "]"}]}], "&&", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"Last", "[", "objectPair", "]"}]}]}], "&"}]}], 
                "]"}], "]"}], "\[NotEqual]", "1"}], ",", 
             RowBox[{"isIndiscreteCategory", "=", "False"}]}], "]"}]}], "]"}],
          "&"}], ")"}], "/@", "objectPairs"}], ";", "\[IndentingNewLine]", 
      "isIndiscreteCategory"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696586783302655`*^9}},ExpressionUUID->"6951b17b-3f57-464a-bcd9-\
bf6e2f3258fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<BalancedCategoryQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "reducedBimorphisms", ",", "reducedIsomorphisms", ",", 
       "isBalancedCategory"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedBimorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphismPairs1", ",", 
             "morphismPairs2", ",", "isMonomorphism", ",", "isEpimorphism"}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{"morphismPairs1", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"morphismPairs2", "=", 
             RowBox[{"Tuples", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    "]"}], ">", "0"}], "&"}]}], "]"}], ",", "2"}], "]"}]}], 
            ";", 
            RowBox[{"isMonomorphism", "=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                   "]"}], "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], "]"}],
                     "]"}], ">", "0"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"isMonomorphism", "=", "False"}]}], "]"}], ",", 
                    RowBox[{"isMonomorphism", "=", "False"}]}], "]"}]}], 
                  "]"}]}], "]"}], "&"}], ")"}], "/@", "morphismPairs1"}], ";", 
            RowBox[{"isEpimorphism", "=", "True"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                   "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     "]"}], ">", "0"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                    RowBox[{"isEpimorphism", "=", "False"}]}], "]"}], ",", 
                    RowBox[{"isEpimorphism", "=", "False"}]}], "]"}]}], 
                  "]"}]}], "]"}], "&"}], ")"}], "/@", "morphismPairs2"}], ";", 
            RowBox[{"reducedBimorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedBimorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{"isMonomorphism", "&&", "isEpimorphism"}]}]}], 
              "]"}]}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{
           "reducedMorphismAssociation", ",", "morphismEquivalences"}], "]"}],
           ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"reducedIsomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"reducedIsomorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedIsomorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{"isRetraction", "&&", "isSection"}]}]}], "]"}]}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", 
        RowBox[{"reduceArrowsFinal", "[", 
         RowBox[{
          RowBox[{"reduceArrowsInitial", "[", 
           RowBox[{"morphismAssociation", ",", "morphismEquivalences"}], 
           "]"}], ",", "objectEquivalences"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"isBalancedCategory", "=", "True"}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"reducedBimorphism", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "reducedBimorphism", "]"}], "===", 
              "True"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "[", 
                 RowBox[{"First", "[", 
                  RowBox[{"Select", "[", 
                   RowBox[{"reducedIsomorphisms", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "===", 
                    RowBox[{"First", "[", "reducedBimorphism", "]"}]}], 
                    "&"}]}], "]"}], "]"}], "]"}], "===", "False"}], ",", 
               RowBox[{"isBalancedCategory", "=", "False"}]}], "]"}]}], 
            "]"}]}], "]"}], "&"}], ")"}], "/@", "reducedBimorphisms"}], ";", 
      "isBalancedCategory"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696586743404417`*^9}},ExpressionUUID->"7a1e342b-b2f3-4587-8abf-\
35e9bcf3a84a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<GroupoidQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "objectEquivalenceGraph", ",", "morphismEquivalenceGraph", ",", 
       "isomorphisms", ",", "reducedMorphismAssociation", ",", 
       "reducedCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"objectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "objectEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"arrowEquivalences", ",", "morphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}]}]}], "]"}], 
        "]"}]}], ";", 
      RowBox[{"isomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"objectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "morphismEquivalenceGraph", "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"morphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"isomorphisms", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"isomorphisms", ",", 
               RowBox[{
                RowBox[{"First", "[", "morphism", "]"}], "\[Rule]", 
                RowBox[{"isRetraction", "&&", "isSection"}]}]}], "]"}]}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"reducedMorphism", "=", "#1"}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Select", "[", 
                 RowBox[{"isomorphisms", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "===", 
                    RowBox[{"First", "[", "reducedMorphism", "]"}]}], "&"}]}],
                  "]"}], "]"}], ">", "0"}], ",", 
              RowBox[{"Last", "[", 
               RowBox[{"First", "[", 
                RowBox[{"Select", "[", 
                 RowBox[{"isomorphisms", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "===", 
                    RowBox[{"First", "[", "reducedMorphism", "]"}]}], "&"}]}],
                  "]"}], "]"}], "]"}], ",", "False"}], "]"}]}], "]"}], "&"}], 
         ")"}], "/@", 
        RowBox[{"Normal", "[", 
         RowBox[{"reduceArrowsFinal", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitial", "[", 
            RowBox[{
            "reducedMorphismAssociation", ",", "morphismEquivalences"}], 
            "]"}], ",", "objectEquivalences"}], "]"}], "]"}]}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696586671374583`*^9}},ExpressionUUID->"af1165dd-a131-458d-854e-\
d5c6abaa436b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<GroupoidEquations\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "commutativityEquations"}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"And", "@@", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"arrow", "=", "#1"}], "}"}], ",", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "arrows", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"DirectedEdge", "@@", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "===", 
                   RowBox[{"Reverse", "[", 
                    RowBox[{"DirectedEdge", "@@", 
                    RowBox[{"Last", "[", "arrow", "]"}]}], "]"}]}], "&"}]}], 
                "]"}], "]"}], ">", "0"}]}], "]"}], "&"}], ")"}], "/@", 
         RowBox[{"Normal", "[", "arrows", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"morphismAssociation", "=", 
         RowBox[{"Association", "[", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Normal", "[", "arrows", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"compositions", "=", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Tuples", "[", 
               RowBox[{
                RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                "2"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "[", 
                 RowBox[{"Last", "[", 
                  RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
                RowBox[{"First", "[", 
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                    RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], 
                   ",", 
                   RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}]}], ",", 
                RowBox[{"morphismAssociation", "=", 
                 RowBox[{"Association", "[", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                    RowBox[{
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                    "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
            "compositions"}]}], ",", 
          RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"morphismAssociation", "=", 
         RowBox[{"Association", "[", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"First", "[", "#1", "]"}], "/.", 
                  RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
                "]"}], "]"}], "\[Equal]", 
              RowBox[{"Length", "[", 
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"First", "[", "#1", "]"}], "/.", 
                   RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
                 "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                RowBox[{
                 RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                 RowBox[{"DirectedEdge", "[", 
                  RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
             RowBox[{"morphismAssociation", "=", 
              RowBox[{"Association", "[", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
            "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
        RowBox[{"commutativityEquations", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"EdgeList", "[", 
               RowBox[{"TransitiveReductionGraph", "[", 
                RowBox[{"Graph", "[", 
                 RowBox[{"Apply", "[", 
                  RowBox[{"UndirectedEdge", ",", 
                   RowBox[{"Tuples", "[", 
                    RowBox[{
                    RowBox[{"First", "/@", "#1"}], ",", "2"}], "]"}], ",", 
                   RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], "/.", 
              RowBox[{"UndirectedEdge", "\[Rule]", "Equal"}]}], "&"}], ")"}], 
           "/@", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"GatherBy", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                   RowBox[{"DirectedEdge", "@@", 
                    RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
                RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
               "Last"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#1", "]"}], ">", "1"}], "&"}]}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], ",", 
                RowBox[{"identitySymbol", "[", "x_", "]"}]}], "]"}], "||", 
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"Last", "[", "#1", "]"}], ",", 
                RowBox[{"identitySymbol", "[", "x_", "]"}]}], "]"}]}], ",", 
             "#1", ",", 
             RowBox[{"Reverse", "[", "#1", "]"}]}], "]"}], "&"}], ")"}], "/@",
          "commutativityEquations"}]}], ",", "Indeterminate"}], "]"}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696586616427584`*^9}},ExpressionUUID->"d3e7943a-0729-48f2-b559-\
05347bbfd179"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedGroupoidEquations\>\"", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "commutativityEquations"}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"And", "@@", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"arrow", "=", "#1"}], "}"}], ",", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", 
                  RowBox[{"reduceArrowsFinal", "[", 
                   RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{
                    RowBox[{"reduceArrowsFinal", "[", 
                    RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
                    "quiverObjectEquivalences"}], "]"}], ",", 
                    "morphismEquivalences"}], "]"}], ",", 
                    "objectEquivalences"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"DirectedEdge", "@@", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "===", 
                   RowBox[{"Reverse", "[", 
                    RowBox[{"DirectedEdge", "@@", 
                    RowBox[{"Last", "[", "arrow", "]"}]}], "]"}]}], "&"}]}], 
                "]"}], "]"}], ">", "0"}]}], "]"}], "&"}], ")"}], "/@", 
         RowBox[{"Normal", "[", 
          RowBox[{"reduceArrowsFinal", "[", 
           RowBox[{
            RowBox[{"reduceArrowsInitial", "[", 
             RowBox[{
              RowBox[{"reduceArrowsFinal", "[", 
               RowBox[{
                RowBox[{"reduceArrowsInitial", "[", 
                 RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
                "quiverObjectEquivalences"}], "]"}], ",", 
              "morphismEquivalences"}], "]"}], ",", "objectEquivalences"}], 
           "]"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"morphismAssociation", "=", 
         RowBox[{"Association", "[", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Normal", "[", 
             RowBox[{"reduceArrowsFinal", "[", 
              RowBox[{
               RowBox[{"reduceArrowsInitial", "[", 
                RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
               "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"compositions", "=", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Tuples", "[", 
               RowBox[{
                RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                "2"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "[", 
                 RowBox[{"Last", "[", 
                  RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
                RowBox[{"First", "[", 
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                    RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], 
                   ",", 
                   RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}]}], ",", 
                RowBox[{"morphismAssociation", "=", 
                 RowBox[{"Association", "[", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                    RowBox[{
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                    "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
            "compositions"}]}], ",", 
          RowBox[{"Length", "[", 
           RowBox[{"reduceObjects", "[", 
            RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
           "]"}]}], "]"}], ";", 
        RowBox[{"morphismAssociation", "=", 
         RowBox[{"Association", "[", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"First", "[", "#1", "]"}], "/.", 
                  RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
                "]"}], "]"}], "\[Equal]", 
              RowBox[{"Length", "[", 
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"First", "[", "#1", "]"}], "/.", 
                   RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
                 "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                RowBox[{
                 RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                 RowBox[{"DirectedEdge", "[", 
                  RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
             RowBox[{"morphismAssociation", "=", 
              RowBox[{"Association", "[", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
            "]"}], "&"}], ")"}], "/@", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"commutativityEquations", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"EdgeList", "[", 
               RowBox[{"TransitiveReductionGraph", "[", 
                RowBox[{"Graph", "[", 
                 RowBox[{"Apply", "[", 
                  RowBox[{"UndirectedEdge", ",", 
                   RowBox[{"Tuples", "[", 
                    RowBox[{
                    RowBox[{"First", "/@", "#1"}], ",", "2"}], "]"}], ",", 
                   RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], "/.", 
              RowBox[{"UndirectedEdge", "\[Rule]", "Equal"}]}], "&"}], ")"}], 
           "/@", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"GatherBy", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                   RowBox[{"DirectedEdge", "@@", 
                    RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
                RowBox[{"Normal", "[", 
                 RowBox[{"reduceArrowsFinal", "[", 
                  RowBox[{
                   RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{
                    "morphismAssociation", ",", "morphismEquivalences"}], 
                    "]"}], ",", "objectEquivalences"}], "]"}], "]"}]}], ",", 
               "Last"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#1", "]"}], ">", "1"}], "&"}]}], 
            "]"}]}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], ",", 
                RowBox[{"identitySymbol", "[", "x_", "]"}]}], "]"}], "||", 
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"Last", "[", "#1", "]"}], ",", 
                RowBox[{"identitySymbol", "[", "x_", "]"}]}], "]"}]}], ",", 
             "#1", ",", 
             RowBox[{"Reverse", "[", "#1", "]"}]}], "]"}], "&"}], ")"}], "/@",
          "commutativityEquations"}]}], ",", "Indeterminate"}], "]"}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696586571777663`*^9}},ExpressionUUID->"8e542dea-1b67-4227-a250-\
4ccd3e9a463e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<FullLabeledGraph\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"EdgeTaggedGraph", "[", 
       RowBox[{"objects", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"DirectedEdge", "@@", 
              RowBox[{"Last", "[", "#1", "]"}]}], ",", 
             RowBox[{"Placed", "[", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], ",", "0.5"}], "]"}]}], 
            "]"}], "&"}], ")"}], "/@", 
         RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
        RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
        RowBox[{"VertexStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Transparent", ",", 
           RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
        RowBox[{"VertexLabels", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
        RowBox[{"VertexLabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
        RowBox[{"EdgeLabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
        RowBox[{"EdgeStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
        RowBox[{"GraphLayout", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
           RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658650923259*^9}},ExpressionUUID->"ebc55b8a-d86d-4e9d-8e42-\
7bc917b103bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<FullUnlabeledGraph\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"EdgeTaggedGraph", "[", 
       RowBox[{"objects", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DirectedEdge", "@@", 
            RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
         RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
        RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
        RowBox[{"VertexStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Transparent", ",", 
           RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
        RowBox[{"VertexLabels", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
        RowBox[{"VertexLabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
        RowBox[{"EdgeLabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
        RowBox[{"EdgeStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
        RowBox[{"GraphLayout", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
           RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696586460430145`*^9}},ExpressionUUID->"e9db3d31-f384-4d57-8877-\
401cd8af0fc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedLabeledGraph\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EdgeTaggedGraph", "[", 
       RowBox[{
        RowBox[{"reduceObjects", "[", 
         RowBox[{
          RowBox[{"reduceObjects", "[", 
           RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
          "objectEquivalences"}], "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"DirectedEdge", "@@", 
              RowBox[{"Last", "[", "#1", "]"}]}], ",", 
             RowBox[{"Placed", "[", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], ",", "0.5"}], "]"}]}], 
            "]"}], "&"}], ")"}], "/@", 
         RowBox[{"Normal", "[", 
          RowBox[{"reduceArrowsFinal", "[", 
           RowBox[{
            RowBox[{"reduceArrowsInitial", "[", 
             RowBox[{"morphismAssociation", ",", "morphismEquivalences"}], 
             "]"}], ",", "objectEquivalences"}], "]"}], "]"}]}], ",", 
        RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
        RowBox[{"VertexStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Transparent", ",", 
           RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
        RowBox[{"VertexLabels", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
        RowBox[{"VertexLabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
        RowBox[{"EdgeLabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
        RowBox[{"EdgeStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
        RowBox[{"GraphLayout", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
           RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696586414932327`*^9}},ExpressionUUID->"929554fc-e034-4c47-875e-\
fe85767df8b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedUnlabeledGraph\>\"", "]"}], 
  ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EdgeTaggedGraph", "[", 
       RowBox[{
        RowBox[{"reduceObjects", "[", 
         RowBox[{
          RowBox[{"reduceObjects", "[", 
           RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
          "objectEquivalences"}], "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DirectedEdge", "@@", 
            RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
         RowBox[{"Normal", "[", 
          RowBox[{"reduceArrowsFinal", "[", 
           RowBox[{
            RowBox[{"reduceArrowsInitial", "[", 
             RowBox[{"morphismAssociation", ",", "morphismEquivalences"}], 
             "]"}], ",", "objectEquivalences"}], "]"}], "]"}]}], ",", 
        RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
        RowBox[{"VertexStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Transparent", ",", 
           RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
        RowBox[{"VertexLabels", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
        RowBox[{"VertexLabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
        RowBox[{"EdgeLabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
        RowBox[{"EdgeStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
        RowBox[{"GraphLayout", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
           RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658636424027*^9}},ExpressionUUID->"c22b2659-38cb-4207-b514-\
d761f145bd43"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<SimpleLabeledGraph\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EdgeTaggedGraph", "[", 
       RowBox[{"objects", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"DirectedEdge", "@@", 
              RowBox[{"Last", "[", "#1", "]"}]}], ",", 
             RowBox[{"Placed", "[", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], ",", "0.5"}], "]"}]}], 
            "]"}], "&"}], ")"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicatesBy", "[", 
            RowBox[{
             RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
             RowBox[{
              RowBox[{"DirectedEdge", "@@", 
               RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
             RowBox[{"Last", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], 
        ",", 
        RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
        RowBox[{"VertexStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Transparent", ",", 
           RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
        RowBox[{"VertexLabels", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
        RowBox[{"VertexLabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
        RowBox[{"EdgeLabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
        RowBox[{"EdgeStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
        RowBox[{"GraphLayout", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
           RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658632307721*^9}},ExpressionUUID->"11f9d24a-7979-4039-bd09-\
f7720b72824c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<SimpleUnlabeledGraph\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EdgeTaggedGraph", "[", 
       RowBox[{"objects", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DirectedEdge", "@@", 
            RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicatesBy", "[", 
            RowBox[{
             RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
             RowBox[{
              RowBox[{"DirectedEdge", "@@", 
               RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
             RowBox[{"Last", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], 
        ",", 
        RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
        RowBox[{"VertexStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Transparent", ",", 
           RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
        RowBox[{"VertexLabels", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
        RowBox[{"VertexLabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
        RowBox[{"EdgeStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
        RowBox[{"GraphLayout", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
           RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696586298221993`*^9}},ExpressionUUID->"d1ce130b-8a43-47fe-bb10-\
5692bddc9c25"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedSimpleLabeledGraph\>\"", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EdgeTaggedGraph", "[", 
       RowBox[{
        RowBox[{"reduceObjects", "[", 
         RowBox[{
          RowBox[{"reduceObjects", "[", 
           RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
          "objectEquivalences"}], "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"DirectedEdge", "@@", 
              RowBox[{"Last", "[", "#1", "]"}]}], ",", 
             RowBox[{"Placed", "[", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], ",", "0.5"}], "]"}]}], 
            "]"}], "&"}], ")"}], "/@", 
         RowBox[{"Normal", "[", 
          RowBox[{"reduceArrowsFinal", "[", 
           RowBox[{
            RowBox[{"reduceArrowsInitial", "[", 
             RowBox[{
              RowBox[{"Association", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"DeleteDuplicatesBy", "[", 
                  RowBox[{
                   RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                   RowBox[{
                    RowBox[{"DirectedEdge", "@@", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
                   RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}],
                "]"}], ",", "morphismEquivalences"}], "]"}], ",", 
            "objectEquivalences"}], "]"}], "]"}]}], ",", 
        RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
        RowBox[{"VertexStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Transparent", ",", 
           RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
        RowBox[{"VertexLabels", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
        RowBox[{"VertexLabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
        RowBox[{"EdgeLabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
        RowBox[{"EdgeStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
        RowBox[{"GraphLayout", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
           RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.869658623962433*^9}},ExpressionUUID->"8dab4de3-c008-4ca5-863f-\
dadadb4a1a54"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<ReducedSimpleUnlabeledGraph\>\"", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EdgeTaggedGraph", "[", 
       RowBox[{
        RowBox[{"reduceObjects", "[", 
         RowBox[{
          RowBox[{"reduceObjects", "[", 
           RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
          "objectEquivalences"}], "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DirectedEdge", "@@", 
            RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
         RowBox[{"Normal", "[", 
          RowBox[{"reduceArrowsFinal", "[", 
           RowBox[{
            RowBox[{"reduceArrowsInitial", "[", 
             RowBox[{
              RowBox[{"Association", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"DeleteDuplicatesBy", "[", 
                  RowBox[{
                   RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                   RowBox[{
                    RowBox[{"DirectedEdge", "@@", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
                   RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}],
                "]"}], ",", "morphismEquivalences"}], "]"}], ",", 
            "objectEquivalences"}], "]"}], "]"}]}], ",", 
        RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
        RowBox[{"VertexStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Transparent", ",", 
           RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
        RowBox[{"VertexLabels", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
        RowBox[{"VertexLabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
        RowBox[{"EdgeStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
        RowBox[{"GraphLayout", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
           RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences_List"}]
       , ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<AssociationForm\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{
         "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
         RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
         RowBox[{
         "\"\<ObjectEquivalences\>\"", "\[Rule]", 
          "quiverObjectEquivalences"}], ",", 
         RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], "]"}]}], 
     ",", 
     RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
     ",", 
     RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
     RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}], 
     ",", 
     RowBox[{
     "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696586148392267`*^9}},ExpressionUUID->"bee19db7-009e-46c3-84f5-\
28a8718a4350"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "[", "\"\<Properties\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\"\<Objects\>\"", ",", "\"\<ObjectCount\>\"", ",", 
     "\"\<MorphismAssociation\>\"", ",", "\"\<MorphismNames\>\"", ",", 
     "\"\<MorphismEdges\>\"", ",", "\"\<MorphismCount\>\"", ",", 
     "\"\<ObjectEquivalences\>\"", ",", "\"\<ObjectEquivalenceCount\>\"", 
     ",", "\"\<MorphismEquivalences\>\"", ",", 
     "\"\<MorphismEquivalenceCount\>\"", ",", "\"\<ReducedObjects\>\"", ",", 
     "\"\<ReducedObjectCount\>\"", ",", "\"\<ReducedMorphismAssociation\>\"", 
     ",", "\"\<ReducedMorphismNames\>\"", ",", "\"\<ReducedMorphismEdges\>\"",
      ",", "\"\<ReducedMorphismCount\>\"", ",", 
     "\"\<SimpleMorphismAssociation\>\"", ",", "\"\<SimpleMorphismNames\>\"", 
     ",", "\"\<SimpleMorphismEdges\>\"", ",", "\"\<SimpleMorphismCount\>\"", 
     ",", "\"\<ReducedSimpleMorphismAssociation\>\"", ",", 
     "\"\<ReducedSimpleMorphismNames\>\"", ",", 
     "\"\<ReducedSimpleMorphismEdges\>\"", ",", 
     "\"\<ReducedSimpleMorphismCount\>\"", ",", "\"\<CompositionSymbol\>\"", 
     ",", "\"\<IdentitySymbol\>\"", ",", "\"\<DualCategory\>\"", ",", 
     "\"\<Quiver\>\"", ",", "\"\<AssociativityEquations\>\"", ",", 
     "\"\<ReducedAssociativityEquations\>\"", ",", 
     "\"\<IdentityEquations\>\"", ",", "\"\<ReducedIdentityEquations\>\"", 
     ",", "\"\<CommutativeDiagramQ\>\"", ",", 
     "\"\<CommutativityEquations\>\"", ",", 
     "\"\<ReducedCommutativityEquations\>\"", ",", "\"\<Monomorphisms\>\"", 
     ",", "\"\<ReducedMonomorphisms\>\"", ",", "\"\<Epimorphisms\>\"", ",", 
     "\"\<ReducedEpimorphisms\>\"", ",", "\"\<Bimorphisms\>\"", ",", 
     "\"\<ReducedBimorphisms\>\"", ",", "\"\<Retractions\>\"", ",", 
     "\"\<ReducedRetractions\>\"", ",", "\"\<LeftInverses\>\"", ",", 
     "\"\<ReducedLeftInverses\>\"", ",", "\"\<Sections\>\"", ",", 
     "\"\<ReducedSections\>\"", ",", "\"\<RightInverses\>\"", ",", 
     "\"\<ReducedRightInverses\>\"", ",", "\"\<Isomorphisms\>\"", ",", 
     "\"\<ReducedIsomorphisms\>\"", ",", "\"\<Inverses\>\"", ",", 
     "\"\<ReducedInverses\>\"", ",", "\"\<Endomorphisms\>\"", ",", 
     "\"\<ReducedEndomorphisms\>\"", ",", "\"\<Automorphisms\>\"", ",", 
     "\"\<ReducedAutomorphisms\>\"", ",", "\"\<InitialObjects\>\"", ",", 
     "\"\<ReducedInitialObjects\>\"", ",", "\"\<StrictInitialObjects\>\"", 
     ",", "\"\<ReducedStrictInitialObjects\>\"", ",", 
     "\"\<TerminalObjects\>\"", ",", "\"\<ReducedTerminalObjects\>\"", ",", 
     "\"\<StrictTerminalObjects\>\"", ",", 
     "\"\<ReducedStrictTerminalObjects\>\"", ",", "\"\<ZeroObjects\>\"", ",", 
     "\"\<ReducedZeroObjects\>\"", ",", "\"\<StrictZeroObjects\>\"", ",", 
     "\"\<ReducedStrictZeroObjects\>\"", ",", "\"\<PointedCategoryQ\>\"", 
     ",", "\"\<ConstantMorphisms\>\"", ",", 
     "\"\<ReducedConstantMorphisms\>\"", ",", "\"\<CoconstantMorphisms\>\"", 
     ",", "\"\<ReducedCoconstantMorphisms\>\"", ",", "\"\<ZeroMorphisms\>\"", 
     ",", "\"\<ReducedZeroMorphisms\>\"", ",", "\"\<DiscreteCategoryQ\>\"", 
     ",", "\"\<IndiscreteCategoryQ\>\"", ",", "\"\<BalancedCategoryQ\>\"", 
     ",", "\"\<GroupoidQ\>\"", ",", "\"\<GroupoidEquations\>\"", ",", 
     "\"\<ReducedGroupoidEquations\>\"", ",", "\"\<FullLabeledGraph\>\"", 
     ",", "\"\<FullUnlabeledGraph\>\"", ",", "\"\<ReducedLabeledGraph\>\"", 
     ",", "\"\<ReducedUnlabeledGraph\>\"", ",", "\"\<SimpleLabeledGraph\>\"", 
     ",", "\"\<SimpleUnlabeledGraph\>\"", ",", 
     "\"\<ReducedSimpleLabeledGraph\>\"", ",", 
     "\"\<ReducedSimpleUnlabeledGraph\>\"", ",", "\"\<AssociationForm\>\"", 
     ",", "\"\<Properties\>\""}], "}"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696585932417946`*^9}},ExpressionUUID->"5f95ea34-4289-4f1b-bd41-\
81b28c90f8f4"],

Cell[BoxData[
 RowBox[{"AbstractCategory", "/:", 
  RowBox[{"MakeBoxes", "[", 
   RowBox[{
    RowBox[{"abstractCategory", ":", 
     RowBox[{"AbstractCategory", "[", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{
        "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
        RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
        RowBox[{
        "\"\<MorphismEquivalences\>\"", "\[Rule]", 
         "morphismEquivalences_List"}], ",", 
        RowBox[{
        "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
        ",", 
        RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
         RowBox[{
          RowBox[{"(", "abstractQuiver_", ")"}], "[", 
          RowBox[{"Association", "[", 
           RowBox[{
            RowBox[{
            "\"\<ArrowEquivalences\>\"", "\[Rule]", 
             "arrowEquivalences_List"}], ",", 
            RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
            RowBox[{
            "\"\<ObjectEquivalences\>\"", "\[Rule]", 
             "quiverObjectEquivalences_List"}], ",", 
            RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
          "]"}]}]}], "]"}], "]"}]}], ",", "format_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "morphismAssociation", ",", "compositions", ",", 
       "reducedMorphismAssociation", ",", "reducedCompositions", ",", "icon", 
       ",", "commutativeDiagram", ",", "objectCount", ",", "morphismCount", 
       ",", "reducedObjectCount", ",", "reducedMorphismCount"}], "}"}], ",", 
     RowBox[{
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",",
               "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedMorphismAssociation", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "reducedMorphismAssociation", "]"}], 
               ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"icon", "=", 
       RowBox[{"GraphPlot", "[", 
        RowBox[{"EdgeTaggedGraph", "[", 
         RowBox[{"objects", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"DirectedEdge", "@@", 
              RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
           RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
          RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
          RowBox[{"VertexStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Transparent", ",", 
             RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
          RowBox[{"EdgeShapeFunction", "\[Rule]", 
           RowBox[{"GraphElementData", "[", 
            RowBox[{"\"\<ShortFilledArrow\>\"", ",", 
             RowBox[{"\"\<ArrowSize\>\"", "\[Rule]", "0.05"}]}], "]"}]}], ",", 
          RowBox[{"EdgeStyle", "\[Rule]", "Black"}], ",", 
          RowBox[{"GraphLayout", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
             RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"commutativeDiagram", "=", 
       RowBox[{"AllTrue", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"CountsBy", "[", 
           RowBox[{
            RowBox[{"Normal", "[", 
             RowBox[{"reduceArrowsFinal", "[", 
              RowBox[{
               RowBox[{"reduceArrowsInitial", "[", 
                RowBox[{
                "reducedMorphismAssociation", ",", "morphismEquivalences"}], 
                "]"}], ",", "objectEquivalences"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"DirectedEdge", "@@", 
              RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Last", "[", "#1", "]"}], "\[Equal]", "1"}], "&"}]}], 
        "]"}]}], ";", 
      RowBox[{"objectCount", "=", 
       RowBox[{"Length", "[", "objects", "]"}]}], ";", 
      RowBox[{"morphismCount", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"Normal", "[", "morphismAssociation", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reducedObjectCount", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"reduceObjects", "[", 
         RowBox[{
          RowBox[{"reduceObjects", "[", 
           RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedMorphismCount", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"Normal", "[", 
         RowBox[{"reduceArrowsFinal", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitial", "[", 
            RowBox[{
            "reducedMorphismAssociation", ",", "morphismEquivalences"}], 
            "]"}], ",", "objectEquivalences"}], "]"}], "]"}], "]"}]}], ";", 
      RowBox[{"BoxForm`ArrangeSummaryBox", "[", 
       RowBox[{
       "\"\<AbstractCategory\>\"", ",", "abstractCategory", ",", "icon", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"BoxForm`SummaryItem", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Commutative Diagram: \>\"", ",", "commutativeDiagram"}], 
             "}"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"BoxForm`SummaryItem", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Objects: \>\"", ",", "objectCount"}], "}"}], "]"}],
             ",", 
            RowBox[{"BoxForm`SummaryItem", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Morphisms: \>\"", ",", "morphismCount"}], "}"}], 
             "]"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"BoxForm`SummaryItem", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Reduced Objects: \>\"", ",", "reducedObjectCount"}],
              "}"}], "]"}], ",", 
           RowBox[{"BoxForm`SummaryItem", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Reduced Morphisms: \>\"", ",", "reducedMorphismCount"}], 
             "}"}], "]"}]}], "}"}], "}"}], ",", "format", ",", 
        RowBox[{"\"\<Interpretable\>\"", "\[Rule]", "Automatic"}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696585881984053`*^9}},ExpressionUUID->"976308e5-bca0-439c-ad76-\
ed75aa566830"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AbstractCategory", "[", "arrows_List", "]"}], ":=", 
  RowBox[{"AbstractCategory", "[", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
     RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
     RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
          RowBox[{"Association", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"\"\<\[FormalF]\>\"", ",", 
                 RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
               RowBox[{"arrows", "[", 
                RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "arrows", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\"\<Objects\>\"", "\[Rule]", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "arrows", ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}]}]}], "]"}], 
       "]"}]}]}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", "arrows_Association", "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", 
               RowBox[{"Last", "/@", 
                RowBox[{"Normal", "[", "arrows", "]"}]}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}]}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{"objects_List", ",", "arrows_List"}], "]"}], ":=", 
  RowBox[{"AbstractCategory", "[", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
     RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
     RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
          RowBox[{"Association", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"\"\<\[FormalF]\>\"", ",", 
                 RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
               RowBox[{"arrows", "[", 
                RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "arrows", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
       "]"}]}]}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{"objects_List", ",", "arrows_Association"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{"objects_List", ",", "arrows_List", ",", "compositionSymbol_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<\[FormalF]\>\"", ",", 
                  RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
                RowBox[{"arrows", "[", 
                 RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "arrows", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{"!", 
    RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "objects_List", ",", "arrows_Association", ",", "compositionSymbol_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "objects_List", ",", "arrows_List", ",", "compositionSymbol_", ",", 
    "identitySymbol_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<\[FormalF]\>\"", ",", 
                  RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
                RowBox[{"arrows", "[", 
                 RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "arrows", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "identitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "objects_List", ",", "arrows_Association", ",", "compositionSymbol_", ",", 
    "identitySymbol_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "identitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "objects_List", ",", "arrows_List", ",", "objectEquivalences_List"}], 
   "]"}], ":=", 
  RowBox[{"AbstractCategory", "[", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
     RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
     RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}], 
     ",", 
     RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
          RowBox[{"Association", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"\"\<\[FormalF]\>\"", ",", 
                 RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
               RowBox[{"arrows", "[", 
                RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "arrows", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
       "]"}]}]}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "objects_List", ",", "arrows_Association", ",", 
    "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "objects_List", ",", "arrows_List", ",", "objectEquivalences_List", ",", 
    "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{"AbstractCategory", "[", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
     RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
     RowBox[{
     "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], ",", 
     RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}], 
     ",", 
     RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
          RowBox[{"Association", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"\"\<\[FormalF]\>\"", ",", 
                 RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
               RowBox[{"arrows", "[", 
                RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "arrows", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
       "]"}]}]}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "objects_List", ",", "arrows_Association", ",", "objectEquivalences_List", 
    ",", "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "objects_List", ",", "arrows_List", ",", "compositionSymbol_", ",", 
    "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<\[FormalF]\>\"", ",", 
                  RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
                RowBox[{"arrows", "[", 
                 RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "arrows", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{"!", 
    RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "objects_List", ",", "arrows_Association", ",", "compositionSymbol_", ",", 
    "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "objects_List", ",", "arrows_List", ",", "compositionSymbol_", ",", 
    "objectEquivalences_List", ",", "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<\[FormalF]\>\"", ",", 
                  RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
                RowBox[{"arrows", "[", 
                 RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "arrows", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{"!", 
    RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "objects_List", ",", "arrows_Association", ",", "compositionSymbol_", ",", 
    "objectEquivalences_List", ",", "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "objects_List", ",", "arrows_List", ",", "compositionSymbol_", ",", 
    "identitySymbol_", ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<\[FormalF]\>\"", ",", 
                  RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
                RowBox[{"arrows", "[", 
                 RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "arrows", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "identitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "objects_List", ",", "arrows_Association", ",", "compositionSymbol_", ",", 
    "identitySymbol_", ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "identitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "objects_List", ",", "arrows_List", ",", "compositionSymbol_", ",", 
    "identitySymbol_", ",", "objectEquivalences_List", ",", 
    "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<\[FormalF]\>\"", ",", 
                  RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
                RowBox[{"arrows", "[", 
                 RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "arrows", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "identitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "objects_List", ",", "arrows_Association", ",", "compositionSymbol_", ",", 
    "identitySymbol_", ",", "objectEquivalences_List", ",", 
    "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "identitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{"arrows_Association", ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", 
               RowBox[{"Last", "/@", 
                RowBox[{"Normal", "[", "arrows", "]"}]}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}]}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "arrows_Association", ",", "objectEquivalences_List", ",", 
    "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", 
               RowBox[{"Last", "/@", 
                RowBox[{"Normal", "[", "arrows", "]"}]}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}]}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{"arrows_Association", ",", "compositionSymbol_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", 
               RowBox[{"Last", "/@", 
                RowBox[{"Normal", "[", "arrows", "]"}]}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}]}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "arrows_Association", ",", "compositionSymbol_", ",", 
    "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", 
               RowBox[{"Last", "/@", 
                RowBox[{"Normal", "[", "arrows", "]"}]}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}]}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "arrows_Association", ",", "compositionSymbol_", ",", 
    "objectEquivalences_List", ",", "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", 
               RowBox[{"Last", "/@", 
                RowBox[{"Normal", "[", "arrows", "]"}]}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}]}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "arrows_Association", ",", "compositionSymbol_", ",", "identitySymbol_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", 
               RowBox[{"Last", "/@", 
                RowBox[{"Normal", "[", "arrows", "]"}]}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}]}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "identitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "arrows_Association", ",", "compositionSymbol_", ",", "identitySymbol_", 
    ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", 
               RowBox[{"Last", "/@", 
                RowBox[{"Normal", "[", "arrows", "]"}]}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}]}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "identitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "arrows_Association", ",", "compositionSymbol_", ",", "identitySymbol_", 
    ",", "objectEquivalences_List", ",", "morphismEquivalences_List"}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", 
               RowBox[{"Last", "/@", 
                RowBox[{"Normal", "[", "arrows", "]"}]}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}]}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<CompositionSymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<IdentitySymbol\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<MorphismEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<ObjectEquivalences\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"KeyExistsQ", "[", 
      RowBox[{"arrows", ",", "\"\<Quiver\>\""}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "identitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{"(", "abstractQuiver_", ")"}], "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], ",", 
      RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], "]"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}], 
          ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractQuiver_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], "]"}],
     ",", "compositionSymbol_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}], 
          ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractQuiver_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], "]"}],
     ",", "compositionSymbol_", ",", "identitySymbol_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}], 
          ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "identitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractQuiver_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "quiverObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], "]"}],
     ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractQuiver_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "quiverObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], "]"}],
     ",", "objectEquivalences_List", ",", "morphismEquivalences_List"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractQuiver_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "quiverObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], "]"}],
     ",", "compositionSymbol_", ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractQuiver_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "quiverObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], "]"}],
     ",", "compositionSymbol_", ",", "objectEquivalences_List", ",", 
    "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractQuiver_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "quiverObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], "]"}],
     ",", "compositionSymbol_", ",", "identitySymbol_", ",", 
    "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "identitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractQuiver_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "quiverObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], "]"}],
     ",", "compositionSymbol_", ",", "identitySymbol_", ",", 
    "objectEquivalences_List", ",", "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "identitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", "quiverGraph_Graph", "]"}], ":=", 
  RowBox[{"AbstractCategory", "[", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
     RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
     RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
          RowBox[{"Association", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"\"\<\[FormalF]\>\"", ",", 
                 RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "[", 
                RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", 
              RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "]"}], "]"}]}], 
           "]"}]}], ",", 
         RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\"\<Objects\>\"", "\[Rule]", 
          RowBox[{"VertexList", "[", "quiverGraph", "]"}]}]}], "]"}], 
       "]"}]}]}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{"quiverGraph_Graph", ",", "compositionSymbol_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<\[FormalF]\>\"", ",", 
                  RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "[", 
                 RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", 
               RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "]"}], "]"}]}], 
            "]"}]}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"VertexList", "[", "quiverGraph", "]"}]}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{"!", 
    RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "quiverGraph_Graph", ",", "compositionSymbol_", ",", "identitySymbol_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<\[FormalF]\>\"", ",", 
                  RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "[", 
                 RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", 
               RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "]"}], "]"}]}], 
            "]"}]}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"VertexList", "[", "quiverGraph", "]"}]}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "identitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{"quiverGraph_Graph", ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{"AbstractCategory", "[", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
     RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
     RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}], 
     ",", 
     RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
          RowBox[{"Association", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"\"\<\[FormalF]\>\"", ",", 
                 RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "[", 
                RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", 
              RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "]"}], "]"}]}], 
           "]"}]}], ",", 
         RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\"\<Objects\>\"", "\[Rule]", 
          RowBox[{"VertexList", "[", "quiverGraph", "]"}]}]}], "]"}], 
       "]"}]}]}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "quiverGraph_Graph", ",", "objectEquivalences_List", ",", 
    "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{"AbstractCategory", "[", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "CircleDot"}], ",", 
     RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
     RowBox[{
     "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], ",", 
     RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}], 
     ",", 
     RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
          RowBox[{"Association", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"\"\<\[FormalF]\>\"", ",", 
                 RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "[", 
                RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", 
              RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "]"}], "]"}]}], 
           "]"}]}], ",", 
         RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\"\<Objects\>\"", "\[Rule]", 
          RowBox[{"VertexList", "[", "quiverGraph", "]"}]}]}], "]"}], 
       "]"}]}]}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "quiverGraph_Graph", ",", "compositionSymbol_", ",", 
    "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<\[FormalF]\>\"", ",", 
                  RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "[", 
                 RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", 
               RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "]"}], "]"}]}], 
            "]"}]}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"VertexList", "[", "quiverGraph", "]"}]}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{"!", 
    RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "quiverGraph_Graph", ",", "compositionSymbol_", ",", 
    "objectEquivalences_List", ",", "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "OverTilde"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<\[FormalF]\>\"", ",", 
                  RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "[", 
                 RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", 
               RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "]"}], "]"}]}], 
            "]"}]}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"VertexList", "[", "quiverGraph", "]"}]}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{"!", 
    RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "quiverGraph_Graph", ",", "compositionSymbol_", ",", "identitySymbol_", 
    ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<\[FormalF]\>\"", ",", 
                  RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "[", 
                 RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", 
               RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "]"}], "]"}]}], 
            "]"}]}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"VertexList", "[", "quiverGraph", "]"}]}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "identitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
   "quiverGraph_Graph", ",", "compositionSymbol_", ",", "identitySymbol_", 
    ",", "objectEquivalences_List", ",", "morphismEquivalences_List"}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<\[FormalF]\>\"", ",", 
                  RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "[", 
                 RowBox[{"[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", 
               RowBox[{"EdgeList", "[", "quiverGraph", "]"}], "]"}], "]"}]}], 
            "]"}]}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"VertexList", "[", "quiverGraph", "]"}]}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "compositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "identitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", "category_Association", "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"KeySort", "[", "category", "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"category", ",", "\"\<CompositionSymbol\>\""}], "]"}], "&&", 
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"category", ",", "\"\<IdentitySymbol\>\""}], "]"}], "&&", 
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"category", ",", "\"\<MorphismEquivalences\>\""}], "]"}], "&&", 
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"category", ",", "\"\<ObjectEquivalences\>\""}], "]"}], "&&", 
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"category", ",", "\"\<Quiver\>\""}], "]"}], "&&", 
    RowBox[{
     RowBox[{"Keys", "[", 
      RowBox[{"KeySort", "[", "category", "]"}], "]"}], "=!=", 
     RowBox[{"Keys", "[", "category", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{"AbstractCategory", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "newCompositionSymbol_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<CompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{"AbstractCategory", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "newCompositionSymbol_", ",", 
    "newIdentitySymbol_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<CompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newIdentitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{"AbstractCategory", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "newCompositionSymbol_", ",", 
    "newIdentitySymbol_", ",", "newObjectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<CompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "newObjectEquivalences"}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newIdentitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{"AbstractCategory", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "newCompositionSymbol_", ",", 
    "newIdentitySymbol_", ",", "newObjectEquivalences_List", ",", 
    "newMorphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<CompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "newMorphismEquivalences"}], 
      ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "newObjectEquivalences"}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newIdentitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{"AbstractCategory", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "newObjectEquivalences_List"}], "]"}], 
  ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "newObjectEquivalences"}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{"AbstractCategory", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "newObjectEquivalences_List", ",", 
    "newMorphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "newMorphismEquivalences"}], 
      ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "newObjectEquivalences"}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
    "\"\<AbstractQuiver\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{"AbstractCategory", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "newCompositionSymbol_", ",", 
    "newObjectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<CompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "newObjectEquivalences"}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractCategory", "[", 
   RowBox[{
    RowBox[{"AbstractCategory", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "newCompositionSymbol_", ",", 
    "newObjectEquivalences_List", ",", "newMorphismEquivalences_List"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<CompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "newMorphismEquivalences"}], 
      ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "newObjectEquivalences"}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8696581935317817`*^9, 3.8696581935474014`*^9}, {
  3.8696583718202224`*^9, 3.86965837319483*^9}, {3.8696584117148066`*^9, 
  3.8696585792035475`*^9}},ExpressionUUID->"83264349-b5df-4338-97df-\
38ea84c1151b"]
},
WindowSize->{1600, 817},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.3 Inherited,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 20, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"69be60fe-1250-467d-9bc4-c8003ae687de"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[561, 20, 3906, 102, 333, "Input",ExpressionUUID->"7fce9d87-8bea-48d7-b406-fed3cdda1897",
 InitializationCell->True],
Cell[4470, 124, 2837, 70, 258, "Input",ExpressionUUID->"8aabc7ba-f3a6-4233-b01f-e4d08c305e9c",
 InitializationCell->True],
Cell[7310, 196, 8266, 198, 458, "Input",ExpressionUUID->"d39e8a1d-8c65-46e3-a504-f42383d51c74",
 InitializationCell->True],
Cell[15579, 396, 7996, 190, 458, "Input",ExpressionUUID->"f3d7a6a9-5253-43ad-a7a5-18910a5e700c",
 InitializationCell->True],
Cell[23578, 588, 8124, 194, 458, "Input",ExpressionUUID->"57039bef-d7ed-4873-91d6-486d723e8f02",
 InitializationCell->True],
Cell[31705, 784, 8003, 191, 458, "Input",ExpressionUUID->"861d22ac-0f4b-4e81-bfc5-79658aa7ba12",
 InitializationCell->True],
Cell[39711, 977, 5827, 147, 533, "Input",ExpressionUUID->"0ab6b7fb-1394-472c-b1c4-16ad6f744dd5",
 InitializationCell->True],
Cell[45541, 1126, 3222, 80, 283, "Input",ExpressionUUID->"be966cff-ad28-4f1e-a25a-8a4e2c453732",
 InitializationCell->True],
Cell[48766, 1208, 8932, 214, 583, "Input",ExpressionUUID->"27e607d8-22df-4f50-8e1f-fb17b4c7f34f",
 InitializationCell->True],
Cell[57701, 1424, 8654, 205, 558, "Input",ExpressionUUID->"5ff6d2bd-2222-4328-87f0-2d094b4f909a",
 InitializationCell->True],
Cell[66358, 1631, 8786, 209, 558, "Input",ExpressionUUID->"e76f80ca-3b53-429f-869c-3e44ee8b7e88",
 InitializationCell->True],
Cell[75147, 1842, 8665, 206, 558, "Input",ExpressionUUID->"c53853cf-fc32-48bf-894c-eeb8580a494b",
 InitializationCell->True],
Cell[83815, 2050, 7938, 191, 458, "Input",ExpressionUUID->"aef927fb-7f1e-4cbf-a81e-717c1f30fbfa",
 InitializationCell->True],
Cell[91756, 2243, 7651, 183, 433, "Input",ExpressionUUID->"0d772db2-faa8-4640-bd7a-c2eed01187ff",
 InitializationCell->True],
Cell[99410, 2428, 7781, 187, 458, "Input",ExpressionUUID->"a7370945-53f1-4692-8fb0-d0f2517b5123",
 InitializationCell->True],
Cell[107194, 2617, 7546, 181, 433, "Input",ExpressionUUID->"a5d0783c-f3ce-4b41-9fd3-b130e6f883d2",
 InitializationCell->True],
Cell[114743, 2800, 8539, 203, 533, "Input",ExpressionUUID->"c6983cd0-d3a5-447a-9c99-01d6f75e7ee1",
 InitializationCell->True],
Cell[123285, 3005, 8251, 196, 558, "Input",ExpressionUUID->"d2bf08ce-66ca-4e24-bb80-7bdaa5403350",
 InitializationCell->True],
Cell[131539, 3203, 8383, 200, 558, "Input",ExpressionUUID->"c20c69d4-65ad-4e90-921e-87904058c0bd",
 InitializationCell->True],
Cell[139925, 3405, 8256, 196, 558, "Input",ExpressionUUID->"1699e10f-a326-49bd-8a01-0704e1c16ca6",
 InitializationCell->True],
Cell[148184, 3603, 8368, 203, 733, "Input",ExpressionUUID->"a89d7cb5-5190-40d4-a104-25350594c059",
 InitializationCell->True],
Cell[156555, 3808, 8384, 204, 583, "Input",ExpressionUUID->"75820726-92d0-40f1-abc8-869c625fdee0",
 InitializationCell->True],
Cell[164942, 4014, 9185, 221, 608, "Input",ExpressionUUID->"9ecafd3e-6249-4b5c-bc33-664458084771",
 InitializationCell->True],
Cell[174130, 4237, 11454, 277, 633, "Input",ExpressionUUID->"1cd2bc4b-7209-4a3f-b295-1e4e09fe0cf5",
 InitializationCell->True],
Cell[185587, 4516, 12870, 309, 808, "Input",ExpressionUUID->"6891424c-8dc1-4f40-b87d-3378d9dadafb",
 InitializationCell->True],
Cell[198460, 4827, 9049, 216, 558, "Input",ExpressionUUID->"296f885d-ee1d-4c8b-aa05-f4f066748ee4",
 InitializationCell->True],
Cell[207512, 5045, 9182, 221, 508, "Input",ExpressionUUID->"0c102125-85ea-4afa-b528-b41d13132dc8",
 InitializationCell->True],
Cell[216697, 5268, 9852, 236, 608, "Input",ExpressionUUID->"3d63ef53-0b46-4b59-b221-e6d6278f80de",
 InitializationCell->True],
Cell[226552, 5506, 14809, 343, 908, "Input",ExpressionUUID->"783ab603-a697-48b9-bcd2-82c6fd74e767",
 InitializationCell->True],
Cell[241364, 5851, 21924, 509, 1333, "Input",ExpressionUUID->"f9c84fca-b923-45db-a8d2-e0cb12aba546",
 InitializationCell->True],
Cell[263291, 6362, 14797, 343, 908, "Input",ExpressionUUID->"215be85e-4524-4d2b-a322-77528f628530",
 InitializationCell->True],
Cell[278091, 6707, 21912, 509, 1333, "Input",ExpressionUUID->"b368744f-7d7d-4553-9706-ddf077210cf5",
 InitializationCell->True],
Cell[300006, 7218, 19201, 436, 1158, "Input",ExpressionUUID->"6831d880-0520-4d0d-950a-d01d32379c78",
 InitializationCell->True],
Cell[319210, 7656, 26286, 601, 1583, "Input",ExpressionUUID->"7bb361fb-ad51-4bc0-80c5-cc9850126c08",
 InitializationCell->True],
Cell[345499, 8259, 15032, 350, 933, "Input",ExpressionUUID->"09d0b4df-6ac9-430b-a674-b4cb692f665b",
 InitializationCell->True],
Cell[360534, 8611, 22170, 516, 1358, "Input",ExpressionUUID->"bcc742fa-ea86-4d0a-8b40-bfbb95f6aef6",
 InitializationCell->True],
Cell[382707, 9129, 15507, 360, 933, "Input",ExpressionUUID->"1d360be5-3667-4ef1-86e3-4667af4eacaa",
 InitializationCell->True],
Cell[398217, 9491, 22566, 523, 1358, "Input",ExpressionUUID->"33a82e4e-af31-4c3f-9f9e-fbb63f4d94ca",
 InitializationCell->True],
Cell[420786, 10016, 15026, 351, 933, "Input",ExpressionUUID->"b38a9e4f-f561-420e-b147-5b013e94a00a",
 InitializationCell->True],
Cell[435815, 10369, 22123, 515, 1358, "Input",ExpressionUUID->"b3f1e58f-1f74-44c8-8495-d19967e5abf5",
 InitializationCell->True],
Cell[457941, 10886, 15521, 360, 933, "Input",ExpressionUUID->"e980166c-100d-4834-ae62-6d85de107ff8",
 InitializationCell->True],
Cell[473465, 11248, 22580, 523, 1358, "Input",ExpressionUUID->"d0fa67a3-8852-40cc-9528-9f87fa677484",
 InitializationCell->True],
Cell[496048, 11773, 18246, 416, 1133, "Input",ExpressionUUID->"a25e7717-95e6-4cc3-8405-bcc06b19c645",
 InitializationCell->True],
Cell[514297, 12191, 25359, 582, 1558, "Input",ExpressionUUID->"e620a891-bc6f-46e1-a812-c06f442a248e",
 InitializationCell->True],
Cell[539659, 12775, 18370, 418, 1133, "Input",ExpressionUUID->"5578d223-9b00-4224-83b1-d42df3c0437b",
 InitializationCell->True],
Cell[558032, 13195, 25404, 581, 1583, "Input",ExpressionUUID->"977ac369-ae26-45c0-a5cc-35f2bda21bd2",
 InitializationCell->True],
Cell[583439, 13778, 10212, 244, 633, "Input",ExpressionUUID->"91738216-0dea-4c9f-a42a-6c330aeb3568",
 InitializationCell->True],
Cell[593654, 14024, 10905, 259, 708, "Input",ExpressionUUID->"d8bb9db2-d9fd-4092-aa9e-d9fcfc970258",
 InitializationCell->True],
Cell[604562, 14285, 18958, 431, 1183, "Input",ExpressionUUID->"919dd566-8045-4e67-9da9-442c80202b0e",
 InitializationCell->True],
Cell[623523, 14718, 26071, 597, 1608, "Input",ExpressionUUID->"54bfca44-1e8b-4689-8feb-d1c42f57e6f0",
 InitializationCell->True],
Cell[649597, 15317, 9998, 240, 583, "Input",ExpressionUUID->"2f1b86f1-daef-4f94-a72f-32dc060f9c15",
 InitializationCell->True],
Cell[659598, 15559, 11182, 266, 758, "Input",ExpressionUUID->"bffbb52e-a2c8-4ce1-9fc4-b5ba193a39f2",
 InitializationCell->True],
Cell[670783, 15827, 21586, 494, 1308, "Input",ExpressionUUID->"4c1ec37c-d1ab-4569-a808-c826942bf515",
 InitializationCell->True],
Cell[692372, 16323, 29797, 686, 1883, "Input",ExpressionUUID->"ed23709c-3839-485a-aace-bade43a7b6c7",
 InitializationCell->True],
Cell[722172, 17011, 10008, 240, 583, "Input",ExpressionUUID->"f5c06695-13b4-452b-983d-2ed3d45a529b",
 InitializationCell->True],
Cell[732183, 17253, 11173, 267, 758, "Input",ExpressionUUID->"f306e402-d45a-4737-9dd5-5f5e241d8c67",
 InitializationCell->True],
Cell[743359, 17522, 21603, 495, 1308, "Input",ExpressionUUID->"d57270ca-8f4b-48b0-9808-b199dc21a082",
 InitializationCell->True],
Cell[764965, 18019, 29811, 686, 1883, "Input",ExpressionUUID->"1d0fe121-540c-4f05-b50e-3f9cf253a180",
 InitializationCell->True],
Cell[794779, 18707, 11464, 274, 658, "Input",ExpressionUUID->"59d94e00-7ff5-44bb-99ef-f8566891b70e",
 InitializationCell->True],
Cell[806246, 18983, 13130, 310, 883, "Input",ExpressionUUID->"66e14e96-d97a-49b2-884d-92ea8a4d6d56",
 InitializationCell->True],
Cell[819379, 19295, 24328, 557, 1458, "Input",ExpressionUUID->"192ffcad-800c-479f-a4c4-ccb26d62f866",
 InitializationCell->True],
Cell[843710, 19854, 33398, 768, 2108, "Input",ExpressionUUID->"998561fd-a479-4f76-91ec-967d9b1f7b9d",
 InitializationCell->True],
Cell[877111, 20624, 13243, 314, 883, "Input",ExpressionUUID->"d2365d11-77c1-4f80-b5e1-8e63e007a021",
 InitializationCell->True],
Cell[890357, 20940, 15534, 358, 908, "Input",ExpressionUUID->"c06bb836-baf1-421d-9a32-d3820dc36cd8",
 InitializationCell->True],
Cell[905894, 21300, 22656, 526, 1333, "Input",ExpressionUUID->"2f51730a-b19f-4097-9f28-5895ce9c4003",
 InitializationCell->True],
Cell[928553, 21828, 38005, 882, 2208, "Input",ExpressionUUID->"24ba81d7-5bd8-4f99-90e1-aedbadca0fad",
 InitializationCell->True],
Cell[966561, 22712, 20683, 468, 1158, "Input",ExpressionUUID->"64950165-21de-4dad-9464-cfeb6217ef2a",
 InitializationCell->True],
Cell[987247, 23182, 27788, 633, 1583, "Input",ExpressionUUID->"31930fe5-93ff-4f72-8cf1-52fe64a2c710",
 InitializationCell->True],
Cell[1015038, 23817, 8955, 213, 583, "Input",ExpressionUUID->"b0edc585-33b2-4fc1-8696-bd7639e1b447",
 InitializationCell->True],
Cell[1023996, 24032, 10312, 245, 658, "Input",ExpressionUUID->"6951b17b-3f57-464a-bcd9-bf6e2f3258fc",
 InitializationCell->True],
Cell[1034311, 24279, 36176, 818, 2258, "Input",ExpressionUUID->"7a1e342b-b2f3-4587-8abf-35e9bcf3a84a",
 InitializationCell->True],
Cell[1070490, 25099, 26494, 611, 1633, "Input",ExpressionUUID->"af1165dd-a131-458d-854e-d5c6abaa436b",
 InitializationCell->True],
Cell[1096987, 25712, 11244, 267, 583, "Input",ExpressionUUID->"d3e7943a-0729-48f2-b559-05347bbfd179",
 InitializationCell->True],
Cell[1108234, 25981, 13005, 306, 808, "Input",ExpressionUUID->"8e542dea-1b67-4227-a250-4ccd3e9a463e",
 InitializationCell->True],
Cell[1121242, 26289, 9446, 224, 533, "Input",ExpressionUUID->"ebc55b8a-d86d-4e9d-8e42-7bc917b103bc",
 InitializationCell->True],
Cell[1130691, 26515, 9230, 218, 508, "Input",ExpressionUUID->"e9db3d31-f384-4d57-8877-401cd8af0fc5",
 InitializationCell->True],
Cell[1139924, 26735, 10321, 244, 658, "Input",ExpressionUUID->"929554fc-e034-4c47-875e-fe85767df8b3",
 InitializationCell->True],
Cell[1150248, 26981, 10104, 239, 633, "Input",ExpressionUUID->"c22b2659-38cb-4207-b514-d761f145bd43",
 InitializationCell->True],
Cell[1160355, 27222, 9014, 215, 508, "Input",ExpressionUUID->"11f9d24a-7979-4039-bd09-f7720b72824c",
 InitializationCell->True],
Cell[1169372, 27439, 8662, 206, 483, "Input",ExpressionUUID->"d1ce130b-8a43-47fe-bb10-5692bddc9c25",
 InitializationCell->True],
Cell[1178037, 27647, 9947, 235, 633, "Input",ExpressionUUID->"8dab4de3-c008-4ca5-863f-dadadb4a1a54",
 InitializationCell->True],
Cell[1187987, 27884, 11814, 281, 808, "Input",ExpressionUUID->"bee19db7-009e-46c3-84f5-28a8718a4350",
 InitializationCell->True],
Cell[1199804, 28167, 5118, 92, 508, "Input",ExpressionUUID->"5f95ea34-4289-4f1b-bd41-81b28c90f8f4",
 InitializationCell->True],
Cell[1204925, 28261, 19441, 455, 1283, "Input",ExpressionUUID->"976308e5-bca0-439c-ad76-ed75aa566830",
 InitializationCell->True],
Cell[1224369, 28718, 110116, 2633, 9109, "Input",ExpressionUUID->"83264349-b5df-4338-97df-38ea84c1151b",
 InitializationCell->True]
}
]
*)

