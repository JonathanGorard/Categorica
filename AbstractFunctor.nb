(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[   1357981,      31746]
NotebookOptionsPosition[   1348991,      31596]
NotebookOutlinePosition[   1349417,      31613]
CellTagsIndexPosition[   1349374,      31610]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"reduceObjects", "[", 
   RowBox[{"objects_List", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "objects"}], "\n", 
 RowBox[{
  RowBox[{"reduceObjects", "[", 
   RowBox[{"objects_List", ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"reduceObjects", "[", 
    RowBox[{
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"objects", "/.", 
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}], "\[Rule]", 
        
        RowBox[{"Last", "[", 
         RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}]}]}], "]"}], 
     ",", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"objectEquivalences", "/.", 
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}], 
          "\[Rule]", 
          RowBox[{"Last", "[", 
           RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}]}]}], 
        "]"}], ",", "1"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "objectEquivalences", "]"}], ">", 
    "0"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, 
   3.869738631533656*^9},
 CellLabel->
  "In[161]:=",ExpressionUUID->"48849ee8-0b41-47ae-9c53-507f88eb016b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"reduceArrowsInitial", "[", 
   RowBox[{"arrows_Association", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "arrows"}], "\n", 
 RowBox[{
  RowBox[{"reduceArrowsInitial", "[", 
   RowBox[{"arrows_Association", ",", "arrowEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"reduceArrowsInitial", "[", 
    RowBox[{
     RowBox[{"Association", "[", 
      RowBox[{"DeleteDuplicatesBy", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"First", "[", "arrowEquivalences", "]"}], "]"}], "\[Rule]", 
          RowBox[{"Last", "[", 
           RowBox[{"First", "[", "arrowEquivalences", "]"}], "]"}]}]}], ",", 
        "First"}], "]"}], "]"}], ",", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"arrowEquivalences", "/.", 
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"First", "[", "arrowEquivalences", "]"}], "]"}], "\[Rule]", 
          RowBox[{"Last", "[", 
           RowBox[{"First", "[", "arrowEquivalences", "]"}], "]"}]}]}], "]"}],
        ",", "1"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "arrowEquivalences", "]"}], ">", "0"}]}]}], "\n", 
 RowBox[{
  RowBox[{"reduceArrowsFinal", "[", 
   RowBox[{"arrows_Association", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "arrows"}], "\n", 
 RowBox[{
  RowBox[{"reduceArrowsFinal", "[", 
   RowBox[{"arrows_Association", ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"reduceArrowsFinal", "[", 
    RowBox[{
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}], "\[Rule]", 
        
        RowBox[{"Last", "[", 
         RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}]}]}], "]"}], 
     ",", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"objectEquivalences", "/.", 
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}], 
          "\[Rule]", 
          RowBox[{"Last", "[", 
           RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}]}]}], 
        "]"}], ",", "1"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "objectEquivalences", "]"}], ">", 
    "0"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738638737885*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"3aad200f-6169-4972-b03a-8d60b790477e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"reduceObjectsWithDuplicates", "[", 
   RowBox[{"objects_List", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "objects"}], "\n", 
 RowBox[{
  RowBox[{"reduceObjectsWithDuplicates", "[", 
   RowBox[{"objects_List", ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"reduceObjectsWithDuplicates", "[", 
    RowBox[{
     RowBox[{"objects", "/.", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}], "\[Rule]", 
       RowBox[{"Last", "[", 
        RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}]}]}], ",", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"objectEquivalences", "/.", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}], "\[Rule]", 
         RowBox[{"Last", "[", 
          RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}]}]}], ",", 
       "1"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "objectEquivalences", "]"}], ">", 
    "0"}]}]}], "\n", 
 RowBox[{
  RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
   RowBox[{"arrows_List", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "arrows"}], "\n", 
 RowBox[{
  RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
   RowBox[{"arrows_List", ",", "arrowEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
    RowBox[{
     RowBox[{"arrows", "/.", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"First", "[", "arrowEquivalences", "]"}], "]"}], "\[Rule]", 
       RowBox[{"Last", "[", 
        RowBox[{"First", "[", "arrowEquivalences", "]"}], "]"}]}]}], ",", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"First", "[", "arrowEquivalences", "]"}], "]"}], "\[Rule]", 
         
         RowBox[{"Last", "[", 
          RowBox[{"First", "[", "arrowEquivalences", "]"}], "]"}]}]}], ",", 
       "1"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "arrowEquivalences", "]"}], ">", "0"}]}]}], "\n", 
 RowBox[{
  RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
   RowBox[{"arrows_List", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", "arrows"}], "\n", 
 RowBox[{
  RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
   RowBox[{"arrows_List", ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
    RowBox[{
     RowBox[{"arrows", "/.", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}], "\[Rule]", 
       RowBox[{"Last", "[", 
        RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}]}]}], ",", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"objectEquivalences", "/.", 
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}], "\[Rule]", 
         RowBox[{"Last", "[", 
          RowBox[{"First", "[", "objectEquivalences", "]"}], "]"}]}]}], ",", 
       "1"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "objectEquivalences", "]"}], ">", 
    "0"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738661935497*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"4c14218e-32bb-4cd5-bf3b-cb458b5770a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ObjectCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Length", "[", "objects", "]"}], "\[Rule]", 
     RowBox[{"Length", "[", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"objects", "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
         "newObjects"}], "]"}], "]"}], "]"}]}], ")"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.8697386717596025`*^9}, {3.8714366781441097`*^9, 
  3.871436678962237*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"aa2aee7e-09dc-4bd1-b39b-3491611c4689"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<MorphismCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageMorphismAssociation", ",", "imageCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                   ")"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], "]"}], 
       "\[Rule]", 
       RowBox[{"Length", "[", 
        RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], "]"}]}]}]}],
     "]"}], "/;", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.8697386983188696`*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"ba56e082-0488-443f-860f-c0a6dec85f39"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ObjectEquivalences\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Union", "[", 
    RowBox[{
     RowBox[{"quiverObjectEquivalences", "/.", 
      RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"categoryObjectEquivalences", "/.", 
         RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
        "objectEquivalences"}], "]"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.8697387059090786`*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"67ceed6b-cb96-4349-9f67-d0b4a1e66cb0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ObjectEquivalenceCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Union", "[", 
     RowBox[{
      RowBox[{"quiverObjectEquivalences", "/.", 
       RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"categoryObjectEquivalences", "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
         "objectEquivalences"}], "]"}], "]"}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738717394701*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"b4d0f398-1513-4e0e-9408-af1e60f2606e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<MorphismEquivalences\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Union", "[", 
    RowBox[{
     RowBox[{"arrowEquivalences", "/.", 
      RowBox[{"Normal", "[", "arrowMappings", "]"}]}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"covariant", "===", "True"}], ",", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"categoryMorphismEquivalences", "/.", 
             RowBox[{
             "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
            RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "morphismEquivalences"}], "]"}], "]"}], ",", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"categoryMorphismEquivalences", "/.", 
              RowBox[{
              "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"newCompositionSymbol", "[", 
               RowBox[{"x_", ",", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], "\[RuleDelayed]", 
              
              RowBox[{"newCompositionSymbol", "[", 
               RowBox[{"z", ",", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"newCompositionSymbol", "[", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
              "\[RuleDelayed]", 
              RowBox[{"newCompositionSymbol", "[", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"newCompositionSymbol", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
              RowBox[{"newCompositionSymbol", "[", 
               RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
          "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738717394701*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"b98724c2-2ad4-41c4-ae46-4759ea93a126"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalneces_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<MorphismEquivalenceCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Union", "[", 
     RowBox[{
      RowBox[{"arrowEquivalences", "/.", 
       RowBox[{"Normal", "[", "arrowMappings", "]"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"covariant", "===", "True"}], ",", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"categoryMorphismEquivalences", "/.", 
              RowBox[{
              "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           "morphismEquivalences"}], "]"}], "]"}], ",", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"categoryMorphismEquivalences", "/.", 
               RowBox[{
               "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"newCompositionSymbol", "[", 
                RowBox[{"x_", ",", 
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], "\[RuleDelayed]", 
               RowBox[{"newCompositionSymbol", "[", 
                RowBox[{"z", ",", 
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"newCompositionSymbol", "[", 
                RowBox[{
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
               "\[RuleDelayed]", 
               RowBox[{"newCompositionSymbol", "[", 
                RowBox[{
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"newCompositionSymbol", "[", 
                RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
               RowBox[{"newCompositionSymbol", "[", 
                RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
           "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738762122237*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"1106ba00-ae0e-425d-8fb8-8aa239949cb9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ReducedObjectCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"reduceObjects", "[", 
       RowBox[{
        RowBox[{"reduceObjects", "[", 
         RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
        "categoryObjectEquivalences"}], "]"}], "]"}], "\[Rule]", 
     RowBox[{"Length", "[", 
      RowBox[{"reduceObjects", "[", 
       RowBox[{
        RowBox[{"reduceObjects", "[", 
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"objects", "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
             "newObjects"}], "]"}], "]"}], ",", 
          RowBox[{"quiverObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"categoryObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           "objectEquivalences"}], "]"}], "]"}]}], "]"}], "]"}]}], ")"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738762122237*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"ca1a9e12-9ab1-478d-8b3b-bfb0569cab66"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ReducedMorphismCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageObjects", ",", "imageArrows", ",", 
       "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", ",", 
       "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageMorphismAssociation", ",", "imageCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], "]"}]}],
       ";", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"categoryMorphismEquivalences", "/.", 
               RowBox[{
               "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"categoryMorphismEquivalences", "/.", 
                RowBox[{
                "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"reduceArrowsFinal", "[", 
                   RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], 
                    "]"}], ",", "imageQuiverObjectEquivalences"}], "]"}], 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", 
                   RowBox[{"reduceArrowsFinal", "[", 
                    RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], 
                    "]"}], ",", "imageQuiverObjectEquivalences"}], "]"}], 
                   "]"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Normal", "[", 
         RowBox[{"reduceArrowsFinal", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitial", "[", 
            RowBox[{
            "domainMorphismAssociation", ",", 
             "categoryMorphismEquivalences"}], "]"}], ",", 
           "categoryObjectEquivalences"}], "]"}], "]"}], "]"}], "\[Rule]", 
       RowBox[{"Length", "[", 
        RowBox[{"Normal", "[", 
         RowBox[{"reduceArrowsFinal", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitial", "[", 
            RowBox[{
            "imageMorphismAssociation", ",", "imageMorphismEquivalences"}], 
            "]"}], ",", "imageObjectEquivalences"}], "]"}], "]"}], 
        "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.8697387591684303`*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"0a41cdc6-5ff7-42cd-aaa4-2e1766dc3ff5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<CompositionSymbol\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"compositionSymbol", "\[Rule]", "newCompositionSymbol"}], ")"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.8697387524050417`*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"508f2666-7341-4440-97cc-29b1803456bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<IdentitySymbol\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"identitySymbol", "\[Rule]", "newIdentitySymbol"}], ")"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738748059249*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"6606b242-8e13-4330-9d38-621f05dec918"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<NewObjects\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"objects", "/.", 
         RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
        "newObjects"}], "]"}], "]"}], ",", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"objects", "/.", 
       RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738748059249*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"a9fd887c-e1ae-44ec-a5a1-36245ebda9a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<NewObjectCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Complement", "[", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"objects", "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
         "newObjects"}], "]"}], "]"}], ",", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"objects", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}]}], "]"}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.8697387333713517`*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"ebba9de9-c714-4438-9607-8d9fa404c3de"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ReducedNewObjects\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"reduceObjects", "[", 
      RowBox[{
       RowBox[{"reduceObjects", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], ",", 
         RowBox[{"quiverObjectEquivalences", "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"reduceObjects", "[", 
      RowBox[{
       RowBox[{"reduceObjects", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}], ",", 
         RowBox[{"quiverObjectEquivalences", "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.8697387306070585`*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"74c22533-1d98-4ea3-b330-60ef081cdee1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ReducedNewObjectCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Complement", "[", 
     RowBox[{
      RowBox[{"reduceObjects", "[", 
       RowBox[{
        RowBox[{"reduceObjects", "[", 
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"objects", "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
             "newObjects"}], "]"}], "]"}], ",", 
          RowBox[{"quiverObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"categoryObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           "objectEquivalences"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"reduceObjects", "[", 
       RowBox[{
        RowBox[{"reduceObjects", "[", 
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"objects", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}], ",", 
          RowBox[{"quiverObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"categoryObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           "objectEquivalences"}], "]"}], "]"}]}], "]"}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<NewArrows\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
        RowBox[{"DirectedEdge", "@@", 
         RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"Association", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"covariant", "===", "True"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                  RowBox[{"Reverse", "[", 
                   RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                  RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ")"}]}]}], 
             "]"}], ",", 
            RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], "]"}], 
        "]"}], ",", 
       RowBox[{"Normal", "[", 
        RowBox[{"Association", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"covariant", "===", "True"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ")"}]}]}], 
           "]"}], "]"}], "]"}], "]"}]}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
   3.869738631533656*^9, 3.869738725269229*^9}, 3.869738771543952*^9},
 CellLabel->
  "In[186]:=",ExpressionUUID->"250dc498-d42e-4b46-8480-aa783bd2910f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<NewArrowCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Normal", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
          RowBox[{"DirectedEdge", "@@", 
           RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"Association", "[", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"covariant", "===", "True"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                  RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                   RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                  ")"}]}]}], "]"}], ",", 
              RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
           "]"}], "]"}], ",", 
         RowBox[{"Normal", "[", 
          RowBox[{"Association", "[", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"covariant", "===", "True"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                  RowBox[{"Reverse", "[", 
                   RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                  RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ")"}]}]}], 
             "]"}], "]"}], "]"}], "]"}]}], "]"}]}], "]"}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.8697387748834057`*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"1d99ebbb-cd7e-41db-a1c0-c7f222054b45"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<NewMorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "oldMorphismAssociation", ",", "oldCompositions", ",", 
       "morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"oldMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"covariant", "===", "True"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                 RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                   RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ")"}]}]}],
               "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"oldCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"oldMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "oldCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"oldMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"oldMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"objects", "/.", 
         RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                   ")"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
             RowBox[{"DirectedEdge", "@@", 
              RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
          RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
             RowBox[{"DirectedEdge", "@@", 
              RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
          RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}]}]}], "]"}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738781780657*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"e1c3bb7f-3072-40b4-91e3-e6ca070d1227"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<NewMorphismCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "oldMorphismAssociation", ",", "oldCompositions", ",", 
       "morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"oldMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"covariant", "===", "True"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                 RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                   RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ")"}]}]}],
               "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"oldCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"oldMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "oldCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"oldMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"oldMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"objects", "/.", 
         RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                   ")"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Length", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"Association", "[", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "@@", 
                RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
            RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "@@", 
                RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
            RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}]}]}], "]"}],
          "]"}], "]"}], "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.8697387868885956`*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"342a91aa-5d2e-4b9e-9327-151aee4ccfb5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ReducedNewMorphisms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "oldObjects", ",", "oldArrows", ",", "oldQuiverObjectEquivalences", ",",
        "oldObjectEquivalences", ",", "oldArrowEquivalences", ",", 
       "oldMorphismEquivalences", ",", "oldMorphismAssociation", ",", 
       "oldCompositions", ",", "imageObjects", ",", "imageArrows", ",", 
       "morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"oldObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"objects", "/.", 
         RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"oldArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
           RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"oldQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"oldObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"oldArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"oldMorphismEquivalences", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"categoryMorphismEquivalences", "/.", 
               RowBox[{
               "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"categoryMorphismEquivalences", "/.", 
                RowBox[{
                "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"oldMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"covariant", "===", "True"}], ",", 
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{"oldArrows", ",", "oldArrowEquivalences"}], "]"}], 
                  ",", "oldQuiverObjectEquivalences"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                   RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                RowBox[{"Normal", "[", 
                 RowBox[{"reduceArrowsFinal", "[", 
                  RowBox[{
                   RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"oldArrows", ",", "oldArrowEquivalences"}], "]"}],
                    ",", "oldQuiverObjectEquivalences"}], "]"}], "]"}]}]}], 
              "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"oldCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"oldMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "oldCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"oldObjects", ",", "oldQuiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"oldMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"oldMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"oldObjects", ",", "oldQuiverObjectEquivalences"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], "]"}]}],
       ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"reduceArrowsFinal", "[", 
                   RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"imageArrows", ",", "oldArrowEquivalences"}], 
                    "]"}], ",", "oldQuiverObjectEquivalences"}], "]"}], "]"}],
                  ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", 
                   RowBox[{"reduceArrowsFinal", "[", 
                    RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"imageArrows", ",", "oldArrowEquivalences"}], 
                    "]"}], ",", "oldQuiverObjectEquivalences"}], "]"}], 
                   "]"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "oldQuiverObjectEquivalences"}], "]"}],
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "oldQuiverObjectEquivalences"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
             RowBox[{"DirectedEdge", "@@", 
              RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"morphismAssociation", ",", "oldMorphismEquivalences"}],
               "]"}], ",", "oldObjectEquivalences"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
             RowBox[{"DirectedEdge", "@@", 
              RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{
              "oldMorphismAssociation", ",", "oldMorphismEquivalences"}], 
              "]"}], ",", "oldObjectEquivalences"}], "]"}], "]"}]}]}], "]"}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.8697387974665313`*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"7164a3b8-cd60-4789-9659-d194e52f9cf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ReducedNewMorphismCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "oldObjects", ",", "oldArrows", ",", "oldQuiverObjectEquivalences", ",",
        "oldObjectEquivalences", ",", "oldArrowEquivalences", ",", 
       "oldMorphismEquivalences", ",", "oldMorphismAssociation", ",", 
       "oldCompositions", ",", "imageObjects", ",", "imageArrows", ",", 
       "morphismAssociation", ",", "compositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"oldObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"objects", "/.", 
         RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"oldArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
           RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"oldQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"oldObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"oldArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"oldMorphismEquivalences", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"categoryMorphismEquivalences", "/.", 
               RowBox[{
               "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"categoryMorphismEquivalences", "/.", 
                RowBox[{
                "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"oldMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"covariant", "===", "True"}], ",", 
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{"oldArrows", ",", "oldArrowEquivalences"}], "]"}], 
                  ",", "oldQuiverObjectEquivalences"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                   RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                RowBox[{"Normal", "[", 
                 RowBox[{"reduceArrowsFinal", "[", 
                  RowBox[{
                   RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"oldArrows", ",", "oldArrowEquivalences"}], "]"}],
                    ",", "oldQuiverObjectEquivalences"}], "]"}], "]"}]}]}], 
              "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"oldCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"oldMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "oldCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"oldObjects", ",", "oldQuiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"oldMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"oldMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"oldObjects", ",", "oldQuiverObjectEquivalences"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], "]"}]}],
       ";", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"reduceArrowsFinal", "[", 
                   RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"imageArrows", ",", "oldArrowEquivalences"}], 
                    "]"}], ",", "oldQuiverObjectEquivalences"}], "]"}], "]"}],
                  ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", 
                   RowBox[{"reduceArrowsFinal", "[", 
                    RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"imageArrows", ",", "oldArrowEquivalences"}], 
                    "]"}], ",", "oldQuiverObjectEquivalences"}], "]"}], 
                   "]"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "oldQuiverObjectEquivalences"}], "]"}],
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "oldQuiverObjectEquivalences"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Length", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"Association", "[", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "@@", 
                RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
            RowBox[{"Normal", "[", 
             RowBox[{"reduceArrowsFinal", "[", 
              RowBox[{
               RowBox[{"reduceArrowsInitial", "[", 
                RowBox[{
                "morphismAssociation", ",", "oldMorphismEquivalences"}], 
                "]"}], ",", "oldObjectEquivalences"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "@@", 
                RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
            RowBox[{"Normal", "[", 
             RowBox[{"reduceArrowsFinal", "[", 
              RowBox[{
               RowBox[{"reduceArrowsInitial", "[", 
                RowBox[{
                "oldMorphismAssociation", ",", "oldMorphismEquivalences"}], 
                "]"}], ",", "oldObjectEquivalences"}], "]"}], "]"}]}]}], 
          "]"}], "]"}], "]"}], "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.8697388040324106`*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"8503a1c0-b078-4530-973d-bec8bfc342ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ObjectMappings\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", "objects"}], 
      "]"}], ",", "objectMappings"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.8697388106014967`*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"40988e54-678d-4d31-a943-021be91d7f23"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphsmEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ObjectMappingCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Normal", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", "objects"}], 
        "]"}], ",", "objectMappings"}], "]"}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738814033862*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"ecd7033a-1198-4953-9912-8fdac3bbfee8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ReducedObjectMappings\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Association", "[", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Keys", "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
           RowBox[{"reduceObjects", "[", 
            RowBox[{
             RowBox[{"reduceObjects", "[", 
              RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
             ",", "categoryObjectEquivalences"}], "]"}]}], "]"}], "]"}], 
        "\[Rule]", 
        RowBox[{"reduceObjectsWithDuplicates", "[", 
         RowBox[{
          RowBox[{"Values", "[", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"reduceObjects", "[", 
                RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
               ",", "categoryObjectEquivalences"}], "]"}]}], "]"}], "]"}], 
          ",", "objectEquivalences"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Association", "[", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"reduceObjectsWithDuplicates", "[", 
         RowBox[{
          RowBox[{"reduceObjectsWithDuplicates", "[", 
           RowBox[{
            RowBox[{"Keys", "[", "objectMappings", "]"}], ",", 
            "quiverObjectEquivalences"}], "]"}], ",", 
          "categoryObjectEquivalences"}], "]"}], "\[Rule]", 
        RowBox[{"reduceObjectsWithDuplicates", "[", 
         RowBox[{
          RowBox[{"Values", "[", "objectMappings", "]"}], ",", 
          "objectEquivalences"}], "]"}]}], "]"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.8697388181279545`*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"9ec8e5d1-8c39-4893-85d4-e7fcdaf4d6e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ReducedObjectMappingCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Normal", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Association", "[", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Keys", "[", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"reduceObjects", "[", 
                RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
               ",", "categoryObjectEquivalences"}], "]"}]}], "]"}], "]"}], 
          "\[Rule]", 
          RowBox[{"reduceObjectsWithDuplicates", "[", 
           RowBox[{
            RowBox[{"Values", "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
               RowBox[{"reduceObjects", "[", 
                RowBox[{
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}],
                  ",", "categoryObjectEquivalences"}], "]"}]}], "]"}], "]"}], 
            ",", "objectEquivalences"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"Association", "[", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"reduceObjectsWithDuplicates", "[", 
           RowBox[{
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Keys", "[", "objectMappings", "]"}], ",", 
              "quiverObjectEquivalences"}], "]"}], ",", 
            "categoryObjectEquivalences"}], "]"}], "\[Rule]", 
          RowBox[{"reduceObjectsWithDuplicates", "[", 
           RowBox[{
            RowBox[{"Values", "[", "objectMappings", "]"}], ",", 
            "objectEquivalences"}], "]"}]}], "]"}], "]"}]}], "]"}], "]"}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738821586835*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"72506e5c-2f61-476b-a39e-f69b8776d355"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ArrowMappings\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
       RowBox[{"Keys", "[", "arrows", "]"}]}], "]"}], ",", "arrowMappings"}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.8697388248975554`*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"61e9b785-3da4-43d7-9bd0-b3e032077146"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ArrowMappingCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Normal", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
         RowBox[{"Keys", "[", "arrows", "]"}]}], "]"}], ",", 
       "arrowMappings"}], "]"}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"8871aab8-51d4-4261-8f12-40fdaf46c322"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<MorphismMappings\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "objectListWithDuplicates", ",", "arrowListWithDuplicates", ",", 
       "domainMorphismList", ",", "domainCompositions", ",", 
       "imageMorphismList", ",", "imageCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"objectListWithDuplicates", "=", 
       RowBox[{"objects", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      RowBox[{"arrowListWithDuplicates", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
           RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ")"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "arrows", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"domainMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "domainMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"domainMorphismList", ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"domainMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", "objects"}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"arrowListWithDuplicates", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"imageMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "imageMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"imageMorphismList", ",", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objectListWithDuplicates", "]"}]}], "]"}], 
      ";", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"imageMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", "objectListWithDuplicates"}], ";", 
      RowBox[{"Association", "[", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"First", "/@", "domainMorphismList"}], "\[Rule]", 
         RowBox[{"First", "/@", "imageMorphismList"}]}], "]"}], "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
   3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
   3.869738830972613*^9}, 3.869738896509601*^9},
 CellLabel->
  "In[199]:=",ExpressionUUID->"490d1565-fe56-4e08-8b72-ab4dff58bf9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<MorphismMappingCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "objectListWithDuplicates", ",", "arrowListWithDuplicates", ",", 
       "domainMorphismList", ",", "domainCompositions", ",", 
       "imageMorphismList", ",", "imageCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"objectListWithDuplicates", "=", 
       RowBox[{"objects", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      RowBox[{"arrowListWithDuplicates", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
           RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ")"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "arrows", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"domainMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "domainMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"domainMorphismList", ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"domainMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", "objects"}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"arrowListWithDuplicates", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"imageMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "imageMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"imageMorphismList", ",", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objectListWithDuplicates", "]"}]}], "]"}], 
      ";", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"imageMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", "objectListWithDuplicates"}], ";", 
      RowBox[{"Length", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"Association", "[", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"First", "/@", "domainMorphismList"}], "\[Rule]", 
           RowBox[{"First", "/@", "imageMorphismList"}]}], "]"}], "]"}], 
        "]"}], "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"c82f97ed-76e7-43e3-87f4-7d5c03a6de37"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ReducedMorphismMappings\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "objectListWithDuplicates", ",", "arrowListWithDuplicates", ",", 
       "domainMorphismList", ",", "domainCompositions", ",", 
       "imageMorphismList", ",", "imageCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"objectListWithDuplicates", "=", 
       RowBox[{"objects", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      RowBox[{"arrowListWithDuplicates", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
           RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ")"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], ",", 
             "arrowEquivalences"}], "]"}], ",", "quiverObjectEquivalences"}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"domainMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "domainMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"domainMorphismList", ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjectsWithDuplicates", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"domainMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", 
       RowBox[{"reduceObjectsWithDuplicates", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
          RowBox[{"domainMorphismList", ",", "categoryMorphismEquivalences"}],
           "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
            RowBox[{"arrowListWithDuplicates", ",", 
             RowBox[{"arrowEquivalences", "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], "]"}], ",", 
           RowBox[{"quiverObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"imageMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "imageMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"imageMorphismList", ",", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjectsWithDuplicates", "[", 
          RowBox[{"objectListWithDuplicates", ",", 
           RowBox[{"quiverObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"imageMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", 
       RowBox[{"reduceObjectsWithDuplicates", "[", 
        RowBox[{"objectListWithDuplicates", ",", 
         RowBox[{"quiverObjectEquivalences", "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
          RowBox[{"imageMorphismList", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"covariant", "===", "True"}], ",", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"categoryMorphismEquivalences", "/.", 
                   RowBox[{
                   "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}],
                   "/.", 
                  RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "morphismEquivalences"}], "]"}], "]"}], ",", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"categoryMorphismEquivalences", "/.", 
                    RowBox[{
                    "compositionSymbol", "\[Rule]", 
                    "newCompositionSymbol"}]}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"z", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
                   
                   RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
                "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"categoryObjectEquivalences", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "objectEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"First", "/@", "domainMorphismList"}], "\[Rule]", 
         RowBox[{"First", "/@", "imageMorphismList"}]}], "]"}], "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
   3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
   3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, 
   3.869738945573786*^9},
 CellLabel->
  "In[201]:=",ExpressionUUID->"4755fb35-2716-452b-a507-813ddd437c79"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ReducedMorphismMappingCount\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "objectListWithDuplicates", ",", "arrowListWithDuplicates", ",", 
       "domainMorphismList", ",", "domainCompositions", ",", 
       "imageMorphismList", ",", "imageCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"objectListWithDuplicates", "=", 
       RowBox[{"objects", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      RowBox[{"arrowListWithDuplicates", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
           RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ")"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], ",", 
             "arrowEquivalences"}], "]"}], ",", "quiverObjectEquivalences"}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"domainMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "domainMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"domainMorphismList", ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjectsWithDuplicates", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"domainMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", 
       RowBox[{"reduceObjectsWithDuplicates", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
          RowBox[{"domainMorphismList", ",", "categoryMorphismEquivalences"}],
           "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
            RowBox[{"arrowListWithDuplicates", ",", 
             RowBox[{"arrowEquivalences", "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], "]"}], ",", 
           RowBox[{"quiverObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"imageMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "imageMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"imageMorphismList", ",", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjectsWithDuplicates", "[", 
          RowBox[{"objectListWithDuplicates", ",", 
           RowBox[{"quiverObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"imageMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", 
       RowBox[{"reduceObjectsWithDuplicates", "[", 
        RowBox[{"objectListWithDuplicates", ",", 
         RowBox[{"quiverObjectEquivalences", "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
          RowBox[{"imageMorphismList", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"covariant", "===", "True"}], ",", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"categoryMorphismEquivalences", "/.", 
                   RowBox[{
                   "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}],
                   "/.", 
                  RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "morphismEquivalences"}], "]"}], "]"}], ",", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"categoryMorphismEquivalences", "/.", 
                    RowBox[{
                    "compositionSymbol", "\[Rule]", 
                    "newCompositionSymbol"}]}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"z", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
                   
                   RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
                "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"categoryObjectEquivalences", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "objectEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Length", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"Association", "[", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"First", "/@", "domainMorphismList"}], "\[Rule]", 
           RowBox[{"First", "/@", "imageMorphismList"}]}], "]"}], "]"}], 
        "]"}], "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.869738963847807*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"6df51058-9413-46b8-a775-1082576129ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<DomainCategory\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "categoryMorphismEquivalences"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "categoryObjectEquivalences"}],
       ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], ",", 
          
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
   3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
   3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
   3.869738945573786*^9, 3.8697389705819683`*^9}, 3.8697394734201574`*^9},
 CellLabel->
  "In[203]:=",ExpressionUUID->"4c280c4c-2d83-4ed4-a4ab-771dd61077a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<CodomainCategory\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<CompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"categoryMorphismEquivalences", "/.", 
               RowBox[{
               "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"categoryMorphismEquivalences", "/.", 
                RowBox[{
                "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"arrowEquivalences", "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], ")"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                   ")"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}]}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"quiverObjectEquivalences", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ")"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}]}]}], "]"}], "]"}]}]}], "]"}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
   3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
   3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
   3.869738945573786*^9, 3.8697389768803463`*^9}, 3.869739473435814*^9},
 CellLabel->
  "In[204]:=",ExpressionUUID->"10e28597-a216-4fbd-b782-c6ba4ca6e316"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<EndofunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageObjects", ",", "imageArrows", ",", 
       "imageQuiverObjectEquivalences", ",", "imageArrowEquivalences", ",", 
       "imageObjectEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageMorphismAssociation", ",", "imageCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"covariant", "===", "True"}], ",", 
             RowBox[{"Normal", "[", "newArrows", "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
              RowBox[{"Normal", "[", "newArrows", "]"}]}]}], "]"}]}], "]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"categoryMorphismEquivalences", "/.", 
             RowBox[{
             "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
            RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"covariant", "===", "True"}], ",", "morphismEquivalences",
             ",", 
            RowBox[{"morphismEquivalences", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "z"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], "]"}], 
             ",", "imageQuiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
           "objectEquivalences"}], "]"}], "]"}], "===", 
        RowBox[{"Sort", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
            "]"}], ",", "imageObjectEquivalences"}], "]"}], "]"}]}], "&&", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"Normal", "[", 
          RowBox[{"reduceArrowsFinal", "[", 
           RowBox[{
            RowBox[{"reduceArrowsInitial", "[", 
             RowBox[{
             "domainMorphismAssociation", ",", 
              "categoryMorphismEquivalences"}], "]"}], ",", 
            "objectEquivalences"}], "]"}], "]"}], "]"}], "===", 
        RowBox[{"Sort", "[", 
         RowBox[{"Normal", "[", 
          RowBox[{"reduceArrowsFinal", "[", 
           RowBox[{
            RowBox[{"reduceArrowsInitial", "[", 
             RowBox[{
             "imageMorphismAssociation", ",", "imageMorphismEquivalences"}], 
             "]"}], ",", "imageObjectEquivalences"}], "]"}], "]"}], 
         "]"}]}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.869738984441947*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"bb0b302a-f62e-43d6-bc50-2e735d54b523"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<IdentityFunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "reducedNewObjects", ",", "reducedObjectMappings", ",", "oldObjects", 
       ",", "oldArrows", ",", "oldQuiverObjectEquivalences", ",", 
       "oldObjectEquivalences", ",", "oldArrowEquivalences", ",", 
       "oldMorphismEquivalences", ",", "oldMorphismAssociation", ",", 
       "oldCompositions", ",", "imageObjects", ",", "imageArrows", ",", 
       "morphismAssociation", ",", "compositions", ",", "reducedNewMorphisms",
        ",", "objectListWithDuplicates", ",", "arrowListWithDuplicates", ",", 
       "domainMorphismList", ",", "domainCompositions", ",", 
       "imageMorphismList", ",", "imageCompositions", ",", 
       "reducedMorphismMappings"}], "}"}], ",", 
     RowBox[{
      RowBox[{"reducedNewObjects", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"objects", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "newObjects"}], "]"}], "]"}], ",", 
             RowBox[{"quiverObjectEquivalences", "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
           
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"categoryObjectEquivalences", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "objectEquivalences"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}], ",", 
             RowBox[{"quiverObjectEquivalences", "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
           
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"categoryObjectEquivalences", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "objectEquivalences"}], "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reducedObjectMappings", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Keys", "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
               RowBox[{"reduceObjects", "[", 
                RowBox[{
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}],
                  ",", "categoryObjectEquivalences"}], "]"}]}], "]"}], "]"}], 
            "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", 
               RowBox[{"Association", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{
                   RowBox[{"reduceObjects", "[", 
                    RowBox[{"objects", ",", "quiverObjectEquivalences"}], 
                    "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], 
                "]"}], "]"}], ",", "objectEquivalences"}], "]"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"reduceObjectsWithDuplicates", "[", 
               RowBox[{
                RowBox[{"Keys", "[", "objectMappings", "]"}], ",", 
                "quiverObjectEquivalences"}], "]"}], ",", 
              "categoryObjectEquivalences"}], "]"}], "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", "objectMappings", "]"}], ",", 
              "objectEquivalences"}], "]"}]}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"oldObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"objects", "/.", 
         RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"oldArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
           RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"oldQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"oldObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"oldArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"oldMorphismEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"categoryMorphismEquivalences", "/.", 
             RowBox[{
             "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
            RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"covariant", "===", "True"}], ",", "morphismEquivalences",
             ",", 
            RowBox[{"morphismEquivalences", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"oldMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Normal", "[", 
              RowBox[{"reduceArrowsFinal", "[", 
               RowBox[{
                RowBox[{"reduceArrowsInitial", "[", 
                 RowBox[{"oldArrows", ",", "oldArrowEquivalences"}], "]"}], 
                ",", "oldQuiverObjectEquivalences"}], "]"}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"oldCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"oldMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "oldCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"oldObjects", ",", "oldQuiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"oldMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"oldMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "oldMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"oldObjects", ",", "oldQuiverObjectEquivalences"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"covariant", "===", "True"}], ",", 
             RowBox[{"Normal", "[", "newArrows", "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
              RowBox[{"Normal", "[", "newArrows", "]"}]}]}], "]"}]}], "]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{"imageArrows", ",", "oldArrowEquivalences"}], 
                   "]"}], ",", "oldQuiverObjectEquivalences"}], "]"}], "]"}], 
               ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{"Normal", "[", "newArrows", "]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "newArrows", "]"}]}]}], "]"}]}], 
              "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"compositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", "2"}],
              "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}]}], ",", 
                 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"morphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "compositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "oldQuiverObjectEquivalences"}], "]"}],
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"morphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"morphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "morphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "oldQuiverObjectEquivalences"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"reducedNewMorphisms", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
              RowBox[{"DirectedEdge", "@@", 
               RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
           RowBox[{"Normal", "[", 
            RowBox[{"reduceArrowsFinal", "[", 
             RowBox[{
              RowBox[{"reduceArrowsInitial", "[", 
               RowBox[{
               "morphismAssociation", ",", "oldMorphismEquivalences"}], "]"}],
               ",", "oldObjectEquivalences"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
              RowBox[{"DirectedEdge", "@@", 
               RowBox[{"Last", "[", "#1", "]"}]}]}], "&"}], ")"}], "/@", 
           RowBox[{"Normal", "[", 
            RowBox[{"reduceArrowsFinal", "[", 
             RowBox[{
              RowBox[{"reduceArrowsInitial", "[", 
               RowBox[{
               "oldMorphismAssociation", ",", "oldMorphismEquivalences"}], 
               "]"}], ",", "oldObjectEquivalences"}], "]"}], "]"}]}]}], "]"}],
         "]"}]}], ";", 
      RowBox[{"objectListWithDuplicates", "=", 
       RowBox[{"objects", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"arrowListWithDuplicates", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
         RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], ",", 
             "arrowEquivalences"}], "]"}], ",", "quiverObjectEquivalences"}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"domainMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "domainMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"domainMorphismList", ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjectsWithDuplicates", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"domainMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", 
       RowBox[{"reduceObjectsWithDuplicates", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
          RowBox[{"domainMorphismList", ",", "categoryMorphismEquivalences"}],
           "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
            RowBox[{"arrowListWithDuplicates", ",", 
             RowBox[{"arrowEquivalences", "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], "]"}], ",", 
           RowBox[{"quiverObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"imageMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "imageMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"imageMorphismList", ",", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjectsWithDuplicates", "[", 
          RowBox[{"objectListWithDuplicates", ",", 
           RowBox[{"quiverObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"imageMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", 
       RowBox[{"reduceObjectsWithDuplicates", "[", 
        RowBox[{"objectListWithDuplicates", ",", 
         RowBox[{"quiverObjectEquivalences", "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
          RowBox[{"imageMorphismList", ",", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"categoryMorphismEquivalences", "/.", 
                 RowBox[{
                 "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
                RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"covariant", "===", "True"}], ",", 
                "morphismEquivalences", ",", 
                RowBox[{"morphismEquivalences", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"z", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
                   
                   RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
             "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"categoryObjectEquivalences", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "objectEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"reducedMorphismMappings", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"First", "/@", "domainMorphismList"}], "\[Rule]", 
          RowBox[{"First", "/@", "imageMorphismList"}]}], "]"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "reducedNewObjects", "]"}], "\[Equal]", "0"}], 
       "&&", 
       RowBox[{
        RowBox[{"Length", "[", "reducedNewMorphisms", "]"}], "\[Equal]", 
        "0"}], "&&", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Normal", "[", "reducedObjectMappings", "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "===", 
             RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], "]"}], 
        "\[Equal]", 
        RowBox[{"Length", "[", 
         RowBox[{"Normal", "[", "reducedObjectMappings", "]"}], "]"}]}], "&&", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Normal", "[", "reducedMorphismMappings", "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "===", 
             RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], "]"}], 
        "\[Equal]", 
        RowBox[{"Length", "[", 
         RowBox[{"Normal", "[", "reducedMorphismMappings", "]"}], 
         "]"}]}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697389984915247`*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"c37a4049-d31c-4fd8-b301-6012b2dee896"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjecs_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ConstantFunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "reducedObjectMappings", ",", "objectListWithDuplicates", ",", 
       "arrowListWithDuplicates", ",", "domainMorphismList", ",", 
       "domainCompositions", ",", "imageMorphismList", ",", 
       "imageCompositions", ",", "reducedMorphismMappings", ",", 
       "isConstantFunctor"}], "}"}], ",", 
     RowBox[{
      RowBox[{"reducedObjectMappings", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Keys", "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
               RowBox[{"reduceObjects", "[", 
                RowBox[{
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}],
                  ",", "categoryObjectEquivalences"}], "]"}]}], "]"}], "]"}], 
            "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", 
               RowBox[{"Association", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{
                   RowBox[{"reduceObjects", "[", 
                    RowBox[{"objects", ",", "quiverObjectEquivalences"}], 
                    "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], 
                "]"}], "]"}], ",", "objectEquivalences"}], "]"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"reduceObjectsWithDuplicates", "[", 
               RowBox[{
                RowBox[{"Keys", "[", "objectMappings", "]"}], ",", 
                "quiverObjectEquivalences"}], "]"}], ",", 
              "categoryObjectEquivalences"}], "]"}], "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", "objectMappings", "]"}], ",", 
              "objectEquivalences"}], "]"}]}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"objectListWithDuplicates", "=", 
       RowBox[{"objects", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"arrowListWithDuplicates", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "\[Equal]", "True"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
           RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ")"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], ",", 
             "arrowEquivalences"}], "]"}], ",", "quiverObjectEquivalences"}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"domainMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "domainMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"domainMorphismList", ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjectsWithDuplicates", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"domainMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", 
       RowBox[{"reduceObjectsWithDuplicates", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
          RowBox[{"domainMorphismList", ",", "categoryMorphismEquivalences"}],
           "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
            RowBox[{"arrowListWithDuplicates", ",", 
             RowBox[{"arrowEquivalences", "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], "]"}], ",", 
           RowBox[{"quiverObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"imageMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "imageMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"imageMorphismList", ",", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjectsWithDuplicates", "[", 
          RowBox[{"objectListWithDuplicates", ",", 
           RowBox[{"quiverObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"imageMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", 
       RowBox[{"reduceObjectsWithDuplicates", "[", 
        RowBox[{"objectListWithDuplicates", ",", 
         RowBox[{"quiverObjectEquivalences", "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
          RowBox[{"imageMorphismList", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"covariant", "===", "True"}], ",", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"categoryMorphismEquivalences", "/.", 
                   RowBox[{
                   "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}],
                   "/.", 
                  RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "morphismEquivalences"}], "]"}], "]"}], ",", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"categoryMorphismEquivalences", "/.", 
                    RowBox[{
                    "compositionSymbol", "\[Rule]", 
                    "newCompositionSymbol"}]}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"z", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
                   
                   RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
                "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"categoryObjectEquivalences", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "objectEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reducedMorphismMappings", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"First", "/@", "domainMorphismList"}], "\[Rule]", 
          RowBox[{"First", "/@", "imageMorphismList"}]}], "]"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"isConstantFunctor", "=", "True"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Last", "/@", 
            RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], "]"}], 
          "]"}], "\[NotEqual]", "1"}], ",", 
        RowBox[{"isConstantFunctor", "=", "False"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Last", "/@", 
            RowBox[{"Normal", "[", "reducedMorphismMappings", "]"}]}], "]"}], 
          "]"}], "\[NotEqual]", "1"}], ",", 
        RowBox[{"isConstantFunctor", "=", "False"}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Last", "/@", 
            RowBox[{"Normal", "[", "reducedMorphismMappings", "]"}]}], "]"}], 
          "]"}], "=!=", 
         RowBox[{"newIdentitySymbol", "[", 
          RowBox[{"First", "[", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Last", "/@", 
             RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], "]"}], 
           "]"}], "]"}]}], ",", 
        RowBox[{"isConstantFunctor", "=", "False"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "isConstantFunctor"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697390062031975`*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"088a6630-59f5-4116-bf31-7ee8df9c1336"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<FullFunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageObjects", ",", "imageArrows", ",", 
       "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", ",", 
       "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageMorphismAssociation", ",", "imageCompositions", ",", 
       "reducedObjectMappings", ",", "objectPairs", ",", "isFullFunctor"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"reduceArrowsFinal", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitial", "[", 
          RowBox[{
          "domainMorphismAssociation", ",", "categoryMorphismEquivalences"}], 
          "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"covariant", "===", "True"}], ",", 
             RowBox[{"Normal", "[", "newArrows", "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
              RowBox[{"Normal", "[", "newArrows", "]"}]}]}], "]"}]}], "]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"categoryMorphismEquivalences", "/.", 
             RowBox[{
             "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
            RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"covariant", "===", "True"}], ",", "morphismEquivalences",
             ",", 
            RowBox[{"morphismEquivalences", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], "]"}], 
             ",", "imageQuiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"reduceArrowsFinal", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitial", "[", 
          RowBox[{
          "imageMorphismAssociation", ",", "imageMorphismEquivalences"}], 
          "]"}], ",", "imageObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"reducedObjectMappings", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Keys", "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
               RowBox[{"reduceObjects", "[", 
                RowBox[{
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}],
                  ",", "categoryObjectEquivalences"}], "]"}]}], "]"}], "]"}], 
            "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", 
               RowBox[{"Association", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{
                   RowBox[{"reduceObjects", "[", 
                    RowBox[{"objects", ",", "quiverObjectEquivalences"}], 
                    "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], 
                "]"}], "]"}], ",", "objectEquivalences"}], "]"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"reduceObjectsWithDuplicates", "[", 
               RowBox[{
                RowBox[{"Keys", "[", "objectMappings", "]"}], ",", 
                "quiverObjectEquivalences"}], "]"}], ",", 
              "categoryObjectEquivalences"}], "]"}], "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", "objectMappings", "]"}], ",", 
              "objectEquivalences"}], "]"}]}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"objectPairs", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
           "categoryObjectEquivalences"}], "]"}], ",", "2"}], "]"}]}], ";", 
      RowBox[{"isFullFunctor", "=", "True"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"objectPair", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"First", "[", "objectPair", "]"}]}], "&&", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"Last", "[", "objectPair", "]"}]}]}], "&"}]}], 
                "]"}], "]"}], "<", 
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], 
                    ")"}]}], "&&", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], 
                    ")"}]}]}], "&"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"isFullFunctor", "=", "False"}]}], "]"}]}], "]"}], "&"}],
         ")"}], "/@", "objectPairs"}], ";", "isFullFunctor"}]}], "]"}], "/;", 
   
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.869739015560318*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"d021f57e-9d92-4737-993c-26005cc9e408"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<FaithfulFunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageObjects", ",", "imageArrows", ",", 
       "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", ",", 
       "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageMorphismAssociation", ",", "imageCompositions", ",", 
       "reducedObjectMappings", ",", "objectPairs", ",", 
       "isFaithfulFunctor"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"reduceArrowsFinal", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitial", "[", 
          RowBox[{
          "domainMorphismAssociation", ",", "categoryMorphismEquivalences"}], 
          "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"covariant", "===", "True"}], ",", 
             RowBox[{"Normal", "[", "newArrows", "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
              RowBox[{"Normal", "[", "newArrows", "]"}]}]}], "]"}]}], "]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"categoryMorphismEquivalences", "/.", 
             RowBox[{
             "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
            RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"covariant", "===", "True"}], ",", "morphismEquivalences",
             ",", 
            RowBox[{"morphismEquivalences", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], "]"}], 
             ",", "imageQuiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"reduceArrowsFinal", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitial", "[", 
          RowBox[{
          "imageMorphismAssociation", ",", "imageMorphismEquivalences"}], 
          "]"}], ",", "imageObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"reducedObjectMappings", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Keys", "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
               RowBox[{"reduceObjects", "[", 
                RowBox[{
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}],
                  ",", "categoryObjectEquivalences"}], "]"}]}], "]"}], "]"}], 
            "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", 
               RowBox[{"Association", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{
                   RowBox[{"reduceObjects", "[", 
                    RowBox[{"objects", ",", "quiverObjectEquivalences"}], 
                    "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], 
                "]"}], "]"}], ",", "objectEquivalences"}], "]"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"reduceObjectsWithDuplicates", "[", 
               RowBox[{
                RowBox[{"Keys", "[", "objectMappings", "]"}], ",", 
                "quiverObjectEquivalences"}], "]"}], ",", 
              "categoryObjectEquivalences"}], "]"}], "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", "objectMappings", "]"}], ",", 
              "objectEquivalences"}], "]"}]}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"objectPairs", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
           "categoryObjectEquivalences"}], "]"}], ",", "2"}], "]"}]}], ";", 
      RowBox[{"isFaithfulFunctor", "=", "True"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"objectPair", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"First", "[", "objectPair", "]"}]}], "&&", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"Last", "[", "objectPair", "]"}]}]}], "&"}]}], 
                "]"}], "]"}], ">", 
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], 
                    ")"}]}], "&&", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], 
                    ")"}]}]}], "&"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"isFaithfulFunctor", "=", "False"}]}], "]"}]}], "]"}], 
         "&"}], ")"}], "/@", "objectPairs"}], ";", "\[IndentingNewLine]", 
      "isFaithfulFunctor"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.869739025013877*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"4110b943-71a0-40e2-9436-edc0561bf7e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<FullyFaithfulFunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageObjects", ",", "imageArrows", ",", 
       "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", ",", 
       "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageMorphismAssociation", ",", "imageCompositions", ",", 
       "reducedObjectMappings", ",", "objectPairs", ",", 
       "isFullyFaithfulFunctor"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"reduceArrowsFinal", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitial", "[", 
          RowBox[{
          "domainMorphismAssociation", ",", "categoryMorphismEquivalences"}], 
          "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"covariant", "===", "True"}], ",", 
             RowBox[{"Normal", "[", "newArrows", "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
              RowBox[{"Normal", "[", "newArrows", "]"}]}]}], "]"}]}], "]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"categoryMorphismEquivalences", "/.", 
             RowBox[{
             "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
            RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"covariant", "===", "True"}], ",", "morphismEquivalences",
             ",", 
            RowBox[{"morphismEquivalences", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], "]"}], 
             ",", "imageQuiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"reduceArrowsFinal", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitial", "[", 
          RowBox[{
          "imageMorphismAssociation", ",", "imageMorphismEquivalences"}], 
          "]"}], ",", "imageObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"reducedObjectMappings", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Keys", "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
               RowBox[{"reduceObjects", "[", 
                RowBox[{
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}],
                  ",", "categoryObjectEquivalences"}], "]"}]}], "]"}], "]"}], 
            "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", 
               RowBox[{"Association", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{
                   RowBox[{"reduceObjects", "[", 
                    RowBox[{"objects", ",", "quiverObjectEquivalences"}], 
                    "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], 
                "]"}], "]"}], ",", "objectEquivalences"}], "]"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"reduceObjectsWithDuplicates", "[", 
               RowBox[{
                RowBox[{"Keys", "[", "objectMappings", "]"}], ",", 
                "quiverObjectEquivalences"}], "]"}], ",", 
              "categoryObjectEquivalences"}], "]"}], "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", "objectMappings", "]"}], ",", 
              "objectEquivalences"}], "]"}]}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"objectPairs", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
           "categoryObjectEquivalences"}], "]"}], ",", "2"}], "]"}]}], ";", 
      RowBox[{"isFullyFaithfulFunctor", "=", "True"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"objectPair", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"First", "[", "objectPair", "]"}]}], "&&", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"Last", "[", "objectPair", "]"}]}]}], "&"}]}], 
                "]"}], "]"}], "\[NotEqual]", 
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], 
                    ")"}]}], "&&", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], 
                    ")"}]}]}], "&"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"isFullyFaithfulFunctor", "=", "False"}]}], "]"}]}], 
          "]"}], "&"}], ")"}], "/@", "objectPairs"}], ";", 
      "\[IndentingNewLine]", "isFullyFaithfulFunctor"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697390347926273`*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"85834c94-b75a-4bcb-ad84-655a4bb9a0a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<InjectiveOnObjectsQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "objectFunction", ",", "domainObjectEquivalenceGraph", ",", 
       "imageObjectEquivalenceGraph", ",", "objectPairs", ",", 
       "isInjectiveOnObjects"}], "}"}], ",", 
     RowBox[{
      RowBox[{"objectFunction", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", "objects"}],
           "]"}], ",", "objectMappings"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", 
                 "categoryObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"imageObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"quiverObjectEquivalences", "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{"DeleteDuplicates", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"categoryObjectEquivalences", "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                    "objectEquivalences"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectPairs", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"isInjectiveOnObjects", "=", "True"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"objectPair", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                "VertexList", "[", "imageObjectEquivalenceGraph", "]"}], ",", 
                
                RowBox[{"First", "[", "objectPair", "]"}]}], "]"}], "&&", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                "VertexList", "[", "imageObjectEquivalenceGraph", "]"}], ",", 
                
                RowBox[{"Last", "[", "objectPair", "]"}]}], "]"}]}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"FindShortestPath", "[", 
                  RowBox[{"imageObjectEquivalenceGraph", ",", 
                   RowBox[{"First", "[", "objectPair", "]"}], ",", 
                   RowBox[{"Last", "[", "objectPair", "]"}]}], "]"}], "]"}], 
                ">", "0"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainObjectEquivalenceGraph", "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                   "]"}], "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainObjectEquivalenceGraph", "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                    "]"}], "]"}], "\[Equal]", "0"}], ",", 
                   RowBox[{"isInjectiveOnObjects", "=", "False"}]}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "/@", 
       "objectPairs"}], ";", "isInjectiveOnObjects"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.869739039739482*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"7cfa7922-f825-4e87-a419-e14ba6297bcf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<EssentiallyInjectiveFunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "domainObjectEquivalenceGraph", ",", "domainMorphismEquivalenceGraph", 
       ",", "domainIsomorphisms", ",", "imageMorphismAssociation", ",", 
       "imageCompositions", ",", "imageQuiverObjectEquivalences", ",", 
       "imageObjectEquivalences", ",", "imageArrowEquivalences", ",", 
       "imageMorphismEquivalences", ",", "imageObjectEquivalenceGraph", ",", 
       "imageMorphismEquivalenceGraph", ",", "imageIsomorphisms", ",", 
       "objectFunction", ",", "domainObjectIsomorphismGraph", ",", 
       "imageObjectIsomorphismGraph", ",", "objectPairs", ",", 
       "isEssentiallyInjectiveFunctor"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"domainObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", 
                 "categoryObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "arrowEquivalences", ",", "categoryMorphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}]}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"domainIsomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainMorphismEquivalenceGraph", 
                    "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainMorphismEquivalenceGraph", 
                    "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainMorphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainMorphismEquivalenceGraph", 
                    "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainMorphismEquivalenceGraph", 
                    "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainMorphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"isRetraction", "&&", "isSection"}], ",", 
              RowBox[{"domainIsomorphisms", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"domainIsomorphisms", ",", 
                 RowBox[{"Last", "[", "morphism", "]"}]}], "]"}]}]}], 
             "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainIsomorphisms", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{"Equal", ",", 
           RowBox[{"DeleteDuplicates", "[", "domainIsomorphisms", "]"}], ",", 
           
           RowBox[{"{", "1", "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"#1", "=!=", "True"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                   ")"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"categoryMorphismEquivalences", "/.", 
               RowBox[{
               "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"categoryMorphismEquivalences", "/.", 
                RowBox[{
                "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"imageObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "imageQuiverObjectEquivalences", ",", 
                 "imageObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
      RowBox[{"imageMorphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "imageArrowEquivalences", ",", "imageMorphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}]}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"imageIsomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"objects", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"objects", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageMorphismEquivalenceGraph", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageMorphismEquivalenceGraph", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"isRetraction", "&&", "isSection"}], ",", 
              RowBox[{"imageIsomorphisms", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"imageIsomorphisms", ",", 
                 RowBox[{"Last", "[", "morphism", "]"}]}], "]"}]}]}], 
             "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageIsomorphisms", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{"Equal", ",", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Sort", "/@", "imageIsomorphisms"}], "]"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"#1", "=!=", "True"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectFunction", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", "objects"}],
           "]"}], ",", "objectMappings"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainObjectIsomorphismGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "categoryObjectEquivalences",
                  ",", "domainIsomorphisms"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"imageObjectIsomorphismGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"quiverObjectEquivalences", "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{"DeleteDuplicates", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"categoryObjectEquivalences", "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                    "objectEquivalences"}], "]"}], "]"}], ",", 
                 "imageIsomorphisms"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectPairs", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"isEssentiallyInjectiveFunctor", "=", "True"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"objectPair", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                "VertexList", "[", "imageObjectIsomorphismGraph", "]"}], ",", 
                
                RowBox[{"First", "[", "objectPair", "]"}]}], "]"}], "&&", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                "VertexList", "[", "imageObjectIsomorphismGraph", "]"}], ",", 
                
                RowBox[{"Last", "[", "objectPair", "]"}]}], "]"}]}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"FindShortestPath", "[", 
                  RowBox[{"imageObjectIsomorphismGraph", ",", 
                   RowBox[{"First", "[", "objectPair", "]"}], ",", 
                   RowBox[{"Last", "[", "objectPair", "]"}]}], "]"}], "]"}], 
                ">", "0"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainObjectIsomorphismGraph", "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                   "]"}], "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainObjectIsomorphismGraph", "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainObjectIsomorphismGraph", ",", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                    "]"}], "]"}], "\[Equal]", "0"}], ",", 
                   RowBox[{"isEssentiallyInjectiveFunctor", "=", "False"}]}], 
                  "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "/@",
        "objectPairs"}], ";", "isEssentiallyInjectiveFunctor"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.869739059472056*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"9c3bcf00-4fa3-4850-8e5d-aac6ad47c60b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<SurjectiveOnObjectsQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"reduceObjects", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}], ",", 
           RowBox[{"quiverObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"categoryObjectEquivalences", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "objectEquivalences"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}], ",", 
           RowBox[{"quiverObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"categoryObjectEquivalences", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "objectEquivalences"}], "]"}], "]"}]}], "]"}]}], "]"}], "]"}], 
    "\[Equal]", "0"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<EssentiallySurjectiveFunctorQ\>\"", "]"}], ":=", 
  
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "imageMorphismAssociation", ",", "imageCompositions", ",", 
       "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", ",", 
       "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageObjectEquivalenceGraph", ",", "imageMorphismEquivalenceGraph", 
       ",", "imageIsomorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                   ")"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"categoryMorphismEquivalences", "/.", 
               RowBox[{
               "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"categoryMorphismEquivalences", "/.", 
                RowBox[{
                "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"imageObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "imageQuiverObjectEquivalences", ",", 
                 "imageObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
      RowBox[{"imageMorphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "imageArrowEquivalences", ",", "imageMorphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}]}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"imageIsomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"objects", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"objects", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageMorphismEquivalenceGraph", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageMorphismEquivalenceGraph", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"isRetraction", "&&", "isSection"}], ",", 
              RowBox[{"imageIsomorphisms", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"imageIsomorphisms", ",", 
                 RowBox[{"Last", "[", "morphism", "]"}]}], "]"}]}]}], 
             "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"reduceObjects", "[", 
           RowBox[{
            RowBox[{"reduceObjects", "[", 
             RowBox[{
              RowBox[{"DeleteDuplicates", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"objects", "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 "newObjects"}], "]"}], "]"}], ",", 
              RowBox[{"quiverObjectEquivalences", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"DeleteDuplicates", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"categoryObjectEquivalences", "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 "objectEquivalences"}], "]"}], "]"}], ",", 
              "imageIsomorphisms"}], "]"}]}], "]"}], ",", 
          RowBox[{"reduceObjects", "[", 
           RowBox[{
            RowBox[{"reduceObjects", "[", 
             RowBox[{
              RowBox[{"DeleteDuplicates", "[", 
               RowBox[{"objects", "/.", 
                RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}], ",", 
              
              RowBox[{"quiverObjectEquivalences", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"DeleteDuplicates", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"categoryObjectEquivalences", "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 "objectEquivalences"}], "]"}], "]"}], ",", 
              "imageIsomorphisms"}], "]"}]}], "]"}]}], "]"}], "]"}], 
       "\[Equal]", "0"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697390707686663`*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"9b9b680f-f391-4099-8411-4aacaade3fa4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<BijectiveOnObjectsQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "objectFunction", ",", "domainObjectEquivalenceGraph", ",", 
       "imageObjectEquivalenceGraph", ",", "objectPairs", ",", 
       "isInjectiveOnObjects"}], "}"}], ",", 
     RowBox[{
      RowBox[{"objectFunction", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", "objects"}],
           "]"}], ",", "objectMappings"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", 
                 "categoryObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"imageObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"quiverObjectEquivalences", "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{"DeleteDuplicates", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"categoryObjectEquivalences", "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                    "objectEquivalences"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectPairs", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"isInjectiveOnObjects", "=", "True"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"objectPair", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                "VertexList", "[", "imageObjectEquivalenceGraph", "]"}], ",", 
                
                RowBox[{"First", "[", "objectPair", "]"}]}], "]"}], "&&", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                "VertexList", "[", "imageObjectEquivalenceGraph", "]"}], ",", 
                
                RowBox[{"Last", "[", "objectPair", "]"}]}], "]"}]}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"FindShortestPath", "[", 
                  RowBox[{"imageObjectEquivalenceGraph", ",", 
                   RowBox[{"First", "[", "objectPair", "]"}], ",", 
                   RowBox[{"Last", "[", "objectPair", "]"}]}], "]"}], "]"}], 
                ">", "0"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainObjectEquivalenceGraph", "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                   "]"}], "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainObjectEquivalenceGraph", "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                    "]"}], "]"}], "\[Equal]", "0"}], ",", 
                   RowBox[{"isInjectiveOnObjects", "=", "False"}]}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "/@", 
       "objectPairs"}], ";", 
      RowBox[{"isInjectiveOnObjects", "&&", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"objects", "/.", 
                   RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                  "newObjects"}], "]"}], "]"}], ",", 
               RowBox[{"quiverObjectEquivalences", "/.", 
                RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], 
             ",", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"categoryObjectEquivalences", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "objectEquivalences"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"reduceObjects", "[", 
            RowBox[{
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"objects", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}], ",", 
               RowBox[{"quiverObjectEquivalences", "/.", 
                RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], 
             ",", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"categoryObjectEquivalences", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "objectEquivalences"}], "]"}], "]"}]}], "]"}]}], "]"}], "]"}],
         "\[Equal]", "0"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697390771134777`*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"049e7213-ddba-4d04-9034-8f6415213148"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<EssentiallyBijectiveFunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "domainObjectEquivalenceGraph", ",", "domainMorphismEquivalenceGraph", 
       ",", "domainIsomorphisms", ",", "imageMorphismAssociation", ",", 
       "imageCompositions", ",", "imageQuiverObjectEquivalences", ",", 
       "imageObjectEquivalences", ",", "imageArrowEquivalences", ",", 
       "imageMorphismEquivalences", ",", "imageObjectEquivalenceGraph", ",", 
       "imageMorphismEquivalenceGraph", ",", "imageIsomorphisms", ",", 
       "objectFunction", ",", "domainObjectIsomorphismGraph", ",", 
       "imageObjectIsomorphismGraph", ",", "objectPairs", ",", 
       "isEssentiallyInjectiveFunctor"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"domainObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", 
                 "categoryObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "arrowEquivalences", ",", "categoryMorphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}]}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"domainIsomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainMorphismEquivalenceGraph", 
                    "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainMorphismEquivalenceGraph", 
                    "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainMorphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainMorphismEquivalenceGraph", 
                    "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainMorphismEquivalenceGraph", 
                    "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainMorphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"isRetraction", "&&", "isSection"}], ",", 
              RowBox[{"domainIsomorphisms", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"domainIsomorphisms", ",", 
                 RowBox[{"Last", "[", "morphism", "]"}]}], "]"}]}]}], 
             "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainIsomorphisms", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{"Equal", ",", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Sort", "/@", "domainIsomorphisms"}], "]"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"#1", "=!=", "True"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                   ")"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"categoryMorphismEquivalences", "/.", 
               RowBox[{
               "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"categoryMorphismEquivalences", "/.", 
                RowBox[{
                "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"imageObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "imageQuiverObjectEquivalences", ",", 
                 "imageObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
      RowBox[{"imageMorphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "imageArrowEquivalences", ",", "imageMorphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}]}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"imageIsomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"objects", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"objects", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageMorphismEquivalenceGraph", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageMorphismEquivalenceGraph", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"isRetraction", "&&", "isSection"}], ",", 
              RowBox[{"imageIsomorphisms", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"imageIsomorphisms", ",", 
                 RowBox[{"Last", "[", "morphism", "]"}]}], "]"}]}]}], 
             "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageIsomorphisms", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{"Equal", ",", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Sort", "/@", "imageIsomorphisms"}], "]"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"#1", "=!=", "True"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectFunction", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", "objects"}],
           "]"}], ",", "objectMappings"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainObjectIsomorphismGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", "categoryObjectEquivalences",
                  ",", "domainIsomorphisms"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"imageObjectIsomorphismGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"quiverObjectEquivalences", "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{"DeleteDuplicates", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"categoryObjectEquivalences", "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                    "objectEquivalences"}], "]"}], "]"}], ",", 
                 "imageIsomorphisms"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectPairs", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"isEssentiallyInjectiveFunctor", "=", "True"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"objectPair", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                "VertexList", "[", "imageObjectIsomorphismGraph", "]"}], ",", 
                
                RowBox[{"First", "[", "objectPair", "]"}]}], "]"}], "&&", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                "VertexList", "[", "imageObjectIsomorphismGraph", "]"}], ",", 
                
                RowBox[{"Last", "[", "objectPair", "]"}]}], "]"}]}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"FindShortestPath", "[", 
                  RowBox[{"imageObjectIsomorphismGraph", ",", 
                   RowBox[{"First", "[", "objectPair", "]"}], ",", 
                   RowBox[{"Last", "[", "objectPair", "]"}]}], "]"}], "]"}], 
                ">", "0"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainObjectIsomorphismGraph", "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                   "]"}], "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainObjectIsomorphismGraph", "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainObjectIsomorphismGraph", ",", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                    "]"}], "]"}], "\[Equal]", "0"}], ",", 
                   RowBox[{"isEssentiallyInjectiveFunctor", "=", "False"}]}], 
                  "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "/@",
        "objectPairs"}], ";", 
      RowBox[{"isEssentiallyInjectiveFunctor", "&&", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"objects", "/.", 
                   RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                  "newObjects"}], "]"}], "]"}], ",", 
               RowBox[{"quiverObjectEquivalences", "/.", 
                RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], 
             ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"categoryObjectEquivalences", "/.", 
                   RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                  "objectEquivalences"}], "]"}], "]"}], ",", 
               "imageIsomorphisms"}], "]"}]}], "]"}], ",", 
           RowBox[{"reduceObjects", "[", 
            RowBox[{
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"objects", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}], ",", 
               RowBox[{"quiverObjectEquivalences", "/.", 
                RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], 
             ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"categoryObjectEquivalences", "/.", 
                   RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                  "objectEquivalences"}], "]"}], "]"}], ",", 
               "imageIsomorphisms"}], "]"}]}], "]"}]}], "]"}], "]"}], 
        "\[Equal]", "0"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.869739087313184*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"dd5762b1-fa1d-4a89-adb3-8029a70db7f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ConservativeFunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "domainObjectEquivalenceGraph", ",", "domainMorphismEquivalenceGraph", 
       ",", "domainIsomorphisms", ",", "imageMorphismAssociation", ",", 
       "imageCompositions", ",", "imageQuiverObjectEquivalences", ",", 
       "imageObjectEquivalences", ",", "imageArrowEquivalences", ",", 
       "imageMorphismEquivalences", ",", "imageObjectEquivalenceGraph", ",", 
       "imageMorphismEquivalenceGraph", ",", "imageIsomorphisms", ",", 
       "objectListWithDuplicates", ",", "arrowListWithDuplicates", ",", 
       "domainMorphismList", ",", "domainCompositionsList", ",", 
       "imageMorphismList", ",", "imageCompositionsList", ",", 
       "morphismFunction", ",", "isConservativeFunctor"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"domainObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", 
                 "categoryObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "arrowEquivalences", ",", "categoryMorphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}]}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"domainIsomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@",
              "objects"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainMorphismEquivalenceGraph", 
                    "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainMorphismEquivalenceGraph", 
                    "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainMorphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainMorphismEquivalenceGraph", 
                    "]"}], ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainMorphismEquivalenceGraph", 
                    "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], ",", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainMorphismEquivalenceGraph", ",", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"identitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"isRetraction", "&&", "isSection"}], ",", 
              RowBox[{"domainIsomorphisms", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"domainIsomorphisms", ",", 
                 RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}]}], 
             "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                   ")"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"categoryMorphismEquivalences", "/.", 
               RowBox[{
               "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"categoryMorphismEquivalences", "/.", 
                RowBox[{
                "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"imageObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "imageQuiverObjectEquivalences", ",", 
                 "imageObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
      RowBox[{"imageMorphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "imageArrowEquivalences", ",", "imageMorphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}]}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"imageIsomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"objects", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"objects", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageMorphismEquivalenceGraph", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageMorphismEquivalenceGraph", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"isRetraction", "&&", "isSection"}], ",", 
              RowBox[{"imageIsomorphisms", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"imageIsomorphisms", ",", 
                 RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}]}], 
             "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectListWithDuplicates", "=", 
       RowBox[{"objects", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      RowBox[{"arrowListWithDuplicates", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
           RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ")"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "arrows", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositionsList", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"domainMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "domainMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"domainMorphismList", ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositionsList"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"domainMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", "objects"}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"arrowListWithDuplicates", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositionsList", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"imageMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "imageMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"imageMorphismList", ",", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositionsList"}]}], ",", 
        RowBox[{"Length", "[", "objectListWithDuplicates", "]"}]}], "]"}], 
      ";", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"imageMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", "objectListWithDuplicates"}], ";", 
      RowBox[{"morphismFunction", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"First", "/@", "domainMorphismList"}], "\[Rule]", 
          RowBox[{"First", "/@", "imageMorphismList"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"isConservativeFunctor", "=", "True"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"imageIsomorphism", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"domainIsomorphisms", ",", 
                RowBox[{"imageIsomorphism", "/.", 
                 RowBox[{"Reverse", "/@", 
                  RowBox[{"Normal", "[", "morphismFunction", "]"}]}]}]}], 
               "]"}]}], ",", 
             RowBox[{"isConservativeFunctor", "=", "False"}]}], "]"}]}], 
          "]"}], "&"}], ")"}], "/@", "imageIsomorphisms"}], ";", 
      "\[IndentingNewLine]", "isConservativeFunctor"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697390978294325`*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"52870e07-2df5-4c03-98b4-f3a05e3e9f24"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<EquivalenceFunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "reducedDomainMorphismAssociation", ",", "reducedDomainCompositions", 
       ",", "imageObjects", ",", "imageArrows", ",", 
       "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", ",", 
       "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "reducedImageMorphismAssociation", ",", "reducedImageCompositions", 
       ",", "reducedObjectMappings", ",", "objectPairs", ",", 
       "isFullyFaithfulFunctor", ",", "imageMorphismAssociation", ",", 
       "imageCompositions", ",", "newImageMorphismEquivalences", ",", 
       "imageObjectEquivalenceGraph", ",", "imageMorphismEquivalenceGraph", 
       ",", "imageIsomorphisms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"reducedDomainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedDomainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{
              "Normal", "[", "reducedDomainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedDomainMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedDomainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{
                  "Normal", "[", "reducedDomainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedDomainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedDomainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedDomainMorphismAssociation", "]"}], 
          ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
              "Normal", "[", "reducedDomainMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedDomainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{
               "Normal", "[", "reducedDomainMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reducedDomainMorphismAssociation", "=", 
       RowBox[{"reduceArrowsFinal", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitial", "[", 
          RowBox[{
          "reducedDomainMorphismAssociation", ",", 
           "categoryMorphismEquivalences"}], "]"}], ",", 
         "categoryObjectEquivalences"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"covariant", "===", "True"}], ",", 
             RowBox[{"Normal", "[", "newArrows", "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
              RowBox[{"Normal", "[", "newArrows", "]"}]}]}], "]"}]}], "]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"categoryMorphismEquivalences", "/.", 
             RowBox[{
             "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
            RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"covariant", "===", "True"}], ",", "morphismEquivalences",
             ",", 
            RowBox[{"morphismEquivalences", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"reducedImageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], "]"}], 
             ",", "imageQuiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedImageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedImageMorphismAssociation", "]"}],
               ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedImageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedImageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{
                  "Normal", "[", "reducedImageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedImageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"reducedImageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedImageMorphismAssociation", "]"}], 
          ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedImageMorphismAssociation", "]"}],
               ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedImageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{
               "Normal", "[", "reducedImageMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
        "]"}]}], ";", 
      RowBox[{"reducedImageMorphismAssociation", "=", 
       RowBox[{"reduceArrowsFinal", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitial", "[", 
          RowBox[{
          "reducedImageMorphismAssociation", ",", 
           "imageMorphismEquivalences"}], "]"}], ",", 
         "imageObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"reducedObjectMappings", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Keys", "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
               RowBox[{"reduceObjects", "[", 
                RowBox[{
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}],
                  ",", "categoryObjectEquivalences"}], "]"}]}], "]"}], "]"}], 
            "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", 
               RowBox[{"Association", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{
                   RowBox[{"reduceObjects", "[", 
                    RowBox[{"objects", ",", "quiverObjectEquivalences"}], 
                    "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], 
                "]"}], "]"}], ",", "objectEquivalences"}], "]"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"reduceObjectsWithDuplicates", "[", 
               RowBox[{
                RowBox[{"Keys", "[", "objectMappings", "]"}], ",", 
                "quiverObjectEquivalences"}], "]"}], ",", 
              "categoryObjectEquivalences"}], "]"}], "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", "objectMappings", "]"}], ",", 
              "objectEquivalences"}], "]"}]}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"objectPairs", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
           "categoryObjectEquivalences"}], "]"}], ",", "2"}], "]"}]}], ";", 
      RowBox[{"isFullyFaithfulFunctor", "=", "True"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"objectPair", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{
                 "Normal", "[", "reducedDomainMorphismAssociation", "]"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"First", "[", "objectPair", "]"}]}], "&&", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"Last", "[", "objectPair", "]"}]}]}], "&"}]}], 
                "]"}], "]"}], "\[NotEqual]", 
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{
                 "Normal", "[", "reducedImageMorphismAssociation", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], 
                    ")"}]}], "&&", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], 
                    ")"}]}]}], "&"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"isFullyFaithfulFunctor", "=", "False"}]}], "]"}]}], 
          "]"}], "&"}], ")"}], "/@", "objectPairs"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                   ")"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newImageMorphismEquivalences", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"categoryMorphismEquivalences", "/.", 
               RowBox[{
               "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"categoryMorphismEquivalences", "/.", 
                RowBox[{
                "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"imageObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "imageQuiverObjectEquivalences", ",", 
                 "imageObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
      RowBox[{"imageMorphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "imageArrowEquivalences", ",", 
                 "newImageMorphismEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}]}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"imageIsomorphisms", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"morphism", "=", "#1"}], ",", "morphisms", ",", 
             "isRetraction", ",", "isSection"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                   "]"}], ">", "0"}]}], "&"}]}], "]"}]}], ";", 
            RowBox[{"isRetraction", "=", "False"}], ";", 
            RowBox[{"isSection", "=", "False"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isRetraction", "=", "True"}]}], "]"}], "&"}], ")"}],
              "/@", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"objects", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"morphism", "===", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                    
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"#1", ",", "#1"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"isSection", "=", "True"}]}], "]"}], "&"}], ")"}], "/@", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"objects", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"newMorphism", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageMorphismEquivalenceGraph", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "morphism", "]"}], ",", 
                    RowBox[{"First", "[", "newMorphism", "]"}]}], "]"}], ",", 
                    
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isRetraction", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "morphism", "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "newMorphism", "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageMorphismEquivalenceGraph", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "newMorphism", "]"}], ",", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "]"}], ",", 
                    RowBox[{"newIdentitySymbol", "[", "#1", "]"}]}], "]"}], 
                    "]"}], ">", "0"}], ",", 
                    RowBox[{"isSection", "=", "True"}]}], "]"}]}], "]"}], 
                    "&"}], ")"}], "/@", "equivalentObjects"}]}]}], "]"}]}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"isRetraction", "&&", "isSection"}], ",", 
              RowBox[{"imageIsomorphisms", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"imageIsomorphisms", ",", 
                 RowBox[{"Last", "[", "morphism", "]"}]}], "]"}]}]}], 
             "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"isFullyFaithfulFunctor", "&&", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"objects", "/.", 
                   RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                  "newObjects"}], "]"}], "]"}], ",", 
               RowBox[{"quiverObjectEquivalences", "/.", 
                RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], 
             ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"categoryObjectEquivalences", "/.", 
                   RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                  "objectEquivalences"}], "]"}], "]"}], ",", 
               "imageIsomorphisms"}], "]"}]}], "]"}], ",", 
           RowBox[{"reduceObjects", "[", 
            RowBox[{
             RowBox[{"reduceObjects", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"objects", "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], "]"}], ",", 
               RowBox[{"quiverObjectEquivalences", "/.", 
                RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], 
             ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"categoryObjectEquivalences", "/.", 
                   RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                  "objectEquivalences"}], "]"}], "]"}], ",", 
               "imageIsomorphisms"}], "]"}]}], "]"}]}], "]"}], "]"}], 
        "\[Equal]", "0"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697391128316603`*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"80aba1f0-7797-4090-aa53-6763fa225e3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<FiberCategories\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "objectFunction", ",", "objectListWithDuplicates", ",", 
       "arrowListWithDuplicates", ",", "domainMorphismList", ",", 
       "domainCompositions", ",", "imageMorphismList", ",", 
       "imageCompositions", ",", "morphismFunction", ",", 
       "domainObjectEquivalenceGraph", ",", "domainMorphismEquivalenceGraph", 
       ",", "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", 
       ",", "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageObjectEquivalenceGraph", ",", "imageMorphismEquivalenceGraph", 
       ",", "fiberCategories"}], "}"}], ",", 
     RowBox[{
      RowBox[{"objectFunction", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", "objects"}],
           "]"}], ",", "objectMappings"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectListWithDuplicates", "=", 
       RowBox[{"objects", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      RowBox[{"arrowListWithDuplicates", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
           RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ")"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "arrows", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"domainMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "domainMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"domainMorphismList", ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"domainMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", "objects"}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"arrowListWithDuplicates", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"imageMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "imageMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"imageMorphismList", ",", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objectListWithDuplicates", "]"}]}], "]"}], 
      ";", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"imageMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", "objectListWithDuplicates"}], ";", 
      RowBox[{"morphismFunction", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"First", "/@", "domainMorphismList"}], "\[Rule]", 
          RowBox[{"First", "/@", "imageMorphismList"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"domainObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", 
                 "categoryObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "arrowEquivalences", ",", "categoryMorphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", 
             RowBox[{"Association", "[", 
              RowBox[{"DeleteDuplicates", "[", "domainMorphismList", "]"}], 
              "]"}], "]"}]}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Sort", "/@", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"categoryMorphismEquivalences", "/.", 
                RowBox[{
                "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
             "morphismEquivalences"}], "]"}]}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Sort", "/@", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"categoryMorphismEquivalences", "/.", 
                 RowBox[{
                 "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
                RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{"x_", ",", 
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                 "\[RuleDelayed]", 
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{"z", ",", 
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                 "\[RuleDelayed]", 
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
                
                RowBox[{
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
             "morphismEquivalences"}], "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "imageQuiverObjectEquivalences", ",", 
                 "imageObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "imageArrowEquivalences", ",", "imageMorphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", 
             RowBox[{"Association", "[", 
              RowBox[{"DeleteDuplicates", "[", "imageMorphismList", "]"}], 
              "]"}], "]"}]}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"fiberCategories", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"imageObject", "=", "#1"}], ",", "fiberObjects", ",", 
             "fiberMorphisms"}], "}"}], ",", 
           RowBox[{
            RowBox[{"fiberObjects", "=", 
             RowBox[{"{", "}"}]}], ";", 
            RowBox[{"fiberMorphisms", "=", 
             RowBox[{"{", "}"}]}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"domainObject", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainObjectEquivalenceGraph", "]"}], 
                    ",", "domainObject"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{
                    "domainObjectEquivalenceGraph", ",", "domainObject"}], 
                    "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageObjectEquivalenceGraph", "]"}], 
                    ",", 
                    RowBox[{"domainObject", "/.", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}], "]"}],
                     "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageObjectEquivalenceGraph", "]"}], 
                    ",", "imageObject"}], "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"domainObject", "/.", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}], ",", 
                    "imageObject"}], "]"}], "]"}], ">", "0"}], ",", 
                    RowBox[{"fiberObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{"fiberObjects", ",", "equivalentObjects"}], 
                    "]"}]}]}], "]"}]}], "]"}]}]}], "]"}]}], "]"}], "&"}], 
              ")"}], "/@", "objects"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"domainMorphism", "=", "#1"}], ",", 
                   "equivalentMorphisms"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainMorphismEquivalenceGraph", 
                    "]"}], ",", "domainMorphism"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"equivalentMorphisms", "=", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{
                    "domainMorphismEquivalenceGraph", ",", "domainMorphism"}],
                     "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"domainMorphism", "/.", 
                    RowBox[{"Normal", "[", "morphismFunction", "]"}]}]}], 
                    "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newIdentitySymbol", "[", "imageObject", "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageMorphismEquivalenceGraph", ",", 
                    RowBox[{"domainMorphism", "/.", 
                    RowBox[{"Normal", "[", "morphismFunction", "]"}]}], ",", 
                    RowBox[{"newIdentitySymbol", "[", "imageObject", "]"}]}], 
                    "]"}], "]"}], ">", "0"}], ",", 
                    RowBox[{"fiberMorphisms", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{"fiberMorphisms", ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Normal", "[", 
                    RowBox[{"Association", "[", 
                    RowBox[{
                    "DeleteDuplicates", "[", "domainMorphismList", "]"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"equivalentMorphisms", ",", 
                    RowBox[{"First", "[", "#1", "]"}]}], "]"}], "&"}]}], 
                    "]"}]}], "]"}]}]}], "]"}]}], "]"}]}]}], "]"}]}], "]"}], 
               "&"}], ")"}], "/@", 
             RowBox[{"First", "/@", 
              RowBox[{"Normal", "[", 
               RowBox[{"Association", "[", 
                RowBox[{"DeleteDuplicates", "[", "domainMorphismList", "]"}], 
                "]"}], "]"}]}]}], ";", 
            RowBox[{"fiberCategories", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"fiberCategories", ",", 
               RowBox[{"imageObject", "\[Rule]", 
                RowBox[{"AbstractCategory", "[", 
                 RowBox[{"Association", "[", 
                  RowBox[{
                   RowBox[{
                   "\"\<CompositionSymbol\>\"", "\[Rule]", 
                    "compositionSymbol"}], ",", 
                   RowBox[{
                   "\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
                   ",", 
                   RowBox[{
                   "\"\<MorphismEquivalences\>\"", "\[Rule]", 
                    "categoryMorphismEquivalences"}], ",", 
                   RowBox[{
                   "\"\<ObjectEquivalences\>\"", "\[Rule]", 
                    "categoryObjectEquivalences"}], ",", 
                   RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    "ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
                    "[", 
                    RowBox[{"Association", "[", 
                    RowBox[{
                    RowBox[{
                    "\"\<ArrowEquivalences\>\"", "\[Rule]", 
                    "arrowEquivalences"}], ",", 
                    RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
                    RowBox[{"Association", "[", 
                    RowBox[{"DeleteDuplicates", "[", "fiberMorphisms", "]"}], 
                    "]"}]}], ",", 
                    RowBox[{
                    "\"\<ObjectEquivalences\>\"", "\[Rule]", 
                    "quiverObjectEquivalences"}], ",", 
                    RowBox[{"\"\<Objects\>\"", "\[Rule]", "fiberObjects"}]}], 
                    "]"}], "]"}]}]}], "]"}], "]"}]}]}], "]"}]}]}]}], "]"}], 
         "&"}], ")"}], "/@", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", 
      RowBox[{"Association", "[", "fiberCategories", "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
   3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
   3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
   3.869738945573786*^9, 3.869739119286109*^9}, 3.8697394734827013`*^9},
 CellLabel->
  "In[219]:=",ExpressionUUID->"91253aaf-eb7b-47d0-ae61-78d301847f3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ReducedFiberCategories\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "objectFunction", ",", "objectListWithDuplicates", ",", 
       "arrowListWithDuplicates", ",", "domainMorphismList", ",", 
       "domainCompositions", ",", "imageMorphismList", ",", 
       "imageCompositions", ",", "morphismFunction", ",", 
       "domainObjectEquivalenceGraph", ",", "domainMorphismEquivalenceGraph", 
       ",", "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", 
       ",", "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageObjectEquivalenceGraph", ",", "imageMorphismEquivalenceGraph", 
       ",", "reducedFiberCategories"}], "}"}], ",", 
     RowBox[{
      RowBox[{"objectFunction", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", "objects"}],
           "]"}], ",", "objectMappings"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectListWithDuplicates", "=", 
       RowBox[{"objects", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      RowBox[{"arrowListWithDuplicates", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
           RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ")"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Normal", "[", "arrows", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"domainMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "domainMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"domainMorphismList", ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"domainMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", "objects"}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"arrowListWithDuplicates", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"imageMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "imageMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"imageMorphismList", ",", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objectListWithDuplicates", "]"}]}], "]"}], 
      ";", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"imageMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", "objectListWithDuplicates"}], ";", 
      RowBox[{"morphismFunction", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"First", "/@", "domainMorphismList"}], "\[Rule]", 
          RowBox[{"First", "/@", "imageMorphismList"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"domainObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", 
                 "categoryObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "arrowEquivalences", ",", "categoryMorphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", 
             RowBox[{"Association", "[", 
              RowBox[{"DeleteDuplicates", "[", "domainMorphismList", "]"}], 
              "]"}], "]"}]}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Sort", "/@", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"categoryMorphismEquivalences", "/.", 
                RowBox[{
                "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
             "morphismEquivalences"}], "]"}]}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Sort", "/@", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"categoryMorphismEquivalences", "/.", 
                 RowBox[{
                 "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
                RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{"x_", ",", 
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                 "\[RuleDelayed]", 
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{"z", ",", 
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                 "\[RuleDelayed]", 
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
                
                RowBox[{
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                 RowBox[{"newCompositionSymbol", "[", 
                  RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
             "morphismEquivalences"}], "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "imageQuiverObjectEquivalences", ",", 
                 "imageObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "imageArrowEquivalences", ",", "imageMorphismEquivalences"}], 
                "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"Normal", "[", 
             RowBox[{"Association", "[", 
              RowBox[{"DeleteDuplicates", "[", "imageMorphismList", "]"}], 
              "]"}], "]"}]}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"reducedFiberCategories", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"imageObject", "=", "#1"}], ",", "fiberObjects", ",", 
             "fiberMorphisms"}], "}"}], ",", 
           RowBox[{
            RowBox[{"fiberObjects", "=", 
             RowBox[{"{", "}"}]}], ";", 
            RowBox[{"fiberMorphisms", "=", 
             RowBox[{"{", "}"}]}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"domainObject", "=", "#1"}], ",", 
                   "equivalentObjects"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainObjectEquivalenceGraph", "]"}], 
                    ",", "domainObject"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"equivalentObjects", "=", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{
                    "domainObjectEquivalenceGraph", ",", "domainObject"}], 
                    "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageObjectEquivalenceGraph", "]"}], 
                    ",", 
                    RowBox[{"domainObject", "/.", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}], "]"}],
                     "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageObjectEquivalenceGraph", "]"}], 
                    ",", "imageObject"}], "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageObjectEquivalenceGraph", ",", 
                    RowBox[{"domainObject", "/.", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}], ",", 
                    "imageObject"}], "]"}], "]"}], ">", "0"}], ",", 
                    RowBox[{"fiberObjects", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{"fiberObjects", ",", "equivalentObjects"}], 
                    "]"}]}]}], "]"}]}], "]"}]}]}], "]"}]}], "]"}], "&"}], 
              ")"}], "/@", "objects"}], ";", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"domainMorphism", "=", "#1"}], ",", 
                   "equivalentMorphisms"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainMorphismEquivalenceGraph", 
                    "]"}], ",", "domainMorphism"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"equivalentMorphisms", "=", 
                    RowBox[{"VertexComponent", "[", 
                    RowBox[{
                    "domainMorphismEquivalenceGraph", ",", "domainMorphism"}],
                     "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"domainMorphism", "/.", 
                    RowBox[{"Normal", "[", "morphismFunction", "]"}]}]}], 
                    "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "VertexList", "[", "imageMorphismEquivalenceGraph", "]"}],
                     ",", 
                    RowBox[{"newIdentitySymbol", "[", "imageObject", "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"imageMorphismEquivalenceGraph", ",", 
                    RowBox[{"domainMorphism", "/.", 
                    RowBox[{"Normal", "[", "morphismFunction", "]"}]}], ",", 
                    RowBox[{"newIdentitySymbol", "[", "imageObject", "]"}]}], 
                    "]"}], "]"}], ">", "0"}], ",", 
                    RowBox[{"fiberMorphisms", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{"fiberMorphisms", ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Normal", "[", 
                    RowBox[{"Association", "[", 
                    RowBox[{
                    "DeleteDuplicates", "[", "domainMorphismList", "]"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"equivalentMorphisms", ",", 
                    RowBox[{"First", "[", "#1", "]"}]}], "]"}], "&"}]}], 
                    "]"}]}], "]"}]}]}], "]"}]}], "]"}]}]}], "]"}]}], "]"}], 
               "&"}], ")"}], "/@", 
             RowBox[{"First", "/@", 
              RowBox[{"Normal", "[", 
               RowBox[{"Association", "[", 
                RowBox[{"DeleteDuplicates", "[", "domainMorphismList", "]"}], 
                "]"}], "]"}]}]}], ";", 
            RowBox[{"reducedFiberCategories", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"reducedFiberCategories", ",", 
               RowBox[{"imageObject", "\[Rule]", 
                RowBox[{"AbstractCategory", "[", 
                 RowBox[{"Association", "[", 
                  RowBox[{
                   RowBox[{
                   "\"\<CompositionSymbol\>\"", "\[Rule]", 
                    "compositionSymbol"}], ",", 
                   RowBox[{
                   "\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
                   ",", 
                   RowBox[{
                   "\"\<MorphismEquivalences\>\"", "\[Rule]", 
                    "categoryMorphismEquivalences"}], ",", 
                   RowBox[{
                   "\"\<ObjectEquivalences\>\"", "\[Rule]", 
                    "categoryObjectEquivalences"}], ",", 
                   RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    "ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
                    "[", 
                    RowBox[{"Association", "[", 
                    RowBox[{
                    RowBox[{
                    "\"\<ArrowEquivalences\>\"", "\[Rule]", 
                    "arrowEquivalences"}], ",", 
                    RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
                    RowBox[{"Association", "[", 
                    RowBox[{"DeleteDuplicates", "[", "fiberMorphisms", "]"}], 
                    "]"}]}], ",", 
                    RowBox[{
                    "\"\<ObjectEquivalences\>\"", "\[Rule]", 
                    "quiverObjectEquivalences"}], ",", 
                    RowBox[{"\"\<Objects\>\"", "\[Rule]", "fiberObjects"}]}], 
                    "]"}], "]"}]}]}], "]"}], "]"}]}]}], "]"}]}]}]}], "]"}], 
         "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}], ",", 
           RowBox[{"quiverObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"categoryObjectEquivalences", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "objectEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "reducedFiberCategories", "]"}]}]}], "]"}], 
   "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
   3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
   3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
   3.869738945573786*^9, 3.8697391254637227`*^9}, 3.8697394735295734`*^9},
 CellLabel->
  "In[220]:=",ExpressionUUID->"b0625b82-57de-44ae-98b0-770fdb3a332f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<DiscreteFibrationQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageObjects", ",", "imageArrows", ",", 
       "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", ",", 
       "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageMorphismAssociation", ",", "imageCompositions", ",", 
       "objectFunction", ",", "objectListWithDuplicates", ",", 
       "arrowListWithDuplicates", ",", "domainMorphismList", ",", 
       "domainCompositionsList", ",", "imageMorphismList", ",", 
       "imageCompositionsList", ",", "morphismFunction", ",", 
       "isDiscreteFibration"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"covariant", "===", "True"}], ",", 
             RowBox[{"Normal", "[", "newArrows", "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
              RowBox[{"Normal", "[", "newArrows", "]"}]}]}], "]"}]}], "]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"categoryMorphismEquivalences", "/.", 
             RowBox[{
             "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
            RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"covariant", "===", "True"}], ",", "morphismEquivalences",
             ",", 
            RowBox[{"morphismEquivalences", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"Normal", "[", 
             RowBox[{"reduceArrowsFinal", "[", 
              RowBox[{
               RowBox[{"reduceArrowsInitial", "[", 
                RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], "]"}],
                ",", "imageQuiverObjectEquivalences"}], "]"}], "]"}], "]"}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"objectFunction", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Keys", "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
               RowBox[{"reduceObjects", "[", 
                RowBox[{
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}],
                  ",", "categoryObjectEquivalences"}], "]"}]}], "]"}], "]"}], 
            "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", 
               RowBox[{"Association", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{
                   RowBox[{"reduceObjects", "[", 
                    RowBox[{"objects", ",", "quiverObjectEquivalences"}], 
                    "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], 
                "]"}], "]"}], ",", "objectEquivalences"}], "]"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"reduceObjectsWithDuplicates", "[", 
               RowBox[{
                RowBox[{"Keys", "[", "objectMappings", "]"}], ",", 
                "quiverObjectEquivalences"}], "]"}], ",", 
              "categoryObjectEquivalences"}], "]"}], "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", "objectMappings", "]"}], ",", 
              "objectEquivalences"}], "]"}]}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"objectListWithDuplicates", "=", 
       RowBox[{"objects", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"arrowListWithDuplicates", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
         RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], ",", 
             "arrowEquivalences"}], "]"}], ",", "quiverObjectEquivalences"}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositionsList", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"domainMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "domainMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"domainMorphismList", ",", 
                 RowBox[{
                  RowBox[{"compositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositionsList"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjectsWithDuplicates", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"domainMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"domainMorphismList", ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", 
       RowBox[{"reduceObjectsWithDuplicates", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"domainMorphismList", "=", 
       RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
          RowBox[{"domainMorphismList", ",", "categoryMorphismEquivalences"}],
           "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
          RowBox[{
           RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
            RowBox[{"arrowListWithDuplicates", ",", 
             RowBox[{"arrowEquivalences", "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], "]"}], ",", 
           RowBox[{"quiverObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
           RowBox[{"Last", "[", 
            RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositionsList", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"imageMorphismList", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  "imageMorphismList"}], ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismList", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"imageMorphismList", ",", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                  "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositionsList"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjectsWithDuplicates", "[", 
          RowBox[{"objectListWithDuplicates", ",", 
           RowBox[{"quiverObjectEquivalences", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"imageMorphismList", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "[", "#1", "]"}], "/.", 
               RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
             "]"}], "]"}], "\[Equal]", 
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismList", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"imageMorphismList", ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}]}], "]"}], "&"}],
         ")"}], "/@", 
       RowBox[{"reduceObjectsWithDuplicates", "[", 
        RowBox[{"objectListWithDuplicates", ",", 
         RowBox[{"quiverObjectEquivalences", "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismList", "=", 
       RowBox[{"reduceArrowsFinalWithDuplicates", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitialWithDuplicates", "[", 
          RowBox[{"imageMorphismList", ",", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"categoryMorphismEquivalences", "/.", 
                 RowBox[{
                 "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
                RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"covariant", "===", "True"}], ",", 
                "morphismEquivalences", ",", 
                RowBox[{"morphismEquivalences", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"z", ",", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
                   
                   RowBox[{
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
             "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"categoryObjectEquivalences", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "objectEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"morphismFunction", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"First", "/@", "domainMorphismList"}], "\[Rule]", 
          RowBox[{"First", "/@", "imageMorphismList"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"isDiscreteFibration", "=", "True"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"object", "=", "#1"}], ",", "morphisms"}], "}"}], ",", 
           RowBox[{
            RowBox[{"morphisms", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"reduceArrowsFinal", "[", 
                 RowBox[{
                  RowBox[{"reduceArrowsInitial", "[", 
                   RowBox[{
                   "imageMorphismAssociation", ",", 
                    "imageMorphismEquivalences"}], "]"}], ",", 
                  "imageObjectEquivalences"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                 RowBox[{"(", 
                  RowBox[{"object", "/.", 
                   RowBox[{"Normal", "[", "objectFunction", "]"}]}], ")"}]}], 
                "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"morphism", "=", "#1"}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Normal", "[", 
                    RowBox[{"reduceArrowsFinal", "[", 
                    RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{
                    "domainMorphismAssociation", ",", 
                    "categoryMorphismEquivalences"}], "]"}], ",", 
                    "categoryObjectEquivalences"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    "object"}], "&"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "/.", 
                    RowBox[{"Normal", "[", "morphismFunction", "]"}]}], ")"}],
                     "===", 
                    RowBox[{"First", "[", "morphism", "]"}]}], "&"}]}], "]"}],
                     "]"}], "\[NotEqual]", "1"}], ",", 
                   RowBox[{"isDiscreteFibration", "=", "False"}]}], "]"}]}], 
                "]"}], "&"}], ")"}], "/@", "morphisms"}]}]}], "]"}], "&"}], 
        ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
         "categoryObjectEquivalences"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "isDiscreteFibration"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.869739139177472*^9}},
 CellLabel->
  "In[221]:=",ExpressionUUID->"0beb59f7-5f8e-41b8-babe-eb1ee94656ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<InclusionFunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageObjects", ",", "imageArrows", ",", 
       "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", ",", 
       "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageMorphismAssociation", ",", "imageCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"covariant", "===", "True"}], ",", 
             RowBox[{"Normal", "[", "newArrows", "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
              RowBox[{"Normal", "[", "newArrows", "]"}]}]}], "]"}]}], "]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"categoryMorphismEquivalences", "/.", 
             RowBox[{
             "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
            RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"covariant", "===", "True"}], ",", "morphismEquivalences",
             ",", 
            RowBox[{"morphismEquivalences", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], "]"}], 
             ",", "imageQuiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SubsetQ", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
            "]"}], ",", "imageObjectEquivalences"}], "]"}], ",", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
           "categoryObjectEquivalences"}], "]"}]}], "]"}], "&&", 
       RowBox[{"SubsetQ", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"reduceArrowsFinal", "[", 
           RowBox[{
            RowBox[{"reduceArrowsInitial", "[", 
             RowBox[{
             "imageMorphismAssociation", ",", "imageMorphismEquivalences"}], 
             "]"}], ",", "imageObjectEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{"Normal", "[", 
          RowBox[{"reduceArrowsFinal", "[", 
           RowBox[{
            RowBox[{"reduceArrowsInitial", "[", 
             RowBox[{
             "domainMorphismAssociation", ",", 
              "categoryMorphismEquivalences"}], "]"}], ",", 
            "categoryObjectEquivalences"}], "]"}], "]"}]}], "]"}]}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697391581064157`*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"b70125d4-d911-43a9-a0ca-7746908afbee"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<FullInclusionFunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageObjects", ",", "imageArrows", ",", 
       "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", ",", 
       "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageMorphismAssociation", ",", "imageCompositions", ",", 
       "reducedObjectMappings", ",", "objectPairs", ",", "isFullFunctor"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"reduceArrowsFinal", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitial", "[", 
          RowBox[{
          "domainMorphismAssociation", ",", "categoryMorphismEquivalences"}], 
          "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"covariant", "===", "True"}], ",", 
             RowBox[{"Normal", "[", "newArrows", "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
              RowBox[{"Normal", "[", "newArrows", "]"}]}]}], "]"}]}], "]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"categoryMorphismEquivalences", "/.", 
             RowBox[{
             "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
            RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"covariant", "===", "True"}], ",", "morphismEquivalences",
             ",", 
            RowBox[{"morphismEquivalences", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], "]"}], 
             ",", "imageQuiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"reduceArrowsFinal", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitial", "[", 
          RowBox[{
          "imageMorphismAssociation", ",", "imageMorphismEquivalences"}], 
          "]"}], ",", "imageObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"reducedObjectMappings", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Keys", "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
               RowBox[{"reduceObjects", "[", 
                RowBox[{
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}],
                  ",", "categoryObjectEquivalences"}], "]"}]}], "]"}], "]"}], 
            "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", 
               RowBox[{"Association", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{
                   RowBox[{"reduceObjects", "[", 
                    RowBox[{"objects", ",", "quiverObjectEquivalences"}], 
                    "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], 
                "]"}], "]"}], ",", "objectEquivalences"}], "]"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"reduceObjectsWithDuplicates", "[", 
               RowBox[{
                RowBox[{"Keys", "[", "objectMappings", "]"}], ",", 
                "quiverObjectEquivalences"}], "]"}], ",", 
              "categoryObjectEquivalences"}], "]"}], "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", "objectMappings", "]"}], ",", 
              "objectEquivalences"}], "]"}]}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"objectPairs", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
           "categoryObjectEquivalences"}], "]"}], ",", "2"}], "]"}]}], ";", 
      RowBox[{"isFullFunctor", "=", "True"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"objectPair", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"First", "[", "objectPair", "]"}]}], "&&", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"Last", "[", "objectPair", "]"}]}]}], "&"}]}], 
                "]"}], "]"}], "<", 
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], 
                    ")"}]}], "&&", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], 
                    ")"}]}]}], "&"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"isFullFunctor", "=", "False"}]}], "]"}]}], "]"}], "&"}],
         ")"}], "/@", "objectPairs"}], ";", "\[IndentingNewLine]", 
      RowBox[{"isFullFunctor", "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SubsetQ", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{
             RowBox[{"reduceObjects", "[", 
              RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
              "]"}], ",", "imageObjectEquivalences"}], "]"}], ",", 
           RowBox[{"reduceObjects", "[", 
            RowBox[{
             RowBox[{"reduceObjects", "[", 
              RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
             ",", "imageObjectEquivalences"}], "]"}]}], "]"}], "&&", 
         RowBox[{"SubsetQ", "[", 
          RowBox[{
           RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
           RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}], 
          "]"}]}], ")"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.869739163395461*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"d23b20de-4261-450a-9841-951206a22beb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<EmbeddingFunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "objectFunction", ",", "domainObjectEquivalenceGraph", ",", 
       "imageObjectEquivalenceGraph", ",", "objectPairs", ",", 
       "isInjectiveOnObjects", ",", "domainMorphismAssociation", ",", 
       "domainCompositions", ",", "imageObjects", ",", "imageArrows", ",", 
       "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", ",", 
       "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageMorphismAssociation", ",", "imageCompositions", ",", 
       "reducedObjectMappings", ",", "newObjectPairs", ",", 
       "isFaithfulFunctor"}], "}"}], ",", 
     RowBox[{
      RowBox[{"objectFunction", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", "objects"}],
           "]"}], ",", "objectMappings"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", 
                 "categoryObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"imageObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"quiverObjectEquivalences", "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{"DeleteDuplicates", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"categoryObjectEquivalences", "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                    "objectEquivalences"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectPairs", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"isInjectiveOnObjects", "=", "True"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"objectPair", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                "VertexList", "[", "imageObjectEquivalenceGraph", "]"}], ",", 
                
                RowBox[{"First", "[", "objectPair", "]"}]}], "]"}], "&&", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                "VertexList", "[", "imageObjectEquivalenceGraph", "]"}], ",", 
                
                RowBox[{"Last", "[", "objectPair", "]"}]}], "]"}]}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"FindShortestPath", "[", 
                  RowBox[{"imageObjectEquivalenceGraph", ",", 
                   RowBox[{"First", "[", "objectPair", "]"}], ",", 
                   RowBox[{"Last", "[", "objectPair", "]"}]}], "]"}], "]"}], 
                ">", "0"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainObjectEquivalenceGraph", "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                   "]"}], "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainObjectEquivalenceGraph", "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                    "]"}], "]"}], "\[Equal]", "0"}], ",", 
                   RowBox[{"isInjectiveOnObjects", "=", "False"}]}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "/@", 
       "objectPairs"}], ";", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"reduceArrowsFinal", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitial", "[", 
          RowBox[{
          "domainMorphismAssociation", ",", "categoryMorphismEquivalences"}], 
          "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"covariant", "===", "True"}], ",", 
             RowBox[{"Normal", "[", "newArrows", "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
              RowBox[{"Normal", "[", "newArrows", "]"}]}]}], "]"}]}], "]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"categoryMorphismEquivalences", "/.", 
             RowBox[{
             "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
            RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"covariant", "===", "True"}], ",", "morphismEquivalences",
             ",", 
            RowBox[{"morphismEquivalences", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "z"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], "]"}], 
             ",", "imageQuiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"reduceArrowsFinal", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitial", "[", 
          RowBox[{
          "imageMorphismAssociation", ",", "imageMorphismEquivalences"}], 
          "]"}], ",", "imageObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"reducedObjectMappings", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Keys", "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
               RowBox[{"reduceObjects", "[", 
                RowBox[{
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}],
                  ",", "categoryObjectEquivalences"}], "]"}]}], "]"}], "]"}], 
            "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", 
               RowBox[{"Association", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{
                   RowBox[{"reduceObjects", "[", 
                    RowBox[{"objects", ",", "quiverObjectEquivalences"}], 
                    "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], 
                "]"}], "]"}], ",", "objectEquivalences"}], "]"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"reduceObjectsWithDuplicates", "[", 
               RowBox[{
                RowBox[{"Keys", "[", "objectMappings", "]"}], ",", 
                "quiverObjectEquivalences"}], "]"}], ",", 
              "categoryObjectEquivalences"}], "]"}], "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", "objectMappings", "]"}], ",", 
              "objectEquivalences"}], "]"}]}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"newObjectPairs", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
           "categoryObjectEquivalences"}], "]"}], ",", "2"}], "]"}]}], ";", 
      RowBox[{"isFaithfulFunctor", "=", "True"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"objectPair", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"First", "[", "objectPair", "]"}]}], "&&", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"Last", "[", "objectPair", "]"}]}]}], "&"}]}], 
                "]"}], "]"}], ">", 
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], 
                    ")"}]}], "&&", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], 
                    ")"}]}]}], "&"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"isFaithfulFunctor", "=", "False"}]}], "]"}]}], "]"}], 
         "&"}], ")"}], "/@", "newObjectPairs"}], ";", "\[IndentingNewLine]", 
      RowBox[{"isInjectiveOnObjects", "&&", "isFaithfulFunctor"}]}]}], "]"}], 
   "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.869739170175997*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"43dc5aea-094d-4842-a643-d9fcf1916de7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<FullEmbeddingFunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "objectFunction", ",", "domainObjectEquivalenceGraph", ",", 
       "imageObjectEquivalenceGraph", ",", "objectPairs", ",", 
       "isInjectiveOnObjects", ",", "domainMorphismAssociation", ",", 
       "domainCompositions", ",", "imageObjects", ",", "imageArrows", ",", 
       "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", ",", 
       "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageMorphismAssociation", ",", "imageCompositions", ",", 
       "reducedObjectMappings", ",", "newObjectPairs", ",", 
       "isFullyFaithfulFunctor"}], "}"}], ",", 
     RowBox[{
      RowBox[{"objectFunction", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", "objects"}],
           "]"}], ",", "objectMappings"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                "quiverObjectEquivalences", ",", 
                 "categoryObjectEquivalences"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           "objects"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"imageObjectEquivalenceGraph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EdgeList", "[", 
           RowBox[{"TransitiveClosureGraph", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"Apply", "[", 
              RowBox[{"UndirectedEdge", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"quiverObjectEquivalences", "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{"DeleteDuplicates", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"categoryObjectEquivalences", "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                    "objectEquivalences"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{"#1", ",", "#1"}], "]"}], "&"}], ")"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"objects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"objectPairs", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"isInjectiveOnObjects", "=", "True"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"objectPair", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                "VertexList", "[", "imageObjectEquivalenceGraph", "]"}], ",", 
                
                RowBox[{"First", "[", "objectPair", "]"}]}], "]"}], "&&", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                "VertexList", "[", "imageObjectEquivalenceGraph", "]"}], ",", 
                
                RowBox[{"Last", "[", "objectPair", "]"}]}], "]"}]}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"FindShortestPath", "[", 
                  RowBox[{"imageObjectEquivalenceGraph", ",", 
                   RowBox[{"First", "[", "objectPair", "]"}], ",", 
                   RowBox[{"Last", "[", "objectPair", "]"}]}], "]"}], "]"}], 
                ">", "0"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainObjectEquivalenceGraph", "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                   "]"}], "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "VertexList", "[", "domainObjectEquivalenceGraph", "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                   "]"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"FindShortestPath", "[", 
                    RowBox[{"domainObjectEquivalenceGraph", ",", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Reverse", "/@", 
                    RowBox[{"Normal", "[", "objectFunction", "]"}]}]}]}], 
                    "]"}], "]"}], "\[Equal]", "0"}], ",", 
                   RowBox[{"isInjectiveOnObjects", "=", "False"}]}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}]}], "]"}], "&"}], ")"}], "/@", 
       "objectPairs"}], ";", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"reduceArrowsFinal", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitial", "[", 
          RowBox[{
          "domainMorphismAssociation", ",", "categoryMorphismEquivalences"}], 
          "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"covariant", "===", "True"}], ",", 
             RowBox[{"Normal", "[", "newArrows", "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
              RowBox[{"Normal", "[", "newArrows", "]"}]}]}], "]"}]}], "]"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"categoryMorphismEquivalences", "/.", 
             RowBox[{
             "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
            RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"covariant", "===", "True"}], ",", "morphismEquivalences",
             ",", 
            RowBox[{"morphismEquivalences", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
         "]"}], "]"}]}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], "]"}], 
             ",", "imageQuiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"reduceArrowsFinal", "[", 
        RowBox[{
         RowBox[{"reduceArrowsInitial", "[", 
          RowBox[{
          "imageMorphismAssociation", ",", "imageMorphismEquivalences"}], 
          "]"}], ",", "imageObjectEquivalences"}], "]"}]}], ";", 
      RowBox[{"reducedObjectMappings", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Keys", "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
               RowBox[{"reduceObjects", "[", 
                RowBox[{
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}],
                  ",", "categoryObjectEquivalences"}], "]"}]}], "]"}], "]"}], 
            "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", 
               RowBox[{"Association", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#1", "\[Rule]", "#1"}], "&"}], ")"}], "/@", 
                 RowBox[{"reduceObjects", "[", 
                  RowBox[{
                   RowBox[{"reduceObjects", "[", 
                    RowBox[{"objects", ",", "quiverObjectEquivalences"}], 
                    "]"}], ",", "categoryObjectEquivalences"}], "]"}]}], 
                "]"}], "]"}], ",", "objectEquivalences"}], "]"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"Association", "[", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"reduceObjectsWithDuplicates", "[", 
               RowBox[{
                RowBox[{"Keys", "[", "objectMappings", "]"}], ",", 
                "quiverObjectEquivalences"}], "]"}], ",", 
              "categoryObjectEquivalences"}], "]"}], "\[Rule]", 
            RowBox[{"reduceObjectsWithDuplicates", "[", 
             RowBox[{
              RowBox[{"Values", "[", "objectMappings", "]"}], ",", 
              "objectEquivalences"}], "]"}]}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"newObjectPairs", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
           "categoryObjectEquivalences"}], "]"}], ",", "2"}], "]"}]}], ";", 
      RowBox[{"isFullyFaithfulFunctor", "=", "True"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"objectPair", "=", "#1"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"First", "[", "objectPair", "]"}]}], "&&", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"Last", "[", "objectPair", "]"}]}]}], "&"}]}], 
                "]"}], "]"}], "\[NotEqual]", 
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], 
                    ")"}]}], "&&", 
                   RowBox[{
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "[", "objectPair", "]"}], "/.", 
                    RowBox[{"Normal", "[", "reducedObjectMappings", "]"}]}], 
                    ")"}]}]}], "&"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"isFullyFaithfulFunctor", "=", "False"}]}], "]"}]}], 
          "]"}], "&"}], ")"}], "/@", "newObjectPairs"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"isInjectiveOnObjects", "&&", "isFullyFaithfulFunctor"}]}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697391806744084`*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"0603920b-9b55-4a12-b578-1f60774f9224"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<SwapVariance\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", "False", ",", "True"}], 
        "]"}]}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"morphismEquivalences", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"newCompositionSymbol", "[", 
             RowBox[{"x_", ",", 
              RowBox[{"newCompositionSymbol", "[", 
               RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], "\[RuleDelayed]", 
            RowBox[{"newCompositionSymbol", "[", 
             RowBox[{"z", ",", 
              RowBox[{"newCompositionSymbol", "[", 
               RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"newCompositionSymbol", "[", 
             RowBox[{
              RowBox[{"newCompositionSymbol", "[", 
               RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"newCompositionSymbol", "[", 
             RowBox[{
              RowBox[{"newCompositionSymbol", "[", 
               RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"newCompositionSymbol", "[", 
             RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"newCompositionSymbol", "[", 
             RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ")"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
   3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
   3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
   3.869738945573786*^9, 3.869739187663907*^9}, 3.8697394735451937`*^9},
 CellLabel->
  "In[226]:=",ExpressionUUID->"e79d3665-11b5-45ce-9cc8-5712ffc01797"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<CovariantFunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"covariant", "===", "True"}], ",", "True", ",", "False"}], "]"}],
    "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.869739202969207*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"6ce64539-e6b8-4b31-9faf-2f4913b26167"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ContravariantFunctorQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"covariant", "===", "True"}], ",", "False", ",", "True"}], "]"}],
    "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<FullLabeledGraph\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageMorphismAssociation", ",", "imageCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                   ")"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EdgeTaggedGraph", "[", 
        RowBox[{"objects", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Labeled", "[", 
             RowBox[{
              RowBox[{"DirectedEdge", "@@", 
               RowBox[{"Last", "[", "#1", "]"}]}], ",", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], ",", "0.5"}], "]"}]}], 
             "]"}], "&"}], ")"}], "/@", 
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}], ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Transparent", ",", 
            RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
         RowBox[{"VertexLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"GraphLayout", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
            RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
        "]"}], "\[Rule]", 
       RowBox[{"EdgeTaggedGraph", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Labeled", "[", 
             RowBox[{
              RowBox[{"DirectedEdge", "@@", 
               RowBox[{"Last", "[", "#1", "]"}]}], ",", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], ",", "0.5"}], "]"}]}], 
             "]"}], "&"}], ")"}], "/@", 
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Transparent", ",", 
            RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
         RowBox[{"VertexLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"GraphLayout", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
            RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
        "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697392092512813`*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"51d03892-cccb-4a39-8a22-e003cc326f00"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<FullUnlabeledGraph\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageMorphismAssociation", ",", "imageCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                   ")"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EdgeTaggedGraph", "[", 
        RowBox[{"objects", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"DirectedEdge", "@@", 
             RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}], ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Transparent", ",", 
            RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
         RowBox[{"VertexLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"GraphLayout", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
            RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
        "]"}], "\[Rule]", 
       RowBox[{"EdgeTaggedGraph", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"DirectedEdge", "@@", 
             RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Transparent", ",", 
            RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
         RowBox[{"VertexLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"GraphLayout", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
            RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
        "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.869739217094249*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"1f010519-90df-4aed-b9c6-3ca19931dff0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ReducedLabeledGraph\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "self", "}"}], ",", 
     RowBox[{
      RowBox[{"self", "=", 
       RowBox[{"AbstractFunctor", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
          
          RowBox[{"\"\<Category\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractCategory", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], 
              ",", 
              RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}],
               ",", 
              RowBox[{
              "\"\<MorphismEquivalences\>\"", "\[Rule]", 
               "categoryMorphismEquivalences"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "categoryObjectEquivalences"}], ",", 
              RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
               RowBox[{
                RowBox[{"(", "abstractQuiver", ")"}], "[", 
                RowBox[{"Association", "[", 
                 RowBox[{
                  RowBox[{
                  "\"\<ArrowEquivalences\>\"", "\[Rule]", 
                   "arrowEquivalences"}], ",", 
                  RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
                  RowBox[{
                  "\"\<ObjectEquivalences\>\"", "\[Rule]", 
                   "quiverObjectEquivalences"}], ",", 
                  RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
                "]"}]}]}], "]"}], "]"}]}], ",", 
          RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}],
           ",", 
          RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
          RowBox[{
          "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}],
           ",", 
          RowBox[{
          "\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], ",", 
          
          RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}], 
          ",", 
          RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"self", "[", "\"\<DomainCategory\>\"", "]"}], "[", 
        "\"\<ReducedLabeledGraph\>\"", "]"}], "->", 
       RowBox[{
        RowBox[{"self", "[", "\"\<CodomainCategory\>\"", "]"}], "[", 
        "\"\<ReducedLabeledGraph\>\"", "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697392301109705`*^9}, {3.871437484046646*^9, 
  3.871437690825536*^9}, {3.871437722011735*^9, 3.871437872908115*^9}},
 CellLabel->
  "In[365]:=",ExpressionUUID->"ac63ece8-ce1c-450f-b5af-f8b6a7e47e0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ReducedUnlabeledGraph\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageObjects", ",", "imageArrows", ",", 
       "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", ",", 
       "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageMorphismAssociation", ",", "imageCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], "]"}]}],
       ";", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"categoryMorphismEquivalences", "/.", 
               RowBox[{
               "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"categoryMorphismEquivalences", "/.", 
                RowBox[{
                "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"reduceArrowsFinal", "[", 
                   RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], 
                    "]"}], ",", "imageQuiverObjectEquivalences"}], "]"}], 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", 
                   RowBox[{"reduceArrowsFinal", "[", 
                    RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], 
                    "]"}], ",", "imageQuiverObjectEquivalences"}], "]"}], 
                   "]"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EdgeTaggedGraph", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
           "categoryObjectEquivalences"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"DirectedEdge", "@@", 
             RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{
              "domainMorphismAssociation", ",", 
               "categoryMorphismEquivalences"}], "]"}], ",", 
             "categoryObjectEquivalences"}], "]"}], "]"}]}], ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Transparent", ",", 
            RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
         RowBox[{"VertexLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"GraphLayout", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
            RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
        "]"}], "\[Rule]", 
       RowBox[{"EdgeTaggedGraph", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
            "]"}], ",", "imageObjectEquivalences"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"DirectedEdge", "@@", 
             RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{
              "imageMorphismAssociation", ",", "imageMorphismEquivalences"}], 
              "]"}], ",", "imageObjectEquivalences"}], "]"}], "]"}]}], ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Transparent", ",", 
            RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
         RowBox[{"VertexLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"GraphLayout", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
            RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
        "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.869739237915484*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"0e30ff79-b996-423d-bf2c-8969fc4f5dde"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<SimpleLabeledGraph\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageMorphismAssociation", ",", "imageCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                   ")"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EdgeTaggedGraph", "[", 
        RowBox[{"objects", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Labeled", "[", 
             RowBox[{
              RowBox[{"DirectedEdge", "@@", 
               RowBox[{"Last", "[", "#1", "]"}]}], ",", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], ",", "0.5"}], "]"}]}], 
             "]"}], "&"}], ")"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"DeleteDuplicatesBy", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"DirectedEdge", "@@", 
                RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], 
         ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Transparent", ",", 
            RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
         RowBox[{"VertexLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"GraphLayout", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
            RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
        "]"}], "\[Rule]", 
       RowBox[{"EdgeTaggedGraph", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Labeled", "[", 
             RowBox[{
              RowBox[{"DirectedEdge", "@@", 
               RowBox[{"Last", "[", "#1", "]"}]}], ",", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], ",", "0.5"}], "]"}]}], 
             "]"}], "&"}], ")"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"DeleteDuplicatesBy", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"DirectedEdge", "@@", 
                RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], 
         ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Transparent", ",", 
            RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
         RowBox[{"VertexLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"GraphLayout", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
            RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
        "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697392438947015`*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"b876dfa3-97d5-4db7-b7bb-16a0fddbd442"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<SimpleUnlabeledGraph\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageMorphismAssociation", ",", "imageCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                   ")"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EdgeTaggedGraph", "[", 
        RowBox[{"objects", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"DirectedEdge", "@@", 
             RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"DeleteDuplicatesBy", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"DirectedEdge", "@@", 
                RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], 
         ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Transparent", ",", 
            RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
         RowBox[{"VertexLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"GraphLayout", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
            RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
        "]"}], "\[Rule]", 
       RowBox[{"EdgeTaggedGraph", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"DirectedEdge", "@@", 
             RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"DeleteDuplicatesBy", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"DirectedEdge", "@@", 
                RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}]}], 
         ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Transparent", ",", 
            RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
         RowBox[{"VertexLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"GraphLayout", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
            RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
        "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697392516627493`*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"a6fca516-07d5-43df-b636-0b5d195e77a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ReducedSimpleLabeledGraph\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageObjects", ",", "imageArrows", ",", 
       "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", ",", 
       "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageMorphismAssociation", ",", "imageCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], "]"}]}],
       ";", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"categoryMorphismEquivalences", "/.", 
               RowBox[{
               "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"categoryMorphismEquivalences", "/.", 
                RowBox[{
                "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"reduceArrowsFinal", "[", 
                   RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], 
                    "]"}], ",", "imageQuiverObjectEquivalences"}], "]"}], 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", 
                   RowBox[{"reduceArrowsFinal", "[", 
                    RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], 
                    "]"}], ",", "imageQuiverObjectEquivalences"}], "]"}], 
                   "]"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EdgeTaggedGraph", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
           "categoryObjectEquivalences"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Labeled", "[", 
             RowBox[{
              RowBox[{"DirectedEdge", "@@", 
               RowBox[{"Last", "[", "#1", "]"}]}], ",", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], ",", "0.5"}], "]"}]}], 
             "]"}], "&"}], ")"}], "/@", 
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{
               RowBox[{"Association", "[", 
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"DeleteDuplicatesBy", "[", 
                   RowBox[{
                    RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"DirectedEdge", "@@", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}],
                 "]"}], ",", "categoryMorphismEquivalences"}], "]"}], ",", 
             "categoryObjectEquivalences"}], "]"}], "]"}]}], ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Transparent", ",", 
            RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
         RowBox[{"VertexLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"GraphLayout", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
            RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
        "]"}], "\[Rule]", 
       RowBox[{"EdgeTaggedGraph", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
            "]"}], ",", "imageObjectEquivalences"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Labeled", "[", 
             RowBox[{
              RowBox[{"DirectedEdge", "@@", 
               RowBox[{"Last", "[", "#1", "]"}]}], ",", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], ",", "0.5"}], "]"}]}], 
             "]"}], "&"}], ")"}], "/@", 
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{
               RowBox[{"Association", "[", 
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"DeleteDuplicatesBy", "[", 
                   RowBox[{
                    RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"DirectedEdge", "@@", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}],
                 "]"}], ",", "imageMorphismEquivalences"}], "]"}], ",", 
             "imageObjectEquivalences"}], "]"}], "]"}]}], ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Transparent", ",", 
            RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
         RowBox[{"VertexLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"GraphLayout", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
            RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
        "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.869739259061327*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"c28cabe4-22c2-4ad3-97da-c39b3eb1a8c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<ReducedSimpleUnlabeledGraph\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageObjects", ",", "imageArrows", ",", 
       "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", ",", 
       "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "imageMorphismAssociation", ",", "imageCompositions"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], "]"}]}],
       ";", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"categoryMorphismEquivalences", "/.", 
               RowBox[{
               "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"categoryMorphismEquivalences", "/.", 
                RowBox[{
                "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"reduceArrowsFinal", "[", 
                   RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], 
                    "]"}], ",", "imageQuiverObjectEquivalences"}], "]"}], 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", 
                   RowBox[{"reduceArrowsFinal", "[", 
                    RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], 
                    "]"}], ",", "imageQuiverObjectEquivalences"}], "]"}], 
                   "]"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EdgeTaggedGraph", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
           "categoryObjectEquivalences"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"DirectedEdge", "@@", 
             RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{
               RowBox[{"Association", "[", 
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"DeleteDuplicatesBy", "[", 
                   RowBox[{
                    RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}],
                     ",", 
                    RowBox[{
                    RowBox[{"DirectedEdge", "@@", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}],
                 "]"}], ",", "categoryMorphismEquivalences"}], "]"}], ",", 
             "categoryObjectEquivalences"}], "]"}], "]"}]}], ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Transparent", ",", 
            RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
         RowBox[{"VertexLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"GraphLayout", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
            RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
        "]"}], "\[Rule]", 
       RowBox[{"EdgeTaggedGraph", "[", 
        RowBox[{
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
            "]"}], ",", "imageObjectEquivalences"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"DirectedEdge", "@@", 
             RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{
               RowBox[{"Association", "[", 
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"DeleteDuplicatesBy", "[", 
                   RowBox[{
                    RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"DirectedEdge", "@@", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}],
                 "]"}], ",", "imageMorphismEquivalences"}], "]"}], ",", 
             "imageObjectEquivalences"}], "]"}], "]"}]}], ",", 
         RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Transparent", ",", 
            RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", 
         RowBox[{"VertexLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeLabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Bold", ",", "20"}], "]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"GraphLayout", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
            RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}], 
        "]"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697392748510923`*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"4775ceeb-97f5-4bc8-8332-eb16227e51e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      "\n", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<AssociationForm\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
     RowBox[{"\"\<Category\>\"", "\[Rule]", 
      RowBox[{"AbstractCategory", "[", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{
         "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
         RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
         RowBox[{
         "\"\<MorphismEquivalences\>\"", "\[Rule]", 
          "categoryMorphismEquivalences"}], ",", 
         RowBox[{
         "\"\<ObjectEquivalences\>\"", "\[Rule]", 
          "categoryObjectEquivalences"}], ",", 
         RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
          RowBox[{
           RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
           "[", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{
             "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
             ",", 
             RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
             RowBox[{
             "\"\<ObjectEquivalences\>\"", "\[Rule]", 
              "quiverObjectEquivalences"}], ",", 
             RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
           "]"}]}]}], "]"}], "]"}]}], ",", 
     RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}], ",", 
     RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
     RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
     RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
     RowBox[{
     "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], ",", 
     RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], 
     ",", 
     RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}], 
     ",", 
     RowBox[{
     "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}]}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
   3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
   3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
   3.869738945573786*^9, 3.869739283352889*^9}, 3.869739473576359*^9},
 CellLabel->
  "In[237]:=",ExpressionUUID->"f2e43dc8-9c6e-4dc0-a7a5-6c9eb43cda95"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", "\"\<Properties\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\"\<ObjectCount\>\"", ",", "\"\<MorphismCount\>\"", ",", 
     "\"\<ObjectEquivalences\>\"", ",", "\"\<ObjectEquivalenceCount\>\"", 
     ",", "\"\<MorphismEquivalences\>\"", ",", 
     "\"\<MorphismEquivalenceCount\>\"", ",", "\"\<ReducedObjectCount\>\"", 
     ",", "\"\<ReducedMorphismCount\>\"", ",", "\"\<CompositionSymbol\>\"", 
     ",", "\"\<IdentitySymbol\>\"", ",", "\"\<NewObjects\>\"", ",", 
     "\"\<NewObjectCount\>\"", ",", "\"\<ReducedNewObjects\>\"", ",", 
     "\"\<ReducedNewObjectCount\>\"", ",", "\"\<NewArrows\>\"", ",", 
     "\"\<NewArrowCount\>\"", ",", "\"\<NewMorphisms\>\"", ",", 
     "\"\<NewMorphismCount\>\"", ",", "\"\<ReducedNewMorphisms\>\"", ",", 
     "\"\<ReducedNewMorphismCount\>\"", ",", "\"\<ObjectMappings\>\"", ",", 
     "\"\<ObjectMappingCount\>\"", ",", "\"\<ReducedObjectMappings\>\"", ",", 
     "\"\<ReducedObjectMappingCount\>\"", ",", "\"\<ArrowMappings\>\"", ",", 
     "\"\<ArrowMappingCount\>\"", ",", "\"\<MorphismMappings\>\"", ",", 
     "\"\<MorphismMappingCount\>\"", ",", "\"\<ReducedMorphismMappings\>\"", 
     ",", "\"\<ReducedMorphismMappingCount\>\"", ",", 
     "\"\<DomainCategory\>\"", ",", "\"\<CodomainCategory\>\"", ",", 
     "\"\<EndofunctorQ\>\"", ",", "\"\<IdentityFunctorQ\>\"", ",", 
     "\"\<ConstantFunctorQ\>\"", ",", "\"\<FullFunctorQ\>\"", ",", 
     "\"\<FaithfulFunctorQ\>\"", ",", "\"\<FullyFaithfulFunctorQ\>\"", ",", 
     "\"\<InjectiveOnObjectsQ\>\"", ",", 
     "\"\<EssentiallyInjectiveFunctorQ\>\"", ",", 
     "\"\<SurjectiveOnObjectsQ\>\"", ",", 
     "\"\<EssentiallySurjectiveFunctorQ\>\"", ",", 
     "\"\<BijectiveOnObjectsQ\>\"", ",", 
     "\"\<EssentiallyBijectiveFunctorQ\>\"", ",", 
     "\"\<ConservativeFunctorQ\>\"", ",", "\"\<EquivalenceFunctorQ\>\"", ",", 
     "\"\<FiberCategories\>\"", ",", "\"\<ReducedFiberCategories\>\"", ",", 
     "\"\<DiscreteFibrationQ\>\"", ",", "\"\<InclusionFunctorQ\>\"", ",", 
     "\"\<FullInclusionFunctorQ\>\"", ",", "\"\<EmbeddingFunctorQ\>\"", ",", 
     "\"\<FullEmbeddingFunctorQ\>\"", ",", "\"\<SwapVariance\>\"", ",", 
     "\"\<CovariantFunctorQ\>\"", ",", "\"\<ContravariantFunctorQ\>\"", ",", 
     "\"\<FullLabeledGraph\>\"", ",", "\"\<FullUnlabeledGraph\>\"", ",", 
     "\"\<ReducedLabeledGraph\>\"", ",", "\"\<ReducedUnlabeledGraph\>\"", 
     ",", "\"\<SimpleLabeledGraph\>\"", ",", "\"\<SimpleUnlabeledGraph\>\"", 
     ",", "\"\<ReducedSimpleLabeledGraph\>\"", ",", 
     "\"\<ReducedSimpleUnlabeledGraph\>\"", ",", "\"\<AssociationForm\>\"", 
     ",", "\"\<Properties\>\""}], "}"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.869739288837407*^9}},
 CellLabel->
  "In[238]:=",ExpressionUUID->"fac9bdfb-945d-417a-9af0-b6c3cac7489b"],

Cell[BoxData[
 RowBox[{"AbstractFunctor", "/:", 
  RowBox[{"MakeBoxes", "[", 
   RowBox[{
    RowBox[{"abstractFunctor", ":", 
     RowBox[{"AbstractFunctor", "[", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{
        "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], 
        ",", 
        RowBox[{"\"\<Category\>\"", "\[Rule]", 
         RowBox[{
          RowBox[{"(", "abstractCategory_", ")"}], "[", 
          RowBox[{"Association", "[", 
           RowBox[{
            RowBox[{
            "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
            ",", 
            RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
            ",", 
            RowBox[{
            "\"\<MorphismEquivalences\>\"", "\[Rule]", 
             "categoryMorphismEquivalences_List"}], ",", 
            RowBox[{
            "\"\<ObjectEquivalences\>\"", "\[Rule]", 
             "categoryObjectEquivalences_List"}], ",", 
            RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
             RowBox[{
              RowBox[{"(", "abstractQuiver_", ")"}], "[", 
              RowBox[{"Association", "[", 
               RowBox[{
                RowBox[{
                "\"\<ArrowEquivalences\>\"", "\[Rule]", 
                 "arrowEquivalences_List"}], ",", 
                RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
                ",", 
                RowBox[{
                "\"\<ObjectEquivalences\>\"", "\[Rule]", 
                 "quiverObjectEquivalences_List"}], ",", 
                RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], 
               "]"}], "]"}]}]}], "]"}], "]"}]}], ",", 
        RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
        RowBox[{
        "\"\<MorphismEquivalences\>\"", "\[Rule]", 
         "morphismEquivalences_List"}], ",", 
        RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], 
        ",", 
        RowBox[{
        "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
        ",", 
        RowBox[{
        "\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], ",", 
        RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
        RowBox[{
        "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
        ",", 
        RowBox[{
        "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}],
        "]"}], "]"}]}], ",", "format_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "domainMorphismAssociation", ",", "domainCompositions", ",", 
       "imageMorphismAssociation", ",", "imageCompositions", ",", 
       "reducedDomainMorphismAssociation", ",", "reducedDomainCompositions", 
       ",", "imageObjects", ",", "imageArrows", ",", 
       "imageQuiverObjectEquivalences", ",", "imageObjectEquivalences", ",", 
       "imageArrowEquivalences", ",", "imageMorphismEquivalences", ",", 
       "reducedImageMorphismAssociation", ",", "reducedImageCompositions", 
       ",", "icon", ",", "type", ",", "objectCount", ",", "morphismCount", 
       ",", "reducedObjectCount", ",", "reducedMorphismCount"}], "}"}], ",", 
     RowBox[{
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "arrows", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"domainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}],
                  ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"domainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "domainCompositions"}]}], ",", 
        RowBox[{"Length", "[", "objects", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
              
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"domainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", "objects"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"covariant", "===", "True"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                  RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                 RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                   RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                  ")"}]}]}], "]"}], ",", 
              RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"imageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"imageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "imageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"objects", "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           "newObjects"}], "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"imageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"imageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"objects", "/.", 
          RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
         "newObjects"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedDomainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"reduceArrowsFinal", "[", 
            RowBox[{
             RowBox[{"reduceArrowsInitial", "[", 
              RowBox[{"arrows", ",", "arrowEquivalences"}], "]"}], ",", 
             "quiverObjectEquivalences"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedDomainCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{
              "Normal", "[", "reducedDomainMorphismAssociation", "]"}], ",", 
              "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedDomainMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedDomainMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{
                  "Normal", "[", "reducedDomainMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"compositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedDomainCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], 
         "]"}]}], "]"}], ";", 
      RowBox[{"reducedDomainMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedDomainMorphismAssociation", "]"}], 
          ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"compositionSymbol", "\[Rule]", "List"}]}], "}"}], 
               "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{
              "Normal", "[", "reducedDomainMorphismAssociation", "]"}], ",", 
              RowBox[{
               RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedDomainMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{
               "Normal", "[", "reducedDomainMorphismAssociation", "]"}], ",", 
               
               RowBox[{
                RowBox[{"identitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjects", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"objects", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "newObjects"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageArrows", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "[", "arrows", "]"}], "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
            RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
           RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], "]"}]}],
       ";", 
      RowBox[{"imageQuiverObjectEquivalences", "=", 
       RowBox[{"quiverObjectEquivalences", "/.", 
        RowBox[{"Normal", "[", "objectMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageObjectEquivalences", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"categoryObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ";", 
      RowBox[{"imageArrowEquivalences", "=", 
       RowBox[{"arrowEquivalences", "/.", 
        RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageMorphismEquivalences", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"categoryMorphismEquivalences", "/.", 
               RowBox[{
               "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"categoryMorphismEquivalences", "/.", 
                RowBox[{
                "compositionSymbol", "\[Rule]", "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"reducedImageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"reduceArrowsFinal", "[", 
                   RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], 
                    "]"}], ",", "imageQuiverObjectEquivalences"}], "]"}], 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                   RowBox[{"Normal", "[", 
                    RowBox[{"reduceArrowsFinal", "[", 
                    RowBox[{
                    RowBox[{"reduceArrowsInitial", "[", 
                    RowBox[{"imageArrows", ",", "imageArrowEquivalences"}], 
                    "]"}], ",", "imageQuiverObjectEquivalences"}], "]"}], 
                    "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "arrowMappings", "]"}]}]}], "]"}], 
               ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}], "=!=", 
            RowBox[{"Last", "[", 
             RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"reducedImageCompositions", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedImageMorphismAssociation", "]"}],
               ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], "===", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", 
                RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                    RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{
                  "Normal", "[", "reducedImageMorphismAssociation", "]"}]}], 
                 ",", 
                 RowBox[{
                  RowBox[{"StringDelete", "[", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", "\"\<)\>\"", ",", "\"\< \>\""}],
                     "}"}]}], "]"}], "\[Rule]", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                   "]"}]}]}], "]"}]}], ",", 
              RowBox[{"reducedImageMorphismAssociation", "=", 
               RowBox[{"Association", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{
                  "Normal", "[", "reducedImageMorphismAssociation", "]"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"newCompositionSymbol", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], ",", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}]}], "]"}], 
                   "\[Rule]", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"First", "[", "#1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}], "]"}]}], 
                    "]"}]}]}], "]"}], "]"}]}]}], "]"}], "&"}], ")"}], "/@", 
          "reducedImageCompositions"}]}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
          "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"reducedImageMorphismAssociation", "=", 
       RowBox[{"Association", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Normal", "[", "reducedImageMorphismAssociation", "]"}], 
          ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#1", "]"}], "/.", 
                RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}], 
              "]"}], "]"}], "\[Equal]", 
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#1", "]"}], "/.", 
                 RowBox[{"newCompositionSymbol", "\[Rule]", "List"}]}], "}"}],
                "]"}], "]"}], "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Normal", "[", "reducedImageMorphismAssociation", "]"}],
               ",", 
              RowBox[{
               RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"reducedImageMorphismAssociation", "=", 
            RowBox[{"Association", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{
               "Normal", "[", "reducedImageMorphismAssociation", "]"}], ",", 
               RowBox[{
                RowBox[{"newIdentitySymbol", "[", "#1", "]"}], "\[Rule]", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"#1", ",", "#1"}], "]"}]}]}], "]"}], "]"}]}]}], 
          "]"}], "&"}], ")"}], "/@", 
       RowBox[{"reduceObjects", "[", 
        RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
        "]"}]}], ";", 
      RowBox[{"icon", "=", 
       RowBox[{
        RowBox[{"GraphPlot", "[", 
         RowBox[{"EdgeTaggedGraph", "[", 
          RowBox[{"objects", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DirectedEdge", "@@", 
               RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
            RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}]}], ",", 
           
           RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
           RowBox[{"VertexStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Transparent", ",", 
              RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
           RowBox[{"EdgeShapeFunction", "\[Rule]", 
            RowBox[{"GraphElementData", "[", 
             RowBox[{"\"\<ShortFilledArrow\>\"", ",", 
              RowBox[{"\"\<ArrowSize\>\"", "\[Rule]", "0.05"}]}], "]"}]}], 
           ",", 
           RowBox[{"EdgeStyle", "\[Rule]", "Black"}], ",", 
           RowBox[{"GraphLayout", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
              RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}],
           "]"}], "]"}], "\[Rule]", 
        RowBox[{"GraphPlot", "[", 
         RowBox[{"EdgeTaggedGraph", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"objects", "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
             "newObjects"}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DirectedEdge", "@@", 
               RowBox[{"Last", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
            RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}]}], ",", 
           RowBox[{"VertexSize", "\[Rule]", "0.3"}], ",", 
           RowBox[{"VertexStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Transparent", ",", 
              RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}]}], ",", 
           RowBox[{"EdgeShapeFunction", "\[Rule]", 
            RowBox[{"GraphElementData", "[", 
             RowBox[{"\"\<ShortFilledArrow\>\"", ",", 
              RowBox[{"\"\<ArrowSize\>\"", "\[Rule]", "0.05"}]}], "]"}]}], 
           ",", 
           RowBox[{"EdgeStyle", "\[Rule]", "Black"}], ",", 
           RowBox[{"GraphLayout", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
              RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}]}],
           "]"}], "]"}]}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"covariant", "===", "True"}], ",", 
        RowBox[{"type", "=", "\"\<Covariant\>\""}], ",", 
        RowBox[{"type", "=", "\"\<Contravariant\>\""}]}], "]"}], ";", 
      RowBox[{"objectCount", "=", 
       RowBox[{
        RowBox[{"Length", "[", "objects", "]"}], "\[Rule]", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"objects", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "newObjects"}], "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"morphismCount", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Normal", "[", "domainMorphismAssociation", "]"}], "]"}], 
        "\[Rule]", 
        RowBox[{"Length", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Normal", "[", "imageMorphismAssociation", "]"}], "]"}], 
         "]"}]}]}], ";", 
      RowBox[{"reducedObjectCount", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"objects", ",", "quiverObjectEquivalences"}], "]"}], ",", 
           "categoryObjectEquivalences"}], "]"}], "]"}], "\[Rule]", 
        RowBox[{"Length", "[", 
         RowBox[{"reduceObjects", "[", 
          RowBox[{
           RowBox[{"reduceObjects", "[", 
            RowBox[{"imageObjects", ",", "imageQuiverObjectEquivalences"}], 
            "]"}], ",", "imageObjectEquivalences"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reducedMorphismCount", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Normal", "[", 
          RowBox[{"reduceArrowsFinal", "[", 
           RowBox[{
            RowBox[{"reduceArrowsInitial", "[", 
             RowBox[{
             "reducedDomainMorphismAssociation", ",", 
              "categoryMorphismEquivalences"}], "]"}], ",", 
            "categoryObjectEquivalences"}], "]"}], "]"}], "]"}], "\[Rule]", 
        RowBox[{"Length", "[", 
         RowBox[{"Normal", "[", 
          RowBox[{"reduceArrowsFinal", "[", 
           RowBox[{
            RowBox[{"reduceArrowsInitial", "[", 
             RowBox[{
             "reducedImageMorphismAssociation", ",", 
              "imageMorphismEquivalences"}], "]"}], ",", 
            "imageObjectEquivalences"}], "]"}], "]"}], "]"}]}]}], ";", 
      RowBox[{"BoxForm`ArrangeSummaryBox", "[", 
       RowBox[{
       "\"\<AbstractFunctor\>\"", ",", "abstractFunctor", ",", "icon", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"BoxForm`SummaryItem", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Type: \>\"", ",", "type"}], "}"}], "]"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"BoxForm`SummaryItem", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Objects: \>\"", ",", "objectCount"}], "}"}], "]"}],
             ",", 
            RowBox[{"BoxForm`SummaryItem", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Morphisms: \>\"", ",", "morphismCount"}], "}"}], 
             "]"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"BoxForm`SummaryItem", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Reduced Objects: \>\"", ",", "reducedObjectCount"}],
              "}"}], "]"}], ",", 
           RowBox[{"BoxForm`SummaryItem", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Reduced Morphisms: \>\"", ",", "reducedMorphismCount"}], 
             "}"}], "]"}]}], "}"}], "}"}], ",", "format", ",", 
        RowBox[{"\"\<Interpretable\>\"", "\[Rule]", "Automatic"}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697393043667965`*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"c30a2bf0-4f55-4018-b2ac-eb9b2694d017"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{"(", "abstractCategory_", ")"}], "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "categoryMorphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", 
       "categoryObjectEquivalences_List"}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}], 
          ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "quiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
        "]"}]}]}], "]"}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association"}], "]"}], 
  ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "objectEquivalences_List", ",", 
    "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "newCompositionSymbol_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "newCompositionSymbol_", ",", 
    "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "newCompositionSymbol_", ",", 
    "objectEquivalences_List", ",", "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "newCompositionSymbol_", ",", 
    "newIdentitySymbol_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newIdentitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "newCompositionSymbol_", ",", 
    "newIdentitySymbol_", ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newIdentitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "newCompositionSymbol_", ",", 
    "newIdentitySymbol_", ",", "objectEquivalences_List", ",", 
    "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newIdentitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{"covariant_", ",", 
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{"covariant_", ",", 
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association"}], "]"}], 
  ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{"covariant_", ",", 
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{"covariant_", ",", 
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{"covariant_", ",", 
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{"covariant_", ",", 
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{"covariant_", ",", 
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "objectEquivalences_List", ",", 
    "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{"covariant_", ",", 
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "newCompositionSymbol_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{"covariant_", ",", 
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "newCompositionSymbol_", ",", 
    "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{"covariant_", ",", 
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "newCompositionSymbol_", ",", 
    "objectEquivalences_List", ",", "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{"covariant_", ",", 
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "newCompositionSymbol_", ",", 
    "newIdentitySymbol_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newIdentitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{"covariant_", ",", 
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "newCompositionSymbol_", ",", 
    "newIdentitySymbol_", ",", "objectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newIdentitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{"covariant_", ",", 
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], ",", "objectMappings_Association", ",", 
    "arrowMappings_Association", ",", "newObjects_List", ",", 
    "newArrows_Association", ",", "newCompositionSymbol_", ",", 
    "newIdentitySymbol_", ",", "objectEquivalences_List", ",", 
    "morphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newCompositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "newIdentitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{"covariant_", ",", 
    RowBox[{
     RowBox[{"(", "functorSymbol_", ")"}], "[", 
     RowBox[{
      RowBox[{"(", "abstractCategory_", ")"}], "[", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{
        "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
        RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
        RowBox[{
        "\"\<MorphismEquivalences\>\"", "\[Rule]", 
         "categoryMorphismEquivalences_List"}], ",", 
        RowBox[{
        "\"\<ObjectEquivalences\>\"", "\[Rule]", 
         "categoryObjectEquivalences_List"}], ",", 
        RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
         RowBox[{
          RowBox[{"(", "abstractQuiver_", ")"}], "[", 
          RowBox[{"Association", "[", 
           RowBox[{
            RowBox[{
            "\"\<ArrowEquivalences\>\"", "\[Rule]", 
             "arrowEquivalences_List"}], ",", 
            RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
            
            RowBox[{
            "\"\<ObjectEquivalences\>\"", "\[Rule]", 
             "quiverObjectEquivalences_List"}], ",", 
            RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
          "]"}]}]}], "]"}], "]"}], "]"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
            RowBox[{"functorSymbol", "[", 
             RowBox[{"First", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
         RowBox[{"Normal", "[", "arrows", "]"}]}], "]"}]}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#1", "\[Rule]", 
            RowBox[{"functorSymbol", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
         "objects"}], "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{"(", "functorSymbol_", ")"}], "[", 
    RowBox[{
     RowBox[{"(", "abstractCategory_", ")"}], "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}],
        ",", 
       RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], ",", 
       
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "categoryMorphismEquivalences_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", 
        "categoryObjectEquivalences_List"}], ",", 
       RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractQuiver_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences_List"}],
            ",", 
           RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "quiverObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}], 
         "]"}]}]}], "]"}], "]"}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
            RowBox[{"functorSymbol", "[", 
             RowBox[{"First", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
         RowBox[{"Normal", "[", "arrows", "]"}]}], "]"}]}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", 
       RowBox[{"Association", "[", "]"}]}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", 
       RowBox[{"Association", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#1", "\[Rule]", 
            RowBox[{"functorSymbol", "[", "#1", "]"}]}], "&"}], ")"}], "/@", 
         "objects"}], "]"}]}]}], "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", "functor_Association", "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"KeySort", "[", "functor", "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"functor", ",", "\"\<Covariant\>\""}], "]"}], "&&", 
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"functor", ",", "\"\<Category\>\""}], "]"}], "&&", 
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"functor", ",", "\"\<ObjectMappings\>\""}], "]"}], "&&", 
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"functor", ",", "\"\<ArrowMappings\>\""}], "]"}], "&&", 
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"functor", ",", "\"\<NewObjects\>\""}], "]"}], "&&", 
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"functor", ",", "\"\<NewArrows\>\""}], "]"}], "&&", 
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"functor", ",", "\"\<NewCompositionSymbol\>\""}], "]"}], "&&", 
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"functor", ",", "\"\<NewIdentitySymbol\>\""}], "]"}], "&&", 
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"functor", ",", "\"\<ObjectEquivalences\>\""}], "]"}], "&&", 
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"functor", ",", "\"\<MorphismEquivalences\>\""}], "]"}], "&&", 
    RowBox[{
     RowBox[{"Keys", "[", 
      RowBox[{"KeySort", "[", "functor", "]"}], "]"}], "=!=", 
     RowBox[{"Keys", "[", "functor", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{"AbstractFunctor", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
       RowBox[{"\"\<Category\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractCategory_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
           ",", 
           RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
           ",", 
           RowBox[{
           "\"\<MorphismEquivalences\>\"", "\[Rule]", 
            "categoryMorphismEquivalences_List"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "categoryObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
            RowBox[{
             RowBox[{"(", "abstractQuiver_", ")"}], "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{
               "\"\<ArrowEquivalences\>\"", "\[Rule]", 
                "arrowEquivalences_List"}], ",", 
               RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
               ",", 
               RowBox[{
               "\"\<ObjectEquivalences\>\"", "\[Rule]", 
                "quiverObjectEquivalences_List"}], ",", 
               RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], 
              "]"}], "]"}]}]}], "]"}], "]"}]}], ",", 
       RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
       RowBox[{
       "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
       ",", 
       RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}],
        ",", 
       RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{
       "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
      "]"}], "]"}], ",", "newObjectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "newObjectEquivalences"}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{"AbstractFunctor", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
       RowBox[{"\"\<Category\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractCategory_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
           ",", 
           RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
           ",", 
           RowBox[{
           "\"\<MorphismEquivalences\>\"", "\[Rule]", 
            "categoryMorphismEquivalences_List"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "categoryObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
            RowBox[{
             RowBox[{"(", "abstractQuiver_", ")"}], "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{
               "\"\<ArrowEquivalences\>\"", "\[Rule]", 
                "arrowEquivalences_List"}], ",", 
               RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
               ",", 
               RowBox[{
               "\"\<ObjectEquivalences\>\"", "\[Rule]", 
                "quiverObjectEquivalences_List"}], ",", 
               RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], 
              "]"}], "]"}]}]}], "]"}], "]"}]}], ",", 
       RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
       RowBox[{
       "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
       ",", 
       RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}],
        ",", 
       RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{
       "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
      "]"}], "]"}], ",", "newObjectEquivalences_List", ",", 
    "newMorphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "newMorphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "newObjectEquivalences"}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{"AbstractFunctor", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
       RowBox[{"\"\<Category\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractCategory_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
           ",", 
           RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
           ",", 
           RowBox[{
           "\"\<MorphismEquivalences\>\"", "\[Rule]", 
            "categoryMorphismEquivalences_List"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "categoryObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
            RowBox[{
             RowBox[{"(", "abstractQuiver_", ")"}], "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{
               "\"\<ArrowEquivalences\>\"", "\[Rule]", 
                "arrowEquivalences_List"}], ",", 
               RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
               ",", 
               RowBox[{
               "\"\<ObjectEquivalences\>\"", "\[Rule]", 
                "quiverObjectEquivalences_List"}], ",", 
               RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], 
              "]"}], "]"}]}]}], "]"}], "]"}]}], ",", 
       RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
       RowBox[{
       "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
       ",", 
       RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}],
        ",", 
       RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{
       "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
      "]"}], "]"}], ",", "functorCompositionSymbol_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "functorCompositionSymbol"}],
       ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "functorCompositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{"AbstractFunctor", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
       RowBox[{"\"\<Category\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractCategory_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
           ",", 
           RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
           ",", 
           RowBox[{
           "\"\<MorphismEquivalences\>\"", "\[Rule]", 
            "categoryMorphismEquivalences_List"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "categoryObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
            RowBox[{
             RowBox[{"(", "abstractQuiver_", ")"}], "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{
               "\"\<ArrowEquivalences\>\"", "\[Rule]", 
                "arrowEquivalences_List"}], ",", 
               RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
               ",", 
               RowBox[{
               "\"\<ObjectEquivalences\>\"", "\[Rule]", 
                "quiverObjectEquivalences_List"}], ",", 
               RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], 
              "]"}], "]"}]}]}], "]"}], "]"}]}], ",", 
       RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
       RowBox[{
       "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
       ",", 
       RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}],
        ",", 
       RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{
       "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
      "]"}], "]"}], ",", "functorCompositionSymbol_", ",", 
    "newObjectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "functorCompositionSymbol"}],
       ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "newObjectEquivalences"}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "functorCompositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{"AbstractFunctor", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
       RowBox[{"\"\<Category\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractCategory_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
           ",", 
           RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
           ",", 
           RowBox[{
           "\"\<MorphismEquivalences\>\"", "\[Rule]", 
            "categoryMorphismEquivalences_List"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "categoryObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
            RowBox[{
             RowBox[{"(", "abstractQuiver_", ")"}], "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{
               "\"\<ArrowEquivalences\>\"", "\[Rule]", 
                "arrowEquivalences_List"}], ",", 
               RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
               ",", 
               RowBox[{
               "\"\<ObjectEquivalences\>\"", "\[Rule]", 
                "quiverObjectEquivalences_List"}], ",", 
               RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], 
              "]"}], "]"}]}]}], "]"}], "]"}]}], ",", 
       RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
       RowBox[{
       "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
       ",", 
       RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}],
        ",", 
       RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{
       "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
      "]"}], "]"}], ",", "functorCompositionSymbol_", ",", 
    "newObjectEquivalences_List", ",", "newMorphismEquivalences_List"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "newMorphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "functorCompositionSymbol"}],
       ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "newObjectEquivalences"}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "functorCompositionSymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{"AbstractFunctor", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
       RowBox[{"\"\<Category\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractCategory_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
           ",", 
           RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
           ",", 
           RowBox[{
           "\"\<MorphismEquivalences\>\"", "\[Rule]", 
            "categoryMorphismEquivalences_List"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "categoryObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
            RowBox[{
             RowBox[{"(", "abstractQuiver_", ")"}], "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{
               "\"\<ArrowEquivalences\>\"", "\[Rule]", 
                "arrowEquivalences_List"}], ",", 
               RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
               ",", 
               RowBox[{
               "\"\<ObjectEquivalences\>\"", "\[Rule]", 
                "quiverObjectEquivalences_List"}], ",", 
               RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], 
              "]"}], "]"}]}]}], "]"}], "]"}]}], ",", 
       RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
       RowBox[{
       "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
       ",", 
       RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}],
        ",", 
       RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{
       "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
      "]"}], "]"}], ",", "functorCompositionSymbol_", ",", 
    "functorIdentitySymbol_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "functorCompositionSymbol"}],
       ",", 
      RowBox[{
      "\"\<NewIdentitySymbol\>\"", "\[Rule]", "functorIdentitySymbol"}], ",", 
      
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences"}],
       ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "functorCompositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "functorIdentitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{"AbstractFunctor", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
       RowBox[{"\"\<Category\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractCategory_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
           ",", 
           RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
           ",", 
           RowBox[{
           "\"\<MorphismEquivalences\>\"", "\[Rule]", 
            "categoryMorphismEquivalences_List"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "categoryObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
            RowBox[{
             RowBox[{"(", "abstractQuiver_", ")"}], "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{
               "\"\<ArrowEquivalences\>\"", "\[Rule]", 
                "arrowEquivalences_List"}], ",", 
               RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
               ",", 
               RowBox[{
               "\"\<ObjectEquivalences\>\"", "\[Rule]", 
                "quiverObjectEquivalences_List"}], ",", 
               RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], 
              "]"}], "]"}]}]}], "]"}], "]"}]}], ",", 
       RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
       RowBox[{
       "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
       ",", 
       RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}],
        ",", 
       RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{
       "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
      "]"}], "]"}], ",", "functorCompositionSymbol_", ",", 
    "functorIdentitySymbol_", ",", "newObjectEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "morphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "functorCompositionSymbol"}],
       ",", 
      RowBox[{
      "\"\<NewIdentitySymbol\>\"", "\[Rule]", "functorIdentitySymbol"}], ",", 
      
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "newObjectEquivalences"}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "functorCompositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "functorIdentitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"AbstractFunctor", "[", 
   RowBox[{
    RowBox[{"AbstractFunctor", "[", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
       "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
       RowBox[{"\"\<Category\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"(", "abstractCategory_", ")"}], "[", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
           "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], 
           ",", 
           RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
           ",", 
           RowBox[{
           "\"\<MorphismEquivalences\>\"", "\[Rule]", 
            "categoryMorphismEquivalences_List"}], ",", 
           RowBox[{
           "\"\<ObjectEquivalences\>\"", "\[Rule]", 
            "categoryObjectEquivalences_List"}], ",", 
           RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
            RowBox[{
             RowBox[{"(", "abstractQuiver_", ")"}], "[", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{
               "\"\<ArrowEquivalences\>\"", "\[Rule]", 
                "arrowEquivalences_List"}], ",", 
               RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
               ",", 
               RowBox[{
               "\"\<ObjectEquivalences\>\"", "\[Rule]", 
                "quiverObjectEquivalences_List"}], ",", 
               RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], 
              "]"}], "]"}]}]}], "]"}], "]"}]}], ",", 
       RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
       RowBox[{
       "\"\<MorphismEquivalences\>\"", "\[Rule]", 
        "morphismEquivalences_List"}], ",", 
       RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
       RowBox[{
       "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
       ",", 
       RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}],
        ",", 
       RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
       RowBox[{
       "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
       ",", 
       RowBox[{
       "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
      "]"}], "]"}], ",", "functorCompositionSymbol_", ",", 
    "functorIdentitySymbol_", ",", "newObjectEquivalences_List", ",", 
    "newMorphismEquivalences_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{"\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings"}], ",", 
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{"AbstractCategory", "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol"}], ",", 
          
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], 
            "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", "arrowEquivalences"}], 
              ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows"}], ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects"}]}], "]"}], 
            "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", "newMorphismEquivalences"}], 
      ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows"}], ",", 
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "functorCompositionSymbol"}],
       ",", 
      RowBox[{
      "\"\<NewIdentitySymbol\>\"", "\[Rule]", "functorIdentitySymbol"}], ",", 
      
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "newObjectEquivalences"}], ",", 
      RowBox[{"\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "functorCompositionSymbol", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "functorIdentitySymbol", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AbstractFunctor", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<ArrowMappings\>\"", "\[Rule]", "arrowMappings_Association"}], ",", 
      
      RowBox[{"\"\<Category\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractCategory_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<CompositionSymbol\>\"", "\[Rule]", "compositionSymbol_"}], ",", 
          RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "identitySymbol_"}], 
          ",", 
          RowBox[{
          "\"\<MorphismEquivalences\>\"", "\[Rule]", 
           "categoryMorphismEquivalences_List"}], ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "categoryObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "abstractQuiver_", ")"}], "[", 
            RowBox[{"Association", "[", 
             RowBox[{
              RowBox[{
              "\"\<ArrowEquivalences\>\"", "\[Rule]", 
               "arrowEquivalences_List"}], ",", 
              RowBox[{"\"\<Arrows\>\"", "\[Rule]", "arrows_Association"}], 
              ",", 
              RowBox[{
              "\"\<ObjectEquivalences\>\"", "\[Rule]", 
               "quiverObjectEquivalences_List"}], ",", 
              RowBox[{"\"\<Objects\>\"", "\[Rule]", "objects_List"}]}], "]"}],
             "]"}]}]}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Covariant\>\"", "\[Rule]", "covariant_"}], ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "morphismEquivalences_List"}], ",", 
      RowBox[{"\"\<NewArrows\>\"", "\[Rule]", "newArrows_Association"}], ",", 
      
      RowBox[{
      "\"\<NewCompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<NewIdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol_"}], 
      ",", 
      RowBox[{"\"\<NewObjects\>\"", "\[Rule]", "newObjects_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", "objectEquivalences_List"}], 
      ",", 
      RowBox[{
      "\"\<ObjectMappings\>\"", "\[Rule]", "objectMappings_Association"}]}], 
     "]"}], "]"}], "[", 
   RowBox[{
    RowBox[{"(", "abstractCategory_", ")"}], "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<CompositionSymbol\>\"", "\[Rule]", "inputCompositionSymbol_"}], 
      ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "inputIdentitySymbol_"}], 
      ",", 
      RowBox[{
      "\"\<MorphismEquivalences\>\"", "\[Rule]", 
       "inputMorphismEquivalences_List"}], ",", 
      RowBox[{
      "\"\<ObjectEquivalences\>\"", "\[Rule]", 
       "inputObjectEquivalences_List"}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"(", "abstractQuiver_", ")"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
          "\"\<ArrowEquivalences\>\"", "\[Rule]", 
           "inputArrowEquivalences_List"}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", "inputArrows_Association"}], 
          ",", 
          RowBox[{
          "\"\<ObjectEquivalences\>\"", "\[Rule]", 
           "inputQuiverObjectEquivalences_List"}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", "inputObjects_List"}]}], 
         "]"}], "]"}]}]}], "]"}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"AbstractCategory", "[", 
    RowBox[{"Association", "[", 
     RowBox[{
      RowBox[{
      "\"\<CompositionSymbol\>\"", "\[Rule]", "newCompositionSymbol"}], ",", 
      RowBox[{"\"\<IdentitySymbol\>\"", "\[Rule]", "newIdentitySymbol"}], ",", 
      RowBox[{"\"\<MorphismEquivalences\>\"", "\[Rule]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"covariant", "===", "True"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"inputMorphismEquivalences", "/.", 
               RowBox[{
               "inputCompositionSymbol", "\[Rule]", 
                "newCompositionSymbol"}]}], "/.", 
              RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}], ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"inputMorphismEquivalences", "/.", 
                RowBox[{
                "inputCompositionSymbol", "\[Rule]", 
                 "newCompositionSymbol"}]}], "/.", 
               RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
              RowBox[{"Normal", "[", "objectMappings", "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y_", ",", "z_"}], "]"}]}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"x_", ",", "y_"}], "]"}], ",", "z_"}], "]"}], 
                "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{
                  RowBox[{"newCompositionSymbol", "[", 
                   RowBox[{"z", ",", "y"}], "]"}], ",", "x"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"newCompositionSymbol", "[", 
                 RowBox[{"y", ",", "x"}], "]"}]}]}], "}"}]}], ",", 
            "morphismEquivalences"}], "]"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"inputObjectEquivalences", "/.", 
           RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
          "objectEquivalences"}], "]"}], "]"}]}], ",", 
      RowBox[{"\"\<Quiver\>\"", "\[Rule]", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<AbstractQuiver\>\"", "]"}], "[", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<ArrowEquivalences\>\"", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"inputArrowEquivalences", "/.", 
             RowBox[{"Normal", "[", "arrowMappings", "]"}]}], ")"}]}], ",", 
          RowBox[{"\"\<Arrows\>\"", "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"covariant", "===", "True"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normal", "[", "inputArrows", "]"}], "/.", 
                   RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                  RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#1", "]"}], "\[Rule]", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Last", "[", "#1", "]"}], "]"}]}], "&"}], ")"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Normal", "[", "inputArrows", "]"}], "/.", 
                    RowBox[{"Normal", "[", "arrowMappings", "]"}]}], "/.", 
                    RowBox[{"Normal", "[", "objectMappings", "]"}]}], 
                   ")"}]}]}], "]"}], ",", 
               RowBox[{"Normal", "[", "newArrows", "]"}]}], "]"}], "]"}], 
            "]"}]}], ",", 
          RowBox[{"\"\<ObjectEquivalences\>\"", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"inputQuiverObjectEquivalences", "/.", 
             RowBox[{"Normal", "[", "objectMappings", "]"}]}], ")"}]}], ",", 
          RowBox[{"\"\<Objects\>\"", "\[Rule]", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"inputObjects", "/.", 
               RowBox[{"Normal", "[", "objectMappings", "]"}]}], ",", 
              "newObjects"}], "]"}], "]"}]}]}], "]"}], "]"}]}]}], "]"}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractQuiver", "]"}], "===", 
     "\"\<AbstractQuiver\>\""}], "&&", 
    RowBox[{
     RowBox[{"SymbolName", "[", "abstractCategory", "]"}], "===", 
     "\"\<AbstractCategory\>\""}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869658318418605*^9, 3.8696583184341974`*^9}, {
  3.869738631533656*^9, 3.869738725269229*^9}, {3.869738771543952*^9, 
  3.869738830972613*^9}, {3.869738896509601*^9, 3.8697389084894276`*^9}, {
  3.869738945573786*^9, 3.8697393043667965`*^9}, {3.8697394737169914`*^9, 
  3.8697394765754566`*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"cc588c26-f873-4cd9-b33a-f999fd3c7a4d"]
},
WindowSize->{1584, 801},
WindowMargins->{{Automatic, 147}, {Automatic, 105}},
Magnification:>1.2 Inherited,
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 21, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7de09153-a67d-4459-b399-12f143481dc4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[561, 20, 1382, 38, 132, "Input",ExpressionUUID->"48849ee8-0b41-47ae-9c53-507f88eb016b",
 InitializationCell->True],
Cell[1946, 60, 2746, 72, 232, "Input",ExpressionUUID->"3aad200f-6169-4972-b03a-8d60b790477e",
 InitializationCell->True],
Cell[4695, 134, 3472, 89, 332, "Input",ExpressionUUID->"4c14218e-32bb-4cd5-bf3b-cb458b5770a2",
 InitializationCell->True],
Cell[8170, 225, 3215, 80, 282, "Input",ExpressionUUID->"aa2aee7e-09dc-4bd1-b39b-3491611c4689",
 InitializationCell->True],
Cell[11388, 307, 17748, 421, 1132, "Input",ExpressionUUID->"ba56e082-0488-443f-860f-c0a6dec85f39",
 InitializationCell->True],
Cell[29139, 730, 3217, 79, 307, "Input",ExpressionUUID->"67ceed6b-cb96-4349-9f67-d0b4a1e66cb0",
 InitializationCell->True],
Cell[32359, 811, 3263, 80, 307, "Input",ExpressionUUID->"b4d0f398-1513-4e0e-9408-af1e60f2606e",
 InitializationCell->True],
Cell[35625, 893, 5275, 126, 457, "Input",ExpressionUUID->"b98724c2-2ad4-41c4-ae46-4759ea93a126",
 InitializationCell->True],
Cell[40903, 1021, 5354, 126, 457, "Input",ExpressionUUID->"1106ba00-ae0e-425d-8fb8-8aa239949cb9",
 InitializationCell->True],
Cell[46260, 1149, 3917, 96, 357, "Input",ExpressionUUID->"ca1a9e12-9ab1-478d-8b3b-bfb0569cab66",
 InitializationCell->True],
Cell[50180, 1247, 22752, 529, 1632, "Input",ExpressionUUID->"0a41cdc6-5ff7-42cd-aaa4-2e1766dc3ff5",
 InitializationCell->True],
Cell[72935, 1778, 2905, 71, 257, "Input",ExpressionUUID->"508f2666-7341-4440-97cc-29b1803456bb",
 InitializationCell->True],
Cell[75843, 1851, 2894, 71, 257, "Input",ExpressionUUID->"6606b242-8e13-4330-9d38-621f05dec918",
 InitializationCell->True],
Cell[78740, 1924, 3216, 80, 282, "Input",ExpressionUUID->"a9fd887c-e1ae-44ec-a5a1-36245ebda9a5",
 InitializationCell->True],
Cell[81959, 2006, 3272, 82, 282, "Input",ExpressionUUID->"ebba9de9-c714-4438-9607-8d9fa404c3de",
 InitializationCell->True],
Cell[85234, 2090, 4275, 104, 357, "Input",ExpressionUUID->"74c22533-1d98-4ea3-b330-60ef081cdee1",
 InitializationCell->True],
Cell[89512, 2196, 9563, 233, 807, "Input",ExpressionUUID->"250dc498-d42e-4b46-8480-aa783bd2910f",
 InitializationCell->True],
Cell[99078, 2431, 5690, 136, 457, "Input",ExpressionUUID->"1d99ebbb-cd7e-41db-a1c0-c7f222054b45",
 InitializationCell->True],
Cell[104771, 2569, 19532, 462, 1282, "Input",ExpressionUUID->"e1c3bb7f-3072-40b4-91e3-e6ca070d1227",
 InitializationCell->True],
Cell[124306, 3033, 19653, 464, 1307, "Input",ExpressionUUID->"342a91aa-5d2e-4b9e-9327-151aee4ccfb5",
 InitializationCell->True],
Cell[143962, 3499, 24710, 572, 1882, "Input",ExpressionUUID->"7164a3b8-cd60-4789-9659-d194e52f9cf5",
 InitializationCell->True],
Cell[168675, 4073, 24869, 575, 1808, "Input",ExpressionUUID->"8503a1c0-b078-4530-973d-bec8bfc342ec",
 InitializationCell->True],
Cell[193547, 4650, 3103, 78, 272, "Input",ExpressionUUID->"40988e54-678d-4d31-a943-021be91d7f23",
 InitializationCell->True],
Cell[196653, 4730, 3189, 80, 272, "Input",ExpressionUUID->"ecd7033a-1198-4953-9912-8fdac3bbfee8",
 InitializationCell->True],
Cell[199845, 4812, 4686, 115, 392, "Input",ExpressionUUID->"9ec8e5d1-8c39-4893-85d4-e7fcdaf4d6e5",
 InitializationCell->True],
Cell[204534, 4929, 4852, 118, 416, "Input",ExpressionUUID->"72506e5c-2f61-476b-a39e-f69b8776d355",
 InitializationCell->True],
Cell[209389, 5049, 3134, 79, 272, "Input",ExpressionUUID->"61e9b785-3da4-43d7-9bd0-b3e032077146",
 InitializationCell->True],
Cell[212526, 5130, 3224, 81, 272, "Input",ExpressionUUID->"8871aab8-51d4-4261-8f12-40fdaf46c322",
 InitializationCell->True],
Cell[215753, 5213, 15949, 381, 944, "Input",ExpressionUUID->"490d1565-fe56-4e08-8b72-ab4dff58bf9a",
 InitializationCell->True],
Cell[231705, 5596, 16066, 383, 944, "Input",ExpressionUUID->"c82f97ed-76e7-43e3-87f4-7d5c03a6de37",
 InitializationCell->True],
Cell[247774, 5981, 20895, 483, 1376, "Input",ExpressionUUID->"4755fb35-2716-452b-a507-813ddd437c79",
 InitializationCell->True],
Cell[268672, 6466, 21009, 485, 1432, "Input",ExpressionUUID->"6df51058-9413-46b8-a775-1082576129ce",
 InitializationCell->True],
Cell[289684, 6953, 4042, 97, 357, "Input",ExpressionUUID->"4c280c4c-2d83-4ed4-a4ab-771dd61077a6",
 InitializationCell->True],
Cell[293729, 7052, 8354, 188, 632, "Input",ExpressionUUID->"10e28597-a216-4fbd-b782-c6ba4ca6e316",
 InitializationCell->True],
Cell[302086, 7242, 22338, 521, 1532, "Input",ExpressionUUID->"bb0b302a-f62e-43d6-bc50-2e735d54b523",
 InitializationCell->True],
Cell[324427, 7765, 45669, 1054, 3282, "Input",ExpressionUUID->"c37a4049-d31c-4fd8-b301-6012b2dee896",
 InitializationCell->True],
Cell[370099, 8821, 24640, 569, 1757, "Input",ExpressionUUID->"088a6630-59f5-4116-bf31-7ee8df9c1336",
 InitializationCell->True],
Cell[394742, 9392, 26414, 613, 1688, "Input",ExpressionUUID->"d021f57e-9d92-4737-993c-26005cc9e408",
 InitializationCell->True],
Cell[421159, 10007, 26469, 614, 1688, "Input",ExpressionUUID->"4110b943-71a0-40e2-9436-edc0561bf7e7",
 InitializationCell->True],
Cell[447631, 10623, 26507, 614, 1688, "Input",ExpressionUUID->"85834c94-b75a-4bcb-ad84-655a4bb9a0a9",
 InitializationCell->True],
Cell[474141, 11239, 9458, 225, 752, "Input",ExpressionUUID->"7cfa7922-f825-4e87-a419-e14ba6297bcf",
 InitializationCell->True],
Cell[483602, 11466, 50356, 1147, 3392, "Input",ExpressionUUID->"9c3bcf00-4fa3-4850-8e5d-aac6ad47c60b",
 InitializationCell->True],
Cell[533961, 12615, 32130, 739, 2216, "Input",ExpressionUUID->"9b9b680f-f391-4099-8411-4aacaade3fa4",
 InitializationCell->True],
Cell[566094, 13356, 11269, 266, 872, "Input",ExpressionUUID->"049e7213-ddba-4d04-9034-8f6415213148",
 InitializationCell->True],
Cell[577366, 13624, 52432, 1194, 3536, "Input",ExpressionUUID->"dd5762b1-fa1d-4a89-adb3-8029a70db7f0",
 InitializationCell->True],
Cell[629801, 14820, 56890, 1301, 3584, "Input",ExpressionUUID->"52870e07-2df5-4c03-98b4-f3a05e3e9f24",
 InitializationCell->True],
Cell[686694, 16123, 51049, 1172, 3368, "Input",ExpressionUUID->"80aba1f0-7797-4090-aa53-6763fa225e3c",
 InitializationCell->True],
Cell[737746, 17297, 32429, 752, 2120, "Input",ExpressionUUID->"91253aaf-eb7b-47d0-ae61-78d301847f3b",
 InitializationCell->True],
Cell[770178, 18051, 33062, 766, 2144, "Input",ExpressionUUID->"b0625b82-57de-44ae-98b0-770fdb3a332f",
 InitializationCell->True],
Cell[803243, 18819, 43199, 995, 2744, "Input",ExpressionUUID->"0beb59f7-5f8e-41b8-babe-eb1ee94656ed",
 InitializationCell->True],
Cell[846445, 19816, 22284, 519, 1448, "Input",ExpressionUUID->"b70125d4-d911-43a9-a0ca-7746908afbee",
 InitializationCell->True],
Cell[868732, 20337, 27291, 632, 1784, "Input",ExpressionUUID->"d23b20de-4261-450a-9841-951206a22beb",
 InitializationCell->True],
Cell[896026, 20971, 32886, 763, 2192, "Input",ExpressionUUID->"43dc5aea-094d-4842-a643-d9fcf1916de7",
 InitializationCell->True],
Cell[928915, 21736, 32931, 764, 2192, "Input",ExpressionUUID->"0603920b-9b55-4a12-b578-1f60774f9224",
 InitializationCell->True],
Cell[961849, 22502, 6395, 150, 488, "Input",ExpressionUUID->"e79d3665-11b5-45ce-9cc8-5712ffc01797",
 InitializationCell->True],
Cell[968247, 22654, 3074, 75, 248, "Input",ExpressionUUID->"6ce64539-e6b8-4b31-9faf-2f4913b26167",
 InitializationCell->True],
Cell[971324, 22731, 23759, 563, 1448, "Input",ExpressionUUID->"51d03892-cccb-4a39-8a22-e003cc326f00",
 InitializationCell->True],
Cell[995086, 23296, 20616, 483, 1257, "Input",ExpressionUUID->"1f010519-90df-4aed-b9c6-3ca19931dff0",
 InitializationCell->True],
Cell[1015705, 23781, 5818, 136, 511, "Input",ExpressionUUID->"ac63ece8-ce1c-450f-b5af-f8b6a7e47e0b",
 InitializationCell->True],
Cell[1021526, 23919, 25866, 596, 1832, "Input",ExpressionUUID->"0e30ff79-b996-423d-bf2c-8969fc4f5dde",
 InitializationCell->True],
Cell[1047395, 24517, 19930, 470, 1207, "Input",ExpressionUUID->"b876dfa3-97d5-4db7-b7bb-16a0fddbd442",
 InitializationCell->True],
Cell[1067328, 24989, 19480, 458, 1160, "Input",ExpressionUUID->"a6fca516-07d5-43df-b636-0b5d195e77a0",
 InitializationCell->True],
Cell[1086811, 25449, 25497, 585, 1688, "Input",ExpressionUUID->"c28cabe4-22c2-4ad3-97da-c39b3eb1a8c9",
 InitializationCell->True],
Cell[1112311, 26036, 25049, 573, 1688, "Input",ExpressionUUID->"4775ceeb-97f5-4bc8-8332-eb16227e51e0",
 InitializationCell->True],
Cell[1137363, 26611, 4958, 115, 416, "Input",ExpressionUUID->"f2e43dc8-9c6e-4dc0-a7a5-6c9eb43cda95",
 InitializationCell->True],
Cell[1142324, 26728, 5530, 111, 512, "Input",ExpressionUUID->"fac9bdfb-945d-417a-9af0-b6c3cac7489b",
 InitializationCell->True],
Cell[1147857, 26841, 43771, 1018, 2792, "Input",ExpressionUUID->"c30a2bf0-4f55-4018-b2ac-eb9b2694d017",
 InitializationCell->True],
Cell[1191631, 27861, 157356, 3733, 13232, "Input",ExpressionUUID->"cc588c26-f873-4cd9-b33a-f999fd3c7a4d",
 InitializationCell->True]
}
]
*)

